<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE workflow PUBLIC "-//OpenSymphony Group//DTD OSWorkflow 2.8//EN" "http://www.opensymphony.com/osworkflow/workflow_2_8.dtd">
<workflow>
  <meta name="jira.description"></meta>
  <meta name="jira.update.author.key">arianna.fabbri</meta>
  <meta name="jira.updated.date">1621344400549</meta>
  <initial-actions>
    <action id="1" name="Create">
      <validators>
        <validator name="" type="class">
          <arg name="permission">Create Issue</arg>
          <arg name="class.name">com.atlassian.jira.workflow.validator.PermissionValidator</arg>
        </validator>
      </validators>
      <results>
        <unconditional-result old-status="null" status="open" step="2">
          <post-functions>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueCreateFunction</arg>
            </function>
            <function type="class">
              <arg name="FIELD_FUNCTION_ID">4395ca56486fb392f593ad5ee4f8008d9c0da93d</arg>
              <arg name="FIELD_NOTES">YCFgQ3JlYXRlIHN1Yi10YXNrcyBmb3IgZWFjaCB1c2VyIGluIFBST0RVQ1RJT05fVVNFUlMgZ3JvdXBz</arg>
              <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
              <arg name="FIELD_INLINE_SCRIPT">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5NdXRhYmxlSXNzdWUKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZU1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5iYy51c2VyLnNlYXJjaC5Vc2VyU2VhcmNoU2VydmljZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIuQXBwbGljYXRpb25Vc2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuZXZlbnQudHlwZS5FdmVudERpc3BhdGNoT3B0aW9uCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuaW5kZXguSXNzdWVJbmRleGluZ1NlcnZpY2UKaW1wb3J0IG9yZy5hcGFjaGUubG9nNGouQ2F0ZWdvcnkKQ2F0ZWdvcnkgbG9nID0gQ2F0ZWdvcnkuZ2V0SW5zdGFuY2UoImNvbS5vbnJlc29sdmUuamlyYS5ncm9vdnkuUG9zdEZ1bmN0aW9uIikKbG9nLnNldExldmVsKG9yZy5hcGFjaGUubG9nNGouTGV2ZWwuREVCVUcpCgpkZWYgaXNzdWVGYWN0b3J5ID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVGYWN0b3J5KCkKZGVmIGNvbnN0YW50TWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbnN0YW50c01hbmFnZXIoKQpkZWYgTG9nZ2VkSW5Vc2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SmlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dCgpLmdldExvZ2dlZEluVXNlcigpCmRlZiBzdWJUYXNrTWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldFN1YlRhc2tNYW5hZ2VyKCkKCi8qIEdldCBJbnNpZ2h0IElRTCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi8KQ2xhc3MgaXFsRmFjYWRlQ2xhc3MgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRQbHVnaW5BY2Nlc3NvcigpLmdldENsYXNzTG9hZGVyKCkuZmluZENsYXNzKCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5JUUxGYWNhZGUiKTsgCmRlZiBpcWxGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUoaXFsRmFjYWRlQ2xhc3MpOwovKiBHZXQgSW5zaWdodCBPYmplY3QgRmFjYWRlIGZyb20gcGx1Z2luIGFjY2Vzc29yICovCkNsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcygiY29tLnJpYWRhbGFicy5qaXJhLnBsdWdpbnMuaW5zaWdodC5jaGFubmVsLmV4dGVybmFsLmFwaS5mYWNhZGUuT2JqZWN0RmFjYWRlIik7CmRlZiBvYmplY3RGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUob2JqZWN0RmFjYWRlQ2xhc3MpOwpJc3N1ZUluZGV4aW5nU2VydmljZSBpc3N1ZUluZGV4aW5nU2VydmljZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChJc3N1ZUluZGV4aW5nU2VydmljZSkKCi8qIEdldCBpc3N1ZSAiR3JvdXAgQXNzaWduZWUiIGN1c3RvbSBmaWVsZCB2YWx1ZSAqLwpJc3N1ZU1hbmFnZXIgaXNzdWVNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVNYW5hZ2VyKCkKLy9NdXRhYmxlSXNzdWUgaXNzdWUgPSBpc3N1ZU1hbmFnZXIuZ2V0SXNzdWVCeUtleUlnbm9yZUNhc2UoIk9QVVQtMiIpCi8vMjA5MDEgLSBQcm9kdWN0aW9uIFVzZXJzCmRlZiB2YWx1ZSA9IGlzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjE5MDMpKQpkZWYgdXNlclNlYXJjaFNlcnZpY2UgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb21wb25lbnQoVXNlclNlYXJjaFNlcnZpY2UpCmxvZy5kZWJ1ZyAidmFsdWU6ICIgKyB2YWx1ZQppZiAodmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAhPSAiIil7CiAgICAvKiBTcGVjaWZ5IHRoZSBzY2hlbWEgaWQgYXMgd2VsbCBhcyB0aGUgSVFMIHRoYXQgd2lsbCBmZXRjaCBvYmplY3RzLiBJbiB0aGlzIGNhc2UgYWxsIG9iamVjdHMgd2l0aCBOYW1lIG1hdGNoaW5nIHRoZSB2YWx1ZUNGLCBiZSBzdXJlIHRvIGluY2x1ZGUgIiBhcm91bmQgdmFsdWUgKi8KICAgIC8vbG9nLmRlYnVnICJ2YWx1ZVswXS5uYW1lID0gIiArIHZhbHVlWzBdLmdldE5hbWUoKQogICAgLy9sb2cuZGVidWcgInZhbHVlLnNpemU6ICIgKyB2YWx1ZS5zaXplCiAgICAvL2xvZy5kZWJ1ZyAidmFsdWU6ICIgKyB2YWx1ZQogICAgU3RyaW5nIHF1ZXJ5UGFyYW0KICAgIAogICAgaWYgKHZhbHVlLnNpemU+MSl7CiAgICAgICAgaW50IGNvdW50ZXIgPSAwCiAgICAgICAgZm9yIChpdGVtIGluIHZhbHVlKXsKICAgICAgICAgICAgaWYgKGNvdW50ZXIgPT0gMCl7CiAgICAgICAgICAgIAlxdWVyeVBhcmFtID0gIlwiIiArIGl0ZW0uZ2V0TmFtZSgpICsgIlwiIgogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW0gPSBxdWVyeVBhcmFtICsgIixcIiIgKyBpdGVtLmdldE5hbWUoKSArICJcIiIKICAgICAgICAJfQogICAgICAgICAgICBjb3VudGVyKysKICAgICAgICB9CiAgICB9ZWxzZXsKICAgICAgICBxdWVyeVBhcmFtID0gIlwiIiArIHZhbHVlWzBdLmdldE5hbWUoKSArICJcIiIKICAgIH0KICAgIGxvZy5kZWJ1ZyAicXVlcnlQYXJhbTogIiArIHF1ZXJ5UGFyYW0KICAgIGRlZiBvYmplY3RzID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMTAsICJvYmplY3RUeXBlPVRlY2huaWNpYW4gQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKFwiTmFtZVwiIElOICgiICsgcXVlcnlQYXJhbSArICIpKSIpOyAvLyBTZWUgdGhlIGNvbXBsZXRlIGxpc3Qgb2YgcG9zc2libGUgSVFMIG9uIHRoZSBJbnNpZ2h0IFF1ZXJ5IExhbmd1YWdlIGRvY3VtZW50YXRpb24gcGFnZQogICAgbG9nLmRlYnVnICJvYmplY3RzOiAiICsgb2JqZWN0cwogICAgbG9nLmRlYnVnICJvYmplY3RUeXBlPVRlY2huaWNpYW4gQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKFwiTmFtZVwiIElOICgiICsgcXVlcnlQYXJhbSArICIpIgogICAgCiAgICBBcHBsaWNhdGlvblVzZXIgdXNlcgogICAgZGVmIGNvdW50ZXIgPSAxCgogICAgZm9yIChvYmogaW4gb2JqZWN0cyl7CiAgICAgICAgLy9sb2cuZGVidWcgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iai5nZXRJZCgpLCAxMTAwKS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSAvL2F0dHJpYnV0ZSBpZCAgICAKICAgICAgICAvL2xvZy5kZWJ1ZyAib2JqIGlkOiAiICsgb2JqLmdldElkKCkKICAgICAgICB1c2VyID0gdXNlclNlYXJjaFNlcnZpY2UuZmluZFVzZXJzQnlFbWFpbChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqLmdldElkKCksIDY3OSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpWzBdCiAgICAgICAgbG9nLmRlYnVnICJ1c2VyOiAiICsgdXNlcgogICAgICAgIC8qIENyZWF0ZSBzdWItdGFzayB0byBiZSBhc3NpZ25lZCB0byB1c2VyICovCiAgICAgICAgTXV0YWJsZUlzc3VlIG5ld1N1YlRhc2sgPSBpc3N1ZUZhY3RvcnkuZ2V0SXNzdWUoKQogICAgICAgIG5ld1N1YlRhc2suc2V0QXNzaWduZWUodXNlcikKICAgICAgICAvL25ld1N1YlRhc2suc2V0U3VtbWFyeShpc3N1ZS5rZXkudG9TdHJpbmcoKSArICIgLSBQcm9kIFRhc2sgIiArIGNvdW50ZXIpCiAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KCJQcm9kdWN0aW9uIFRhc2sgLSAiICsgdXNlci5kaXNwbGF5TmFtZSkKICAgICAgICBuZXdTdWJUYXNrLnNldFBhcmVudE9iamVjdChpc3N1ZSkKICAgICAgICBuZXdTdWJUYXNrLnNldFByb2plY3RPYmplY3QoaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpKQogICAgICAgIG5ld1N1YlRhc2suc2V0SXNzdWVUeXBlSWQoY29uc3RhbnRNYW5hZ2VyLmdldEFsbElzc3VlVHlwZU9iamVjdHMoKS5maW5kewogICAgICAgICAgICBpdC5nZXROYW1lKCkgPT0gIlN1Yi10YXNrIgogICAgICAgIH0uaWQpCiAgICAgICAgZGVmIHVzZXJPYmplY3QgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgxMCwgIlwiRW1wbG95ZWUgVXNlclwiID0gXCIiICsgbmV3U3ViVGFzay5nZXRBc3NpZ25lZSgpLmdldEVtYWlsQWRkcmVzcygpICsgIlwiIik7CiAgICAgICAgLy9sb2cuZGVidWcgIm9iamVjdDogIiArIHVzZXJPYmplY3QKICAgICAgICBuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjA5MDEpLCBbb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RCZWFuKHVzZXJPYmplY3RbMF0uZ2V0SWQoKSldKQogICAgICAgIAogICAgICAgIGRlZiBuZXdJc3N1ZVBhcmFtcyA9IFsiaXNzdWUiIDogbmV3U3ViVGFza10gYXMgTWFwPFN0cmluZyxPYmplY3Q+CgogICAgICAgIGlzc3VlTWFuYWdlci5jcmVhdGVJc3N1ZU9iamVjdChMb2dnZWRJblVzZXIsIG5ld0lzc3VlUGFyYW1zKQogICAgICAgIHN1YlRhc2tNYW5hZ2VyLmNyZWF0ZVN1YlRhc2tJc3N1ZUxpbmsoaXNzdWUsIG5ld1N1YlRhc2ssIExvZ2dlZEluVXNlcikKCiAgICAgICAgbG9nLmRlYnVnICJJc3N1ZSB3aXRoIHN1bW1hcnkgJHtuZXdTdWJUYXNrLnN1bW1hcnl9IGNyZWF0ZWQiCiAgICAgICAgCiAgICAgICAgaXNzdWVJbmRleGluZ1NlcnZpY2UucmVJbmRleChuZXdTdWJUYXNrKQogICAgICAgIC8vQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVNYW5hZ2VyKCkudXBkYXRlSXNzdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0SmlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dCgpLmdldExvZ2dlZEluVXNlcigpLCBuZXdTdWJUYXNrLCBFdmVudERpc3BhdGNoT3B0aW9uLkRPX05PVF9ESVNQQVRDSCwgZmFsc2UpCiAgICAgICAgCiAgICAgICAgY291bnRlciArKwogICAgfQoKfQ==</arg>
              <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.CustomScriptFunction</arg>
              <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
              <arg name="FIELD_SCRIPT_FILE"></arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
            </function>
            <function type="class">
              <arg name="eventTypeId">1</arg>
              <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
            </function>
          </post-functions>
        </unconditional-result>
      </results>
    </action>
  </initial-actions>
  <steps>
    <step id="2" name="In Progress">
      <meta name="jira.status.id">3</meta>
      <actions>
        <action id="11" name="Complete Job">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <restrict-to>
            <conditions>
              <condition type="class">
                <arg name="statuses">6,11436</arg>
                <arg name="class.name">com.atlassian.jira.workflow.condition.SubTaskBlockingCondition</arg>
              </condition>
            </conditions>
          </restrict-to>
          <results>
            <unconditional-result old-status="null" status="null" step="3">
              <post-functions>
                <function type="class">
                  <arg name="field.name">resolution</arg>
                  <arg name="full.module.key">com.atlassian.jira.plugin.system.workflowupdate-issue-field-function</arg>
                  <arg name="field.value">6</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueFieldFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
                <function type="class">
                  <arg name="FIELD_FUNCTION_ID">a7e852f69cd02911e137838a4b46b07d11ac62ed</arg>
                  <arg name="FIELD_ACTION">21 Close Job</arg>
                  <arg name="FIELD_NOTES">YCFgQ2xvc2UgUHJvZHVjdGlvbiBUYXNrcyB3aXRob3V0IFN1YlRhc2tz</arg>
                  <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
                  <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.FasttrackTransition</arg>
                  <arg name="FIELD_CONDITION">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3I7CmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuZmllbGRzLkN1c3RvbUZpZWxkOwogCmRlZiB2YWx1ZSA9IGlzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjE5MDMpKTsgLy8gQ2hhbmdlIElEIHRvIHRoZSBjb3JyZWN0IG9uZSAgICAgCiAKLyogSWYgYW4gaW5zaWdodCBjdXN0b20gZmllbGQgaGFzIGFuIG9iamVjdCBjYWxsZWQgIk1pY3Jvc29mdCIgaXQgd2lsbCBmYWlsICovCmZvciAoYXNzaWduZWUgaW4gdmFsdWUpewogICAgCiAgICBpZiAoYXNzaWduZWUgIT0gbnVsbCAmJiAiSFVCIERlbGl2ZXJ5IENlbnRlciIuZXF1YWxzKGFzc2lnbmVlLmdldE5hbWUoKSkpewogICAgICAgIHJldHVybiB0cnVlCiAgICB9CiAgICAKfQoKcmV0dXJuIGZhbHNlfHx8</arg>
                  <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
                  <arg name="FIELD_TRANSITION_OPTIONS"></arg>
                  <arg name="FIELD_ADDITIONAL_SCRIPT">YCFg</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
        <action id="41" name="RigeneraSubTask">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <restrict-to>
            <conditions>
              <condition type="class">
                <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.conditions.SimpleScriptedCondition</arg>
                <arg name="FIELD_CONDITION">YCFgZmFsc2V8fHw=</arg>
                <arg name="class.name">com.onresolve.jira.groovy.GroovyCondition</arg>
                <arg name="FIELD_PREVIEW_ISSUE"></arg>
              </condition>
            </conditions>
          </restrict-to>
          <results>
            <unconditional-result old-status="null" status="null" step="2">
              <post-functions>
                <function type="class">
                  <arg name="FIELD_NOTES">YCFgQ3JlYXRlIHN1Yi10YXNrcyBmb3IgZWFjaCB1c2VyIGluIFBST0RVQ1RJT05fVVNFUlMgZ3JvdXBz</arg>
                  <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
                  <arg name="FIELD_INLINE_SCRIPT">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5NdXRhYmxlSXNzdWUKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZU1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5iYy51c2VyLnNlYXJjaC5Vc2VyU2VhcmNoU2VydmljZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIuQXBwbGljYXRpb25Vc2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuZXZlbnQudHlwZS5FdmVudERpc3BhdGNoT3B0aW9uCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuaW5kZXguSXNzdWVJbmRleGluZ1NlcnZpY2UKaW1wb3J0IG9yZy5hcGFjaGUubG9nNGouQ2F0ZWdvcnkKQ2F0ZWdvcnkgbG9nID0gQ2F0ZWdvcnkuZ2V0SW5zdGFuY2UoImNvbS5vbnJlc29sdmUuamlyYS5ncm9vdnkuUG9zdEZ1bmN0aW9uIikKbG9nLnNldExldmVsKG9yZy5hcGFjaGUubG9nNGouTGV2ZWwuREVCVUcpCgpkZWYgaXNzdWVGYWN0b3J5ID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVGYWN0b3J5KCkKZGVmIGNvbnN0YW50TWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbnN0YW50c01hbmFnZXIoKQpkZWYgTG9nZ2VkSW5Vc2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SmlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dCgpLmdldExvZ2dlZEluVXNlcigpCmRlZiBzdWJUYXNrTWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldFN1YlRhc2tNYW5hZ2VyKCkKCi8qIEdldCBJbnNpZ2h0IElRTCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi8KQ2xhc3MgaXFsRmFjYWRlQ2xhc3MgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRQbHVnaW5BY2Nlc3NvcigpLmdldENsYXNzTG9hZGVyKCkuZmluZENsYXNzKCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5JUUxGYWNhZGUiKTsgCmRlZiBpcWxGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUoaXFsRmFjYWRlQ2xhc3MpOwovKiBHZXQgSW5zaWdodCBPYmplY3QgRmFjYWRlIGZyb20gcGx1Z2luIGFjY2Vzc29yICovCkNsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcygiY29tLnJpYWRhbGFicy5qaXJhLnBsdWdpbnMuaW5zaWdodC5jaGFubmVsLmV4dGVybmFsLmFwaS5mYWNhZGUuT2JqZWN0RmFjYWRlIik7CmRlZiBvYmplY3RGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUob2JqZWN0RmFjYWRlQ2xhc3MpOwpJc3N1ZUluZGV4aW5nU2VydmljZSBpc3N1ZUluZGV4aW5nU2VydmljZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChJc3N1ZUluZGV4aW5nU2VydmljZSkKCi8qIEdldCBpc3N1ZSAiR3JvdXAgQXNzaWduZWUiIGN1c3RvbSBmaWVsZCB2YWx1ZSAqLwpJc3N1ZU1hbmFnZXIgaXNzdWVNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVNYW5hZ2VyKCkKLy9NdXRhYmxlSXNzdWUgaXNzdWUgPSBpc3N1ZU1hbmFnZXIuZ2V0SXNzdWVCeUtleUlnbm9yZUNhc2UoIk9QVVQtMiIpCi8vMjA5MDEgLSBQcm9kdWN0aW9uIFVzZXJzCmRlZiB2YWx1ZSA9IGlzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjE5MDMpKQpkZWYgdXNlclNlYXJjaFNlcnZpY2UgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb21wb25lbnQoVXNlclNlYXJjaFNlcnZpY2UpCmxvZy5kZWJ1ZyAidmFsdWU6ICIgKyB2YWx1ZQppZiAodmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAhPSAiIil7CiAgICAvKiBTcGVjaWZ5IHRoZSBzY2hlbWEgaWQgYXMgd2VsbCBhcyB0aGUgSVFMIHRoYXQgd2lsbCBmZXRjaCBvYmplY3RzLiBJbiB0aGlzIGNhc2UgYWxsIG9iamVjdHMgd2l0aCBOYW1lIG1hdGNoaW5nIHRoZSB2YWx1ZUNGLCBiZSBzdXJlIHRvIGluY2x1ZGUgIiBhcm91bmQgdmFsdWUgKi8KICAgIC8vbG9nLmRlYnVnICJ2YWx1ZVswXS5uYW1lID0gIiArIHZhbHVlWzBdLmdldE5hbWUoKQogICAgLy9sb2cuZGVidWcgInZhbHVlLnNpemU6ICIgKyB2YWx1ZS5zaXplCiAgICAvL2xvZy5kZWJ1ZyAidmFsdWU6ICIgKyB2YWx1ZQogICAgU3RyaW5nIHF1ZXJ5UGFyYW0KICAgIAogICAgaWYgKHZhbHVlLnNpemU+MSl7CiAgICAgICAgaW50IGNvdW50ZXIgPSAwCiAgICAgICAgZm9yIChpdGVtIGluIHZhbHVlKXsKICAgICAgICAgICAgaWYgKGNvdW50ZXIgPT0gMCl7CiAgICAgICAgICAgIAlxdWVyeVBhcmFtID0gIlwiIiArIGl0ZW0uZ2V0TmFtZSgpICsgIlwiIgogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW0gPSBxdWVyeVBhcmFtICsgIixcIiIgKyBpdGVtLmdldE5hbWUoKSArICJcIiIKICAgICAgICAJfQogICAgICAgICAgICBjb3VudGVyKysKICAgICAgICB9CiAgICB9ZWxzZXsKICAgICAgICBxdWVyeVBhcmFtID0gIlwiIiArIHZhbHVlWzBdLmdldE5hbWUoKSArICJcIiIKICAgIH0KICAgIGxvZy5kZWJ1ZyAicXVlcnlQYXJhbTogIiArIHF1ZXJ5UGFyYW0KICAgIGRlZiBvYmplY3RzID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMTAsICJvYmplY3RUeXBlPVRlY2huaWNpYW4gQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKFwiTmFtZVwiIElOICgiICsgcXVlcnlQYXJhbSArICIpKSIpOyAvLyBTZWUgdGhlIGNvbXBsZXRlIGxpc3Qgb2YgcG9zc2libGUgSVFMIG9uIHRoZSBJbnNpZ2h0IFF1ZXJ5IExhbmd1YWdlIGRvY3VtZW50YXRpb24gcGFnZQogICAgbG9nLmRlYnVnICJvYmplY3RzOiAiICsgb2JqZWN0cwogICAgbG9nLmRlYnVnICJvYmplY3RUeXBlPVRlY2huaWNpYW4gQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKFwiTmFtZVwiIElOICgiICsgcXVlcnlQYXJhbSArICIpIgogICAgCiAgICBBcHBsaWNhdGlvblVzZXIgdXNlcgogICAgZGVmIGNvdW50ZXIgPSAxCgogICAgZm9yIChvYmogaW4gb2JqZWN0cyl7CiAgICAgICAgLy9sb2cuZGVidWcgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iai5nZXRJZCgpLCAxMTAwKS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSAvL2F0dHJpYnV0ZSBpZCAgICAKICAgICAgICAvL2xvZy5kZWJ1ZyAib2JqIGlkOiAiICsgb2JqLmdldElkKCkKICAgICAgICB1c2VyID0gdXNlclNlYXJjaFNlcnZpY2UuZmluZFVzZXJzQnlFbWFpbChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqLmdldElkKCksIDY3OSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpWzBdCiAgICAgICAgbG9nLmRlYnVnICJ1c2VyOiAiICsgdXNlcgogICAgICAgIC8qIENyZWF0ZSBzdWItdGFzayB0byBiZSBhc3NpZ25lZCB0byB1c2VyICovCiAgICAgICAgTXV0YWJsZUlzc3VlIG5ld1N1YlRhc2sgPSBpc3N1ZUZhY3RvcnkuZ2V0SXNzdWUoKQogICAgICAgIG5ld1N1YlRhc2suc2V0QXNzaWduZWUodXNlcikKICAgICAgICAvL25ld1N1YlRhc2suc2V0U3VtbWFyeShpc3N1ZS5rZXkudG9TdHJpbmcoKSArICIgLSBQcm9kIFRhc2sgIiArIGNvdW50ZXIpCiAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KHVzZXIuZGlzcGxheU5hbWUpCiAgICAgICAgbmV3U3ViVGFzay5zZXRQYXJlbnRPYmplY3QoaXNzdWUpCiAgICAgICAgbmV3U3ViVGFzay5zZXRQcm9qZWN0T2JqZWN0KGlzc3VlLmdldFByb2plY3RPYmplY3QoKSkKICAgICAgICBuZXdTdWJUYXNrLnNldElzc3VlVHlwZUlkKGNvbnN0YW50TWFuYWdlci5nZXRBbGxJc3N1ZVR5cGVPYmplY3RzKCkuZmluZHsKICAgICAgICAgICAgaXQuZ2V0TmFtZSgpID09ICJTdWItdGFzayIKICAgICAgICB9LmlkKQogICAgICAgIGRlZiB1c2VyT2JqZWN0ID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMTAsICJcIkVtcGxveWVlIFVzZXJcIiA9IFwiIiArIG5ld1N1YlRhc2suZ2V0QXNzaWduZWUoKS5nZXRFbWFpbEFkZHJlc3MoKSArICJcIiIpOwogICAgICAgIC8vbG9nLmRlYnVnICJvYmplY3Q6ICIgKyB1c2VyT2JqZWN0CiAgICAgICAgbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKENvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpLmdldEN1c3RvbUZpZWxkT2JqZWN0KDIwOTAxKSwgW29iamVjdEZhY2FkZS5sb2FkT2JqZWN0QmVhbih1c2VyT2JqZWN0WzBdLmdldElkKCkpXSkKICAgICAgICAKICAgICAgICBkZWYgbmV3SXNzdWVQYXJhbXMgPSBbImlzc3VlIiA6IG5ld1N1YlRhc2tdIGFzIE1hcDxTdHJpbmcsT2JqZWN0PgoKICAgICAgICBpc3N1ZU1hbmFnZXIuY3JlYXRlSXNzdWVPYmplY3QoTG9nZ2VkSW5Vc2VyLCBuZXdJc3N1ZVBhcmFtcykKICAgICAgICBzdWJUYXNrTWFuYWdlci5jcmVhdGVTdWJUYXNrSXNzdWVMaW5rKGlzc3VlLCBuZXdTdWJUYXNrLCBMb2dnZWRJblVzZXIpCgogICAgICAgIGxvZy5kZWJ1ZyAiSXNzdWUgd2l0aCBzdW1tYXJ5ICR7bmV3U3ViVGFzay5zdW1tYXJ5fSBjcmVhdGVkIgogICAgICAgIAogICAgICAgIGlzc3VlSW5kZXhpbmdTZXJ2aWNlLnJlSW5kZXgobmV3U3ViVGFzaykKICAgICAgICAvL0NvbXBvbmVudEFjY2Vzc29yLmdldElzc3VlTWFuYWdlcigpLnVwZGF0ZUlzc3VlKENvbXBvbmVudEFjY2Vzc29yLmdldEppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQoKS5nZXRMb2dnZWRJblVzZXIoKSwgbmV3U3ViVGFzaywgRXZlbnREaXNwYXRjaE9wdGlvbi5ET19OT1RfRElTUEFUQ0gsIGZhbHNlKQogICAgICAgIAogICAgICAgIGNvdW50ZXIgKysKICAgIH0KCn0=</arg>
                  <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.CustomScriptFunction</arg>
                  <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
                  <arg name="FIELD_SCRIPT_FILE"></arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
      </actions>
    </step>
    <step id="3" name="Completed">
      <meta name="jira.status.id">11328</meta>
      <actions>
        <action id="21" name="Close Job">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="4">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
        <action id="51" name="Back to Progress">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="2">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
      </actions>
    </step>
    <step id="4" name="Closed">
      <meta name="jira.status.id">6</meta>
      <actions>
        <action id="31" name="Reopen Job">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="2">
              <post-functions>
                <function type="class">
                  <arg name="field.name">resolution</arg>
                  <arg name="full.module.key">com.atlassian.jira.plugin.system.workflowupdate-issue-field-function</arg>
                  <arg name="field.value"></arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueFieldFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
      </actions>
    </step>
  </steps>
</workflow>
