<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE workflow PUBLIC "-//OpenSymphony Group//DTD OSWorkflow 2.8//EN" "http://www.opensymphony.com/osworkflow/workflow_2_8.dtd">
<workflow>
  <meta name="jira.description"></meta>
  <meta name="jira.update.author.key">katia.chinaglia</meta>
  <meta name="jira.updated.date">1678358901273</meta>
  <initial-actions>
    <action id="1" name="Create">
      <validators>
        <validator name="" type="class">
          <arg name="permission">Create Issue</arg>
          <arg name="class.name">com.atlassian.jira.workflow.validator.PermissionValidator</arg>
        </validator>
      </validators>
      <results>
        <unconditional-result old-status="null" status="open" step="7">
          <post-functions>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueCreateFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
            </function>
            <function type="class">
              <arg name="eventTypeId">1</arg>
              <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
            </function>
            <function type="class">
              <arg name="field.copyFieldSource2"></arg>
              <arg name="field.copyFieldSource1">customfield_22740</arg>
              <arg name="scopeSource-linkEnd"></arg>
              <arg name="maxAllowed-integerValue"></arg>
              <arg name="field.createTargetValue1"></arg>
              <arg name="runAsUser-user"></arg>
              <arg name="field.copyFieldMode1">OVERWRITE</arg>
              <arg name="uuid">a12d2a14-f644-4f9a-afad-d71b733436e9</arg>
              <arg name="field.copyFieldDestination1">customfield_22740</arg>
              <arg name="field.copyFieldSeparator1"></arg>
              <arg name="scopeType">PARENT</arg>
              <arg name="destination-scopeTarget">ISSUE_IN_TRANSITION</arg>
              <arg name="full.module.key">com.googlecode.jira-suite-utilitiescopyValueFromOtherField-function</arg>
              <arg name="scopeDestination-linkEnd"></arg>
              <arg name="preconditionAwareFunctionMode-textValue">ALWAYS</arg>
              <arg name="source-scopeTarget">PARENT</arg>
              <arg name="scopeDestination-jql"></arg>
              <arg name="class.name">com.googlecode.jsu.workflow.function.CopyValueFromOtherFieldPostFunction</arg>
              <arg name="scopeSource-jql"></arg>
            </function>
            <function type="class">
              <arg name="FIELD_NOTES">YCFgc2VuZCBlbWFpbCBhZCBhcHByb3ZhdG9yZQ==</arg>
              <arg name="FIELD_DISABLE_VALIDATION"></arg>
              <arg name="FIELD_FROM">noreply-rda@faacgroup.com</arg>
              <arg name="FIELD_INCLUDE_ATTACHMENTS">FIELD_INCLUDE_ATTACHMENTS_NONE</arg>
              <arg name="FIELD_TO_ADDRESSES"></arg>
              <arg name="FIELD_CC_ADDRESSES"></arg>
              <arg name="FIELD_CC_USER_FIELDS"></arg>
              <arg name="FIELD_TO_USER_FIELDS">customfield_22723</arg>
              <arg name="FIELD_FUNCTION_ID">4f866b16578e568e9b643b51dbb5574d7dfad80e</arg>
              <arg name="FIELD_INCLUDE_ATTACHMENTS_CALLBACK">YCFg</arg>
              <arg name="FIELD_EMAIL_TEMPLATE">YCFgPGh0bWw+CjxoZWFkPgoJPHN0eWxlPgogICAgCXRhYmxlLmN1c3RvbS1vdXRnb2luZy1tYWlsewogICAgICAgIAlmb250LWZhbWlseToiVmVyZGFuYSI7CiAgICAgICAgCXdpZHRoOjEwMCU7CiAgICAgICAgCWJvcmRlci1zcGFjaW5nOiA4cHggMnB4OwogICAgICAgIH0KICAgICAgICBhLmFhLXN1bW1hcnl7CiAgICAgICAgCWNvbG9yOiMwMDAwMDA7CiAgICAgICAgCXRleHQtZGVjb3JhdGlvbjpub25lOwogICAgICAgIH0KICAgICAgICB0ZC50ZC1zcGFjZWR7CiAgICAgICAgCXBhZGRpbmc6MTUuMHB0IDcuNXB0IDcuNXB0IDcuNXB0OwogICAgICAgIH0KICAgICAgICB0ZC50ZC1zdW1tYXJ5ewogICAgICAgIAlmb250LWZhbWlseToiVmVyZGFuYSI7CiAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0OwogICAgICAgIAlib3JkZXItdG9wOndoaXRlc21va2UgMS4wcHQ7CiAgICAgICAgCWJvcmRlci1sZWZ0OiNEREREREQgMS4wcHQ7CiAgICAgICAgCWJvcmRlci1ib3R0b206I0RERERERCAxLjBwdDsKICAgICAgICAJYm9yZGVyLXJpZ2h0OiNEREREREQgMS41cHQ7CiAgICAgICAgCWJvcmRlci1zdHlsZTpzb2xpZDsKICAgICAgICAJYmFja2dyb3VuZDp3aGl0ZTsKCQkJcGFkZGluZy1sZWZ0OjEwcHg7CiAgICAgICAgfQoJCXRkLnRkLXJlZmVyZW5jZXsKCQkJYm9yZGVyLXRvcDp3aGl0ZSAxLjBwdDsKCQkJYm9yZGVyLWxlZnQ6I0RERERERCAxLjBwdDsKCQkJYm9yZGVyLWJvdHRvbTojREREREREIDEuNXB0OwoJCQlib3JkZXItcmlnaHQ6I0RERERERCAxLjVwdDsKCQkJYm9yZGVyLXN0eWxlOnNvbGlkOwoJCQliYWNrZ3JvdW5kOndoaXRlOwoJCQlwYWRkaW5nOjEwcHggMTBweCAxMHB4IDEwcHg7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJY29sb3I6IzAwMzA1MDsKCQkJZm9udC1zaXplOjExcHQ7CgkJfQoJCWEudGQtcmVmZXJlbmNlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCWNvbG9yOiMwMDMwNTA7CgkJCWZvbnQtc2l6ZToxMXB0OwoJCQl0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lOwoJCX0KCQlwLnRpdGxlLWNvbW1lbnR7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKICAgICAgICAgICAgZm9udC1zaXplOjEycHQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7CgkJCXRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7CgkJfQoJCXAuYXV0aG9yLWNvbW1lbnR7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKICAgICAgICAgICAgZm9udC1zaXplOjExcHQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7CgkJfQoJCXRkLmNvbW1lbnQtYm94ewoJCQliYWNrZ3JvdW5kOiNGRkZGRkY7CgkJCXBhZGRpbmc6MTBweCAxMHB4IDEwcHggMTBweDsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQlmb250LXNpemU6MTFwdDsKCQl9CgkJdGQuZGV0YWlscy1maWVsZC1uYW1lewoJCQlmb250LXNpemU6MTBwdDsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQl2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7CgkJCXBhZGRpbmctdG9wOiAycHg7CgkJCXBhZGRpbmctYm90dG9tOiAycHg7CgkJfQoJCXAuZGV0YWlscy1ib3gtdGl0bGV7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJZm9udC1zaXplOjExcHQ7CgkJCXBhZGRpbmctdG9wOiAxNXB4OwoJCQlwYWRkaW5nLWJvdHRvbTogMTBweDsKCQl9CgkJdGQuZGV0YWlscy1maWVsZC12YWx1ZXsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJdmVydGljYWwtYWxpZ246bWlkZGxlOwoJCQlwYWRkaW5nLXRvcDogMnB4OwoJCQlwYWRkaW5nLWJvdHRvbTogMnB4OwoJCX0KCQlhLnRpdGxlLW1haWwtcmVmZXJlbmNlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCXBhZGRpbmctdG9wOiA1cHg7CgkJCXBhZGRpbmctYm90dG9tOiA1cHg7CgkJCXBhZGRpbmctbGVmdDogMTBweDsKCQkJZGlzcGxheTogaW5saW5lLWJsb2NrOwoJCQlmb250LXNpemU6MTFwdDsKCQkJY29sb3I6I0NGNjQwMDsKCQl9CgkJYS50aXRsZS1tYWlsLXBvcnRhbHsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQlwYWRkaW5nLXRvcDogNXB4OwoJCQlwYWRkaW5nLWJvdHRvbTogNXB4OwoJCQlwYWRkaW5nLWxlZnQ6IDEwcHg7CgkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWNvbG9yOiNDRjY0MDA7CgkJfQoJCXAudGl0bGUtbWFpbC1yZWZlcmVuY2V7CgkJCXBhZGRpbmctdG9wOiA1cHg7CgkJCXBhZGRpbmctYm90dG9tOiA1cHg7CgkJCXBhZGRpbmctcmlnaHQ6IDEwcHg7CgkJCXRleHQtYWxpZ246cmlnaHQ7CgkJCWxpbmUtaGVpZ2h0OjEzcHQ7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCQkJY29sb3I6IzAwMDAwMDsKCQl9CgkJcC50eXBlLWFib3ZlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCWZvbnQtc2l6ZTo4cHQ7CgkJCWZvbnQtd2VpZ2h0OmJvbGQ7CgkJCWNvbG9yOiM1MDUwNTA7CgkJfQoJCXNwYW4uc3RhdHVzLW5hbWUtYWF7CgkJCWJvcmRlci1yYWRpdXM6IDNweDsgCgkJCWZvbnQtc2l6ZTogOHB0OyAKCQkJdGV4dC1hbGlnbjogY2VudGVyOyAKCQkJdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsgCgkJCWJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7IAoJCQlib3JkZXI6IDFweCBzb2xpZCAjQ0Y2NDAwOyAKCQkJY29sb3I6ICMwMDAwMDA7IAoJCQltYXJnaW4tbGVmdDogNXB4OyAKCQkJZm9udC13ZWlnaHQ6IGJvbGQ7IAoJCX0KICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CjxkaXYgYWxpZ249ImNlbnRlciI+Cjx0YWJsZSBjbGFzcz0iY3VzdG9tLW91dGdvaW5nLW1haWwiIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSI+Cgk8dHI+CgkJPHRkIGNsYXNzPSJ0ZC1zcGFjZWQiPgoJCQk8ZGl2IGFsaWduPSJjZW50ZXIiPgoJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD02MDAgc3R5bGU9J3dpZHRoOjQ1MHB0Jz4KCQkJCQk8dHI+CgkJCQkJCTx0ZCBzdHlsZT0ncGFkZGluZzowY20gMGNtIDBjbSAwY20nPgoJCQkJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSIgc3R5bGU9J3dpZHRoOjEwMCUnPgoJCQkJCQkJCTx0cj4KCQkJCQkJCQkJPHRkPgoJCQkJCQkJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSIgc3R5bGU9J3dpZHRoOjEwMCUnPgoJCQkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCQkJPHRkIGNvbHNwYW49IjIiPgoJCQkJCQkJCQkJCQkJPGltZyBzcmM9IjwlIG91dCA8PCBjb20uYXRsYXNzaWFuLmppcmEuY29tcG9uZW50LkNvbXBvbmVudEFjY2Vzc29yLmdldEFwcGxpY2F0aW9uUHJvcGVydGllcygpLmdldFN0cmluZygiamlyYS5iYXNldXJsIikgJT4vaW1hZ2VzL2xvZ2hpL2xvZ29fRkFBQ19Hcm91cC5wbmciLz4KCQkJCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQkJCQk8L3RyPgoJCQkJCQkJCQkJCQoJCQkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCQkJPHRkPjwvdGQ+CgkJCQkJCQkJCQkJCTx0ZCB3aWR0aD0iNTAlIiBzdHlsZT0nd2lkdGg6NTAuMCU7cGFkZGluZzowY20gMGNtIDBjbSAwY207dGV4dC1hbGlnbjpyaWdodDsnPgoJCQkJCQkJCQkJCQkJPHAgY2xhc3M9InRpdGxlLW1haWwtcmVmZXJlbmNlIiA+CgkJCQkJCQkJCQkJCQkJCVBSRVEgTnVtYmVyOiA8c3Ryb25nIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6MTFwdDtjb2xvcjojQ0Y2NDAwOyI+PCUgb3V0IDw8IGlzc3VlLnBhcmVudE9iamVjdC5nZXRDdXN0b21GaWVsZFZhbHVlKGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoImN1c3RvbWZpZWxkXzIyNzI1IikpJT48L3N0cm9uZz4KCQkJCQkJCQkJCQkJCTwvcD4KCQkJCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQkJCQk8L3RyPgoJCQkJCQkJCQkJPC90YWJsZT4KCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQk8L3RyPgoJCQkJCQkJCTx0cj4KCQkJCQkJCQkJPHRkIGNsYXNzPSJ0ZC1zdW1tYXJ5Ij4KCQkJCQkJCQkJCVBSRVEgTnVtYmVyOiA8c3Ryb25nIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtjb2xvcjojQ0Y2NDAwOyI+PCUgb3V0IDw8IGlzc3VlLnBhcmVudE9iamVjdC5nZXRDdXN0b21GaWVsZFZhbHVlKGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoImN1c3RvbWZpZWxkXzIyNzI1IikpJT48L3N0cm9uZz4KCQkJCQkJCQkJCTxzcGFuIGNsYXNzPSJzdGF0dXMtbmFtZS1hYSI+IFdhaXRpbmcgZm9yIGFwcHJvdmFsPC9zcGFuPgoJCQkJCQkJCQk8L3RkPgoJCQkJCQkJCTwvdHI+CgkJCQkJCQkJPHRyPgoJCQkJCQkJCQk8dGQgY2xhc3M9InRkLXJlZmVyZW5jZSI+CgkJCQkJCQkJCQlZb3UgY2FuIAkJCQkJCQkJCQkKCQkJCQkJCQkJCQk8YSBjbGFzcz0idGQtcmVmZXJlbmNlIiBocmVmPSJodHRwOi8vcHVyY2hhc2VyZXF1ZXN0LmZhYWNzcGEubG9jYWwvZmFhYy1yZGEtdWkvIyEvcmRhL2xpc3QvPCUgb3V0IDw8IGlzc3VlLnBhcmVudE9iamVjdC5nZXRDdXN0b21GaWVsZFZhbHVlKGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoImN1c3RvbWZpZWxkXzIyNzI1IikpJT4iPgoJCQkJCQkJCQkJCQl2aWV3IFBSRVEgZGV0YWlscwoJCQkJCQkJCQkJCTwvYT4KCQkJCQkJCQkJPC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPgoJCQkJCQk8L3RhYmxlPgoKCQkJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSIgc3R5bGU9J3dpZHRoOjEwMCUnPgoJCQkJCQkJPHRyPgoJCQkJCQkJCTx0ZCBjbGFzcz0iZGV0YWlscy1maWVsZC12YWx1ZSI+CQkJCQkJCQkJCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCQk8YnIgLz4KCQkJCQkJCQkJCURlYXIgdXNlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIHB1cmNoYXNlIHJlcXVlc3RzIGluIHF1ZXN0aW9uIGlzIGF3YWl0aW5nIHlvdXIgYXBwcm92YWwuIDxhIGNsYXNzPSJ0ZC1yZWZlcmVuY2UiICBocmVmPSJodHRwOi8vcHVyY2hhc2VyZXF1ZXN0LmZhYWNzcGEubG9jYWwvZmFhYy1yZGEtdWkvIyEvcmRhL3BlbmRpbmdhcHByb3ZhbCI+WW91IGNhbiB2aWV3IHlvdXIgcGVuZGluZyByZXF1ZXN0czwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2luZCByZWdhcmRzPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCZWxvdyByZXBlYXRlZCBpbiBpdGFsaWFuPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHZW50aWxlIHV0ZW50ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGEgcmljaGllc3RhIGRpIGFjcXVpc3RvIGluIG9nZ2V0dG8gw6ggaW4gYXR0ZXNhIGRlbGxhIHN1YSBhcHByb3ZhemlvbmUuIDxhIGNsYXNzPSJ0ZC1yZWZlcmVuY2UiICBocmVmPSJodHRwOi8vcHVyY2hhc2VyZXF1ZXN0LmZhYWNzcGEubG9jYWwvZmFhYy1yZGEtdWkvIyEvcmRhL3BlbmRpbmdhcHByb3ZhbCI+UHVvaSB2aXN1YWxpenphcmUgbGUgdHVlIHJpY2hpZXN0ZSBpbiBhdHRlc2E8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvcmRpYWxpIHNhbHV0aQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+CgkJCQkJCQkJPC90ZD4KCQkJCQkJCTwvdHI+CgkJCQkJCTwvdGFibGU+CgkJCQkJCQoJCQkJCQk8L3RkPgoJCQkJCTwvdHI+CgkJCQk8L3RhYmxlPgoJCQk8L2Rpdj4KCQk8L3RkPgoJPC90cj4KCTx0cj4KCQk8dGQgc3R5bGU9J3BhZGRpbmc6MGNtIDBjbSAxNS4wcHQgMGNtOyc+CgkJCTxwIGFsaWduPWNlbnRlciBzdHlsZT0nbWFyZ2luOjBjbTttYXJnaW4tYm90dG9tOi4wMDAxcHQ7dGV4dC1hbGlnbjpjZW50ZXInPgoJCQkJPHNwYW4gc3R5bGU9J2ZvbnQtc2l6ZTo5LjBwdDtmb250LWZhbWlseToiVmVyZGFuYSI7Y29sb3I6IzAwMDAwMCc+VGhpcyBtZXNzYWdlIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IFB1cmNoYXNlIFJlcXVlc3QgUG9ydGFsLjwvc3Bhbj4KCQkJPC9wPgoJCTwvdGQ+Cgk8L3RyPgo8L3RhYmxlPgo8L2Rpdj4KPC9kaXY+CjwvYm9keT4KPC9odG1sPgo=</arg>
              <arg name="FIELD_EMAIL_SUBJECT_TEMPLATE">YCFgUFJFUSBOdW1iZXI6IDwlIG91dCA8PCBpc3N1ZS5wYXJlbnRPYmplY3QuZ2V0Q3VzdG9tRmllbGRWYWx1ZShjb20uYXRsYXNzaWFuLmppcmEuY29tcG9uZW50LkNvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpLmdldEN1c3RvbUZpZWxkT2JqZWN0KCJjdXN0b21maWVsZF8yMjcyNSIpKSU+IC0gV2FpdGluZyBmb3IgYXBwcm92YWw=</arg>
              <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
              <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.SendCustomEmail</arg>
              <arg name="disabled">false</arg>
              <arg name="FIELD_CONDITION">YCFgbWFpbC5zZXRGcm9tKCJub3JlcGx5LXJkYUBmYWFjZ3JvdXAuY29tIikKCgppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmNvbXBvbmVudC5Db21wb25lbnRBY2Nlc3NvcgoKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5maWVsZHMuQ3VzdG9tRmllbGQKCi8vSW52b2ljZSBOdW1iZXIgdGVzdCAyMzUwOCAtIHByb2QgMjI3NTEKZGVmIHZhbHVlID0gaXNzdWUucGFyZW50T2JqZWN0LmdldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjI3NTEpKQppZiAodmFsdWU9PW51bGwpCglyZXR1cm4gdHJ1ZQplbHNlCiAgICByZXR1cm4gZmFsc2V8fHw=</arg>
              <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
              <arg name="FIELD_PREVIEW_ISSUE">RDA-310</arg>
              <arg name="FIELD_EMAIL_FORMAT">HTML</arg>
              <arg name="events"></arg>
            </function>
            <function type="class">
              <arg name="FIELD_NOTES">YCFgU2VuZCBtYWlsIGZhdHR1cmEgYWQgYXBwcm92YXRvcmU=</arg>
              <arg name="FIELD_DISABLE_VALIDATION"></arg>
              <arg name="FIELD_FROM">noreply-rda@faacgroup.com</arg>
              <arg name="FIELD_INCLUDE_ATTACHMENTS">FIELD_INCLUDE_ATTACHMENTS_NONE</arg>
              <arg name="FIELD_TO_ADDRESSES"></arg>
              <arg name="FIELD_CC_ADDRESSES"></arg>
              <arg name="FIELD_CC_USER_FIELDS"></arg>
              <arg name="FIELD_TO_USER_FIELDS">customfield_22723</arg>
              <arg name="FIELD_FUNCTION_ID">b68e3b6d14da015876c3f316212005098cb11a8d</arg>
              <arg name="FIELD_INCLUDE_ATTACHMENTS_CALLBACK">YCFg</arg>
              <arg name="FIELD_EMAIL_TEMPLATE">YCFgPGh0bWw+CjxoZWFkPgoJPHN0eWxlPgogICAgCXRhYmxlLmN1c3RvbS1vdXRnb2luZy1tYWlsewogICAgICAgIAlmb250LWZhbWlseToiVmVyZGFuYSI7CiAgICAgICAgCXdpZHRoOjEwMCU7CiAgICAgICAgCWJvcmRlci1zcGFjaW5nOiA4cHggMnB4OwogICAgICAgIH0KICAgICAgICBhLmFhLXN1bW1hcnl7CiAgICAgICAgCWNvbG9yOiMwMDAwMDA7CiAgICAgICAgCXRleHQtZGVjb3JhdGlvbjpub25lOwogICAgICAgIH0KICAgICAgICB0ZC50ZC1zcGFjZWR7CiAgICAgICAgCXBhZGRpbmc6MTUuMHB0IDcuNXB0IDcuNXB0IDcuNXB0OwogICAgICAgIH0KICAgICAgICB0ZC50ZC1zdW1tYXJ5ewogICAgICAgIAlmb250LWZhbWlseToiVmVyZGFuYSI7CiAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0OwogICAgICAgIAlib3JkZXItdG9wOndoaXRlc21va2UgMS4wcHQ7CiAgICAgICAgCWJvcmRlci1sZWZ0OiNEREREREQgMS4wcHQ7CiAgICAgICAgCWJvcmRlci1ib3R0b206I0RERERERCAxLjBwdDsKICAgICAgICAJYm9yZGVyLXJpZ2h0OiNEREREREQgMS41cHQ7CiAgICAgICAgCWJvcmRlci1zdHlsZTpzb2xpZDsKICAgICAgICAJYmFja2dyb3VuZDp3aGl0ZTsKCQkJcGFkZGluZy1sZWZ0OjEwcHg7CiAgICAgICAgfQoJCXRkLnRkLXJlZmVyZW5jZXsKCQkJYm9yZGVyLXRvcDp3aGl0ZSAxLjBwdDsKCQkJYm9yZGVyLWxlZnQ6I0RERERERCAxLjBwdDsKCQkJYm9yZGVyLWJvdHRvbTojREREREREIDEuNXB0OwoJCQlib3JkZXItcmlnaHQ6I0RERERERCAxLjVwdDsKCQkJYm9yZGVyLXN0eWxlOnNvbGlkOwoJCQliYWNrZ3JvdW5kOndoaXRlOwoJCQlwYWRkaW5nOjEwcHggMTBweCAxMHB4IDEwcHg7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJY29sb3I6IzAwMzA1MDsKCQkJZm9udC1zaXplOjExcHQ7CgkJfQoJCWEudGQtcmVmZXJlbmNlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCWNvbG9yOiMwMDMwNTA7CgkJCWZvbnQtc2l6ZToxMXB0OwoJCQl0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lOwoJCX0KCQlwLnRpdGxlLWNvbW1lbnR7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKICAgICAgICAgICAgZm9udC1zaXplOjEycHQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7CgkJCXRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7CgkJfQoJCXAuYXV0aG9yLWNvbW1lbnR7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKICAgICAgICAgICAgZm9udC1zaXplOjExcHQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7CgkJfQoJCXRkLmNvbW1lbnQtYm94ewoJCQliYWNrZ3JvdW5kOiNGRkZGRkY7CgkJCXBhZGRpbmc6MTBweCAxMHB4IDEwcHggMTBweDsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQlmb250LXNpemU6MTFwdDsKCQl9CgkJdGQuZGV0YWlscy1maWVsZC1uYW1lewoJCQlmb250LXNpemU6MTBwdDsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQl2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7CgkJCXBhZGRpbmctdG9wOiAycHg7CgkJCXBhZGRpbmctYm90dG9tOiAycHg7CgkJfQoJCXAuZGV0YWlscy1ib3gtdGl0bGV7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJZm9udC1zaXplOjExcHQ7CgkJCXBhZGRpbmctdG9wOiAxNXB4OwoJCQlwYWRkaW5nLWJvdHRvbTogMTBweDsKCQl9CgkJdGQuZGV0YWlscy1maWVsZC12YWx1ZXsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJdmVydGljYWwtYWxpZ246bWlkZGxlOwoJCQlwYWRkaW5nLXRvcDogMnB4OwoJCQlwYWRkaW5nLWJvdHRvbTogMnB4OwoJCX0KCQlhLnRpdGxlLW1haWwtcmVmZXJlbmNlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCXBhZGRpbmctdG9wOiA1cHg7CgkJCXBhZGRpbmctYm90dG9tOiA1cHg7CgkJCXBhZGRpbmctbGVmdDogMTBweDsKCQkJZGlzcGxheTogaW5saW5lLWJsb2NrOwoJCQlmb250LXNpemU6MTFwdDsKCQkJY29sb3I6I0NGNjQwMDsKCQl9CgkJYS50aXRsZS1tYWlsLXBvcnRhbHsKCQkJZm9udC1mYW1pbHk6IlZlcmRhbmEiOwoJCQlwYWRkaW5nLXRvcDogNXB4OwoJCQlwYWRkaW5nLWJvdHRvbTogNXB4OwoJCQlwYWRkaW5nLWxlZnQ6IDEwcHg7CgkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWNvbG9yOiNDRjY0MDA7CgkJfQoJCXAudGl0bGUtbWFpbC1yZWZlcmVuY2V7CgkJCXBhZGRpbmctdG9wOiA1cHg7CgkJCXBhZGRpbmctYm90dG9tOiA1cHg7CgkJCXBhZGRpbmctcmlnaHQ6IDEwcHg7CgkJCXRleHQtYWxpZ246cmlnaHQ7CgkJCWxpbmUtaGVpZ2h0OjEzcHQ7CgkJCWZvbnQtZmFtaWx5OiJWZXJkYW5hIjsKCQkJZm9udC1zaXplOjExcHQ7CgkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCQkJY29sb3I6IzAwMDAwMDsKCQl9CgkJcC50eXBlLWFib3ZlewoJCQlmb250LWZhbWlseToiVmVyZGFuYSI7CgkJCWZvbnQtc2l6ZTo4cHQ7CgkJCWZvbnQtd2VpZ2h0OmJvbGQ7CgkJCWNvbG9yOiM1MDUwNTA7CgkJfQoJCXNwYW4uc3RhdHVzLW5hbWUtYWF7CgkJCWJvcmRlci1yYWRpdXM6IDNweDsgCgkJCWZvbnQtc2l6ZTogOHB0OyAKCQkJdGV4dC1hbGlnbjogY2VudGVyOyAKCQkJdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsgCgkJCWJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7IAoJCQlib3JkZXI6IDFweCBzb2xpZCAjQ0Y2NDAwOyAKCQkJY29sb3I6ICMwMDAwMDA7IAoJCQltYXJnaW4tbGVmdDogNXB4OyAKCQkJZm9udC13ZWlnaHQ6IGJvbGQ7IAoJCX0KICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CjxkaXYgYWxpZ249ImNlbnRlciI+Cjx0YWJsZSBjbGFzcz0iY3VzdG9tLW91dGdvaW5nLW1haWwiIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSI+Cgk8dHI+CgkJPHRkIGNsYXNzPSJ0ZC1zcGFjZWQiPgoJCQk8ZGl2IGFsaWduPSJjZW50ZXIiPgoJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD02MDAgc3R5bGU9J3dpZHRoOjQ1MHB0Jz4KCQkJCQk8dHI+CgkJCQkJCTx0ZCBzdHlsZT0ncGFkZGluZzowY20gMGNtIDBjbSAwY20nPgoJCQkJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSIgc3R5bGU9J3dpZHRoOjEwMCUnPgoJCQkJCQkJCTx0cj4KCQkJCQkJCQkJPHRkPgoJCQkJCQkJCQkJPHRhYmxlIGJvcmRlcj0wIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MCB3aWR0aD0iMTAwJSIgc3R5bGU9J3dpZHRoOjEwMCUnPgoJCQkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCQkJPHRkIGNvbHNwYW49IjIiPgoJCQkJCQkJCQkJCQkJPGltZyBzcmM9IjwlIG91dCA8PCBjb20uYXRsYXNzaWFuLmppcmEuY29tcG9uZW50LkNvbXBvbmVudEFjY2Vzc29yLmdldEFwcGxpY2F0aW9uUHJvcGVydGllcygpLmdldFN0cmluZygiamlyYS5iYXNldXJsIikgJT4vaW1hZ2VzL2xvZ2hpL2xvZ29fRkFBQ19Hcm91cC5wbmciLz4KCQkJCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQkJCQk8L3RyPgoJCQkJCQkJCQkJCQoJCQkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCQkJPHRkPjwvdGQ+CgkJCQkJCQkJCQkJCTx0ZCB3aWR0aD0iNTAlIiBzdHlsZT0nd2lkdGg6NTAuMCU7cGFkZGluZzowY20gMGNtIDBjbSAwY207dGV4dC1hbGlnbjpyaWdodDsnPgoJCQkJCQkJCQkJCQkJPHAgY2xhc3M9InRpdGxlLW1haWwtcmVmZXJlbmNlIiA+CgkJCQkJCQkJCQkJCQkJCUludm9pY2UgTnVtYmVyOiA8c3Ryb25nIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6MTFwdDtjb2xvcjojQ0Y2NDAwOyI+PCUgb3V0IDw8IGlzc3VlLnBhcmVudE9iamVjdC5nZXRDdXN0b21GaWVsZFZhbHVlKGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoImN1c3RvbWZpZWxkXzIyNzUxIikpJT48L3N0cm9uZz4KCQkJCQkJCQkJCQkJCTwvcD4KCQkJCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQkJCQk8L3RyPgoJCQkJCQkJCQkJPC90YWJsZT4KCQkJCQkJCQkJPC90ZD4KCQkJCQkJCQk8L3RyPgoJCQkJCQkJCTx0cj4KCQkJCQkJCQkJPHRkIGNsYXNzPSJ0ZC1zdW1tYXJ5Ij4KCQkJCQkJCQkJCUludm9pY2UgTnVtYmVyOiA8c3Ryb25nIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtjb2xvcjojQ0Y2NDAwOyI+PCUgb3V0IDw8IGlzc3VlLnBhcmVudE9iamVjdC5nZXRDdXN0b21GaWVsZFZhbHVlKGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoImN1c3RvbWZpZWxkXzIyNzUxIikpJT48L3N0cm9uZz4KCQkJCQkJCQkJCTxzcGFuIGNsYXNzPSJzdGF0dXMtbmFtZS1hYSI+IFdhaXRpbmcgZm9yIGFwcHJvdmFsPC9zcGFuPgoJCQkJCQkJCQk8L3RkPgoJCQkJCQkJCTwvdHI+CgkJCQkJCQkJPHRyPgoJCQkJCQkJCQk8dGQgY2xhc3M9InRkLXJlZmVyZW5jZSI+CgkJCQkJCQkJCQlZb3UgY2FuIAkJCQkJCQkJCQkKCQkJCQkJCQkJCQk8YSBjbGFzcz0idGQtcmVmZXJlbmNlIiBocmVmPSJodHRwOi8vcHVyY2hhc2VyZXF1ZXN0LmZhYWNzcGEubG9jYWwvZmFhYy1yZGEtdWkvIyEvcmRhL2ludm9pY2VkaWZmZXJlbmNlcyI+CgkJCQkJCQkJCQkJCXZpZXcgaW52b2ljZSBsaXN0CgkJCQkJCQkJCQkJPC9hPgoJCQkJCQkJCQk8L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+CgkJCQkJCTwvdGFibGU+CgoJCQkJCQk8dGFibGUgYm9yZGVyPTAgY2VsbHNwYWNpbmc9MCBjZWxscGFkZGluZz0wIHdpZHRoPSIxMDAlIiBzdHlsZT0nd2lkdGg6MTAwJSc+CgkJCQkJCQk8dHI+CgkJCQkJCQkJPHRkIGNsYXNzPSJkZXRhaWxzLWZpZWxkLXZhbHVlIj4JCQkJCQkJCQkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJCTxiciAvPgoJCQkJCQkJCQkJRGVhciB1c2VyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGUgaW52b2ljZSBpbiBxdWVzdGlvbiBpcyBhd2FpdGluZyB5b3VyIGFwcHJvdmFsLiA8YSBjbGFzcz0idGQtcmVmZXJlbmNlIiAgaHJlZj0iaHR0cDovL3B1cmNoYXNlcmVxdWVzdC5mYWFjc3BhLmxvY2FsL2ZhYWMtcmRhLXVpLyMhL3JkYS9wZW5kaW5nYXBwcm92YWwiPllvdSBjYW4gdmlldyB5b3VyIHBlbmRpbmcgcmVxdWVzdHM8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtpbmQgcmVnYXJkczxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQmVsb3cgcmVwZWF0ZWQgaW4gaXRhbGlhbjxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS08YnIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2VudGlsZSB1dGVudGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhIGZhdHR1cmEgaW4gb2dnZXR0byDDqCBpbiBhdHRlc2EgZGVsbGEgc3VhIGFwcHJvdmF6aW9uZS4gPGEgY2xhc3M9InRkLXJlZmVyZW5jZSIgIGhyZWY9Imh0dHA6Ly9wdXJjaGFzZXJlcXVlc3QuZmFhY3NwYS5sb2NhbC9mYWFjLXJkYS11aS8jIS9yZGEvcGVuZGluZ2FwcHJvdmFsIj5QdW9pIHZpc3VhbGl6emFyZSBsZSB0dWUgcmljaGllc3RlIGluIGF0dGVzYTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29yZGlhbGkgc2FsdXRpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz4KCQkJCQkJCQk8L3RkPgoJCQkJCQkJPC90cj4KCQkJCQkJPC90YWJsZT4KCQkJCQkJCgkJCQkJCTwvdGQ+CgkJCQkJPC90cj4KCQkJCTwvdGFibGU+CgkJCTwvZGl2PgoJCTwvdGQ+Cgk8L3RyPgoJPHRyPgoJCTx0ZCBzdHlsZT0ncGFkZGluZzowY20gMGNtIDE1LjBwdCAwY207Jz4KCQkJPHAgYWxpZ249Y2VudGVyIHN0eWxlPSdtYXJnaW46MGNtO21hcmdpbi1ib3R0b206LjAwMDFwdDt0ZXh0LWFsaWduOmNlbnRlcic+CgkJCQk8c3BhbiBzdHlsZT0nZm9udC1zaXplOjkuMHB0O2ZvbnQtZmFtaWx5OiJWZXJkYW5hIjtjb2xvcjojMDAwMDAwJz5UaGlzIG1lc3NhZ2UgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgUHVyY2hhc2UgUmVxdWVzdCBQb3J0YWwuPC9zcGFuPgoJCQk8L3A+CgkJPC90ZD4KCTwvdHI+CjwvdGFibGU+CjwvZGl2Pgo8L2Rpdj4KPC9ib2R5Pgo8L2h0bWw+Cg==</arg>
              <arg name="FIELD_EMAIL_SUBJECT_TEMPLATE">YCFgSW52b2ljZSBOdW1iZXI6IDwlIG91dCA8PCBpc3N1ZS5wYXJlbnRPYmplY3QuZ2V0Q3VzdG9tRmllbGRWYWx1ZShjb20uYXRsYXNzaWFuLmppcmEuY29tcG9uZW50LkNvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpLmdldEN1c3RvbUZpZWxkT2JqZWN0KCJjdXN0b21maWVsZF8yMjc1MSIpKSU+IC0gV2FpdGluZyBmb3IgYXBwcm92YWw=</arg>
              <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
              <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.SendCustomEmail</arg>
              <arg name="disabled">false</arg>
              <arg name="FIELD_CONDITION">YCFgbWFpbC5zZXRGcm9tKCJub3JlcGx5LXJkYUBmYWFjZ3JvdXAuY29tIikKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuZmllbGRzLkN1c3RvbUZpZWxkCi8vSW52b2ljZSBOdW1iZXIgdGVzdCAyMzUwOCAtIHByb2QgMjI3NTEKZGVmIHZhbHVlID0gaXNzdWUucGFyZW50T2JqZWN0LmdldEN1c3RvbUZpZWxkVmFsdWUoQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkuZ2V0Q3VzdG9tRmllbGRPYmplY3QoMjI3NTEpKQppZiAodmFsdWUhPW51bGwpCglyZXR1cm4gdHJ1ZQplbHNlCiAgICByZXR1cm4gZmFsc2V8fHw=</arg>
              <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
              <arg name="FIELD_PREVIEW_ISSUE">RDA-310</arg>
              <arg name="FIELD_EMAIL_FORMAT">HTML</arg>
              <arg name="events"></arg>
            </function>
          </post-functions>
        </unconditional-result>
      </results>
    </action>
  </initial-actions>
  <global-actions>
    <action id="11" name="Deleted">
      <meta name="jira.description"></meta>
      <meta name="jira.fieldscreen.id"></meta>
      <results>
        <unconditional-result old-status="null" status="null" step="2">
          <post-functions>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
            </function>
            <function type="class">
              <arg name="eventTypeId">13</arg>
              <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
            </function>
          </post-functions>
        </unconditional-result>
      </results>
    </action>
  </global-actions>
  <common-actions>
    <action id="41" name="Old Flow">
      <meta name="jira.description"></meta>
      <meta name="jira.fieldscreen.id"></meta>
      <results>
        <unconditional-result old-status="null" status="null" step="4">
          <post-functions>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
            </function>
            <function type="class">
              <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
            </function>
            <function type="class">
              <arg name="eventTypeId">13</arg>
              <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
            </function>
          </post-functions>
        </unconditional-result>
      </results>
    </action>
  </common-actions>
  <steps>
    <step id="2" name="Deleted">
      <meta name="jira.status.id">10335</meta>
    </step>
    <step id="3" name="Rejected">
      <meta name="jira.status.id">11436</meta>
      <actions>
<common-action id="41" />
        <action id="71" name="To Waitinig for Approval">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="7">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
      </actions>
    </step>
    <step id="4" name="Old Flow">
      <meta name="jira.status.id">14437</meta>
    </step>
    <step id="5" name="Approved RDA">
      <meta name="jira.status.id">14436</meta>
      <actions>
<common-action id="41" />
      </actions>
    </step>
    <step id="7" name="Waiting for Approval">
      <meta name="jira.status.id">13527</meta>
      <actions>
<common-action id="41" />
        <action id="51" name="Approve">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="5">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
                <function type="class">
                  <arg name="FIELD_FUNCTION_ID">b9c595389a43e7a2891d4a818e10723c4ddfbbb0</arg>
                  <arg name="FIELD_NOTES">YCFgQ3JlbyBGbHVzc28gYXBwcm92YXRpdm8gUkRB</arg>
                  <arg name="FIELD_SCRIPT_FILE_OR_SCRIPT">YCFgeyJzY3JpcHQiOiJpbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmNvbXBvbmVudC5Db21wb25lbnRBY2Nlc3NvclxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZVxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5NdXRhYmxlSXNzdWVcbmltcG9ydCBjb20ub3BlbnN5bXBob255LndvcmtmbG93LldvcmtmbG93Q29udGV4dDtcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuY29uZmlnLlN1YlRhc2tNYW5hZ2VyXG4vL2ltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuV29ya2Zsb3dUcmFuc2l0aW9uVXRpbDtcbi8vaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS53b3JrZmxvdy5Xb3JrZmxvd1RyYW5zaXRpb25VdGlsSW1wbDtcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEudXRpbC5KaXJhVXRpbHM7XG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLnN0YXR1cy5TdGF0dXNcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEudXNlci5BcHBsaWNhdGlvblVzZXJcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuanFsLnBhcnNlci5KcWxRdWVyeVBhcnNlclxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS53ZWIuYmVhbi5QYWdlckZpbHRlclxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5iYy5pc3N1ZS5zZWFyY2guU2VhcmNoU2VydmljZVxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZU1hbmFnZXJcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuQ3VzdG9tRmllbGRNYW5hZ2VyXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLmZpZWxkcy5DdXN0b21GaWVsZFxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS51c2VyLnV0aWwuVXNlclV0aWxcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuY29uZmlnLlJlc29sdXRpb25NYW5hZ2VyXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmV2ZW50LnR5cGUuRXZlbnREaXNwYXRjaE9wdGlvblxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5pbmRleC5Jc3N1ZUluZGV4aW5nU2VydmljZVxuaW1wb3J0IG9yZy5hcGFjaGUubG9nNGouQ2F0ZWdvcnlcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuVHJhbnNpdGlvbk9wdGlvbnNcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuYmMuaXNzdWUuSXNzdWVTZXJ2aWNlXG5cblNlYXJjaFNlcnZpY2UgXHRcdHNlYXJjaFNlcnZpY2UgXHRcdD0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KFNlYXJjaFNlcnZpY2UuY2xhc3MpXG5Vc2VyVXRpbCBcdFx0XHR1c2VyVXRpbCBcdFx0XHQ9IENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJVdGlsKClcbklzc3VlTWFuYWdlciBcdFx0aXNzdWVNYW5hZ2VyIFx0XHQ9IENvbXBvbmVudEFjY2Vzc29yLmdldElzc3VlTWFuYWdlcigpXG5Jc3N1ZUluZGV4aW5nU2VydmljZSBpc3N1ZUluZGV4aW5nU2VydmljZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChJc3N1ZUluZGV4aW5nU2VydmljZSlcbmRlZiBqcWxRdWVyeVBhcnNlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChKcWxRdWVyeVBhcnNlcilcblN1YlRhc2tNYW5hZ2VyIHN1YlRhc2tNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0U3ViVGFza01hbmFnZXIoKTtcbkN1c3RvbUZpZWxkTWFuYWdlciBcdGN1c3RvbUZpZWxkTWFuYWdlciBcdD0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKClcbmRlZiBpc3N1ZUZhY3RvcnkgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZUZhY3RvcnkoKVxuZGVmIGNvbnN0YW50TWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbnN0YW50c01hbmFnZXIoKVxuXG4vL011dGFibGVJc3N1ZSBpc3N1ZSA9IGlzc3VlTWFuYWdlci5nZXRJc3N1ZUJ5S2V5SWdub3JlQ2FzZShcIlJEQS0yNDI2XCIpXG5NdXRhYmxlSXNzdWUgcGFyZW50SXNzdWUgPSBpc3N1ZS5wYXJlbnRPYmplY3Q7XG5cbkNhdGVnb3J5IGxvZyA9IENhdGVnb3J5LmdldEluc3RhbmNlKFwiY29tLm9ucmVzb2x2ZS5qaXJhLmdyb292eS5Qb3N0RnVuY3Rpb25cIilcbmxvZy5zZXRMZXZlbChvcmcuYXBhY2hlLmxvZzRqLkxldmVsLkRFQlVHKVxuXG5BcHBsaWNhdGlvblVzZXIgb2xkVXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQubG9nZ2VkSW5Vc2VyXG5Db21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LnNldExvZ2dlZEluVXNlcihDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyTWFuYWdlcigpLmdldFVzZXJCeUtleShcImF0bGFzc2lhbl9mYWFjX3NlcnZpY2VfZGVza1wiKSlcbkFwcGxpY2F0aW9uVXNlciB1c2VyID0gQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5sb2dnZWRJblVzZXJcbklzc3VlU2VydmljZSBpc3N1ZVNlcnZpY2UgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZVNlcnZpY2UoKVxuVHJhbnNpdGlvbk9wdGlvbnMgdHJhbnNpdGlvbk9wdGlvbnMgPSBuZXcgVHJhbnNpdGlvbk9wdGlvbnMuQnVpbGRlcigpLnNraXBDb25kaXRpb25zKCkuc2tpcFBlcm1pc3Npb25zKCkuc2tpcFZhbGlkYXRvcnMoKS5idWlsZCgpXG5cbi8qIEdldCBJbnNpZ2h0IElRTCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi9cbkNsYXNzIGlxbEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcyhcImNvbS5yaWFkYWxhYnMuamlyYS5wbHVnaW5zLmluc2lnaHQuY2hhbm5lbC5leHRlcm5hbC5hcGkuZmFjYWRlLklRTEZhY2FkZVwiKTsgXG5kZWYgaXFsRmFjYWRlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0T1NHaUNvbXBvbmVudEluc3RhbmNlT2ZUeXBlKGlxbEZhY2FkZUNsYXNzKTtcbi8qIEdldCBJbnNpZ2h0IE9iamVjdCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi9cbkNsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcyhcImNvbS5yaWFkYWxhYnMuamlyYS5wbHVnaW5zLmluc2lnaHQuY2hhbm5lbC5leHRlcm5hbC5hcGkuZmFjYWRlLk9iamVjdEZhY2FkZVwiKTtcbmRlZiBvYmplY3RGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUob2JqZWN0RmFjYWRlQ2xhc3MpO1xuXG4vL3RvdGFsIHByaWNlIHRlc3QgMjI3MDQgLSBwcm9kIDIyNzMyXG4vL3Nvc3RpdHVpc2NvIDIyNzMyIGNvbiBpbCBjYW1wbyB0b3RhbCBwcmljZSBpbiB2YWx1dGEgbG9jYWxlIDIyNzMzIC0gSURUUy01MDA2N1xuQ3VzdG9tRmllbGQgVG90YWxQcmljZUZpZWxkID0gY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MzNcIikpXG5kZWYgVG90UHJpY2VWID0gcGFyZW50SXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShUb3RhbFByaWNlRmllbGQpXG5cbi8vUkRBIFR5cGUgdGVzdCAyMjcwNyAtIHByb2QgMjI3MzVcbkN1c3RvbUZpZWxkIFJkYVR5cGVGaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIyNzM1XCIpKVxuZGVmIFJkYVR5cGVWID0gcGFyZW50SXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShSZGFUeXBlRmllbGQpXG5cbi8vRnVuY3Rpb24gdGVzdCAyMjcwMSAtIHByb2QgMjI3MjlcbkN1c3RvbUZpZWxkIEZ1bmN0aW9uRmllbGQgPSBjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoXCIyMjcyOVwiKSlcbmRlZiBGdW5jdGlvbk5hbWUgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKEZ1bmN0aW9uRmllbGQpXG5cbi8vTWF0ZXJpYWwgR3JvdXAgdGVzdCAyMzQwMCAtIHByb2QgMjI3NDNcbkN1c3RvbUZpZWxkIG1hdGVyaWFsR3JvdXAgPSBjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoXCIyMjc0M1wiKSlcbmRlZiBtYXRlcmlhbEdyb3VwViA9IHBhcmVudElzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUobWF0ZXJpYWxHcm91cClcbmRlZiBtYXRHcm91cHMgPSBbXVxuaWYgKG1hdGVyaWFsR3JvdXBWIT1udWxsKVxuIFx0bWF0R3JvdXBzPSBtYXRlcmlhbEdyb3VwVi5zcGxpdChcIjtcIilcblxuLy9FeHRyYSBCdWRnZXQgdGVzdCAyMjcwNiAtIHByb2QgMjI3MzRcbmRlZiBFeHRyYUJ1ZGdldCA9IGZhbHNlXG5DdXN0b21GaWVsZCBFeHRyYUJ1ZGdldEZpZWxkID0gY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MzRcIikpXG5FeHRyYUJ1ZGdldCA9IHBhcmVudElzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUoRXh0cmFCdWRnZXRGaWVsZClcbmlmIChFeHRyYUJ1ZGdldCAhPSBudWxsKXtcbiAgICBpZiAoRXh0cmFCdWRnZXRbMF0udG9TdHJpbmcoKSA9PSBcIlllc1wiKVxuICAgICAgICBFeHRyYUJ1ZGdldCA9IHRydWVcbn1cbmlmIChFeHRyYUJ1ZGdldCA9PSBudWxsKXtcbiAgICBFeHRyYUJ1ZGdldCA9IGZhbHNlXG59XG5cbi8vSW52b2ljZSBEaWZmZXJlbmNlIHRlc3QgMjM1MDEgLSBwcm9kIDIyNzQ4XG5kZWYgRGlmZkludm9pY2UgPSBmYWxzZVxuQ3VzdG9tRmllbGQgRGlmZkludm9pY2VGaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIyNzQ4XCIpKVxuRGlmZkludm9pY2UgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKERpZmZJbnZvaWNlRmllbGQpXG5pZiAoRGlmZkludm9pY2UgIT0gbnVsbCl7XG4gICAgaWYgKERpZmZJbnZvaWNlWzBdLnRvU3RyaW5nKCkgPT0gXCJZZXNcIilcbiAgICAgICAgRGlmZkludm9pY2UgPSB0cnVlXG59XG5pZiAoRGlmZkludm9pY2UgPT0gbnVsbCl7XG4gICAgRGlmZkludm9pY2UgPSBmYWxzZVxufVxubG9nLmRlYnVnIFwiRGlmZkludm9pY2UgXCIgKyBEaWZmSW52b2ljZVxubG9nLmRlYnVnIFwiRXh0cmFCdWRnZXQgXCIgKyBFeHRyYUJ1ZGdldFxuXG4vL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAyMjcxOVxuZGVmIGZsb3dUeXBlID0gaXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShDb21wb25lbnRBY2Nlc3Nvci5nZXRDdXN0b21GaWVsZE1hbmFnZXIoKS5nZXRDdXN0b21GaWVsZE9iamVjdCgyMjcxOSkpXG5cbmRlZiBqcWxTZWFyY2ggPSBcIlwiXG5kZWYgcXVlcnlcbmRlZiBzZWFyY2hcblxuZGVmIHJlc29sdXRpb25NYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KFJlc29sdXRpb25NYW5hZ2VyKVxuXG5Db21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LnNldExvZ2dlZEluVXNlcihDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyTWFuYWdlcigpLmdldFVzZXJCeUtleShcImF0bGFzc2lhbl9mYWFjX3NlcnZpY2VfZGVza1wiKSlcbmRlZiBjdXJyZW50VXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuZ2V0TG9nZ2VkSW5Vc2VyKCk7XG5cbmlmIChmbG93VHlwZS50b1N0cmluZygpPT0nQ29udHJvbGxpbmcgZnVuY3Rpb24nICl7XG4gICAgbG9nLmRlYnVnIFwiZmxvd1R5cGU6IFwiICsgZmxvd1R5cGVcbiAgICBqcWxTZWFyY2ggPSBcInByb2plY3QgPSAnXCIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArIFwiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCByZXNvbHV0aW9uID0gVW5yZXNvbHZlZCBBTkQgcGFyZW50ID0gJ1wiICsgcGFyZW50SXNzdWUua2V5ICsgXCInIEFORCBrZXkgIT0gJ1wiICsgaXNzdWUua2V5ICsgXCInXCJcblx0cXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICBzZWFyY2ggPSBzZWFyY2hTZXJ2aWNlLnNlYXJjaCh1c2VyLCBxdWVyeSwgUGFnZXJGaWx0ZXIuZ2V0VW5saW1pdGVkRmlsdGVyKCkpXG4gICAgXG4gICAgLy8gc2V0IFJlc29sdXRpb24gZGVpIHN1YnRhc2sgY2hlIG5vbiBzaWEgcXVlbGxvIGNvcnJlbnRlIGUgbWV0dG8gbG8gc3RhdHVzIGluIGFwcHJvdmVkIHRyYW5uZSBwZXIgaWwgY2FzbyBkaSBhcHByb3ZhemlvbmUgY29uZ2l1bnRhIENGTytDRU9cbiAgICBmb3IgKGN1cnJJIGluIHNlYXJjaC5yZXN1bHRzKVxuICAgIHtcbiAgICAgICAgTXV0YWJsZUlzc3VlIGN1cnJJc3N1ZSA9aXNzdWVNYW5hZ2VyLmdldElzc3VlQnlLZXlJZ25vcmVDYXNlKGN1cnJJLmtleSlcbiAgICAgICAgXG4gICAgICAgIC8vQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5zZXRMb2dnZWRJblVzZXIoQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlck1hbmFnZXIoKS5nZXRVc2VyQnlLZXkoXCJhdGxhc3NpYW5fZmFhY19zZXJ2aWNlX2Rlc2tcIikpXG4gICAgICAgIC8vZGVmIGN1cnJlbnRVc2VyID0gQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5nZXRMb2dnZWRJblVzZXIoKTtcbiAgICBcbiAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIGN1cnJJc3N1ZS5nZXRJZCgpLDYxLCBpc3N1ZVNlcnZpY2UubmV3SXNzdWVJbnB1dFBhcmFtZXRlcnMoKSwgdHJhbnNpdGlvbk9wdGlvbnMpXG4gICAgICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgLyogV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCB3b3JrZmxvd1RyYW5zaXRpb25VdGlsID0gKFdvcmtmbG93VHJhbnNpdGlvblV0aWwpIEppcmFVdGlscy5sb2FkQ29tcG9uZW50KFdvcmtmbG93VHJhbnNpdGlvblV0aWxJbXBsLmNsYXNzKTtcbiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRJc3N1ZShjdXJySXNzdWUpO1xuXHRcdC8vdHJhbnNhemlvbmUgc3VpIHN1YnRhc2sgVG9BcHByb3ZlZCB0ZXN0IDMxIC0gcHJvZCA2MVxuICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbig2MSk7XG5cdFx0aWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICBcdHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcblx0XHR9Ki9cblx0XHQvL0hpZGUgdGVzdCAyMzMwMCAtIHByb2QgMjI3MjBcbiAgICAgICAgQ3VzdG9tRmllbGQgaGlkZSA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIyNzIwXCIpKVxuICAgICAgICBjdXJySXNzdWUuc2V0Q3VzdG9tRmllbGRWYWx1ZShoaWRlLCBbQ29tcG9uZW50QWNjZXNzb3Iub3B0aW9uc01hbmFnZXIuZ2V0T3B0aW9ucyhoaWRlLmdldFJlbGV2YW50Q29uZmlnKGN1cnJJc3N1ZSkpPy5maW5kIHsgaXQudG9TdHJpbmcoKSA9PSBcIlllc1wiIH1dKVxuICAgICAgICBsb2cuZGVidWcgY3Vycklzc3VlXG4gICAgICAgIGxvZy5kZWJ1ZyBcImVudHJvIGluIGNvbnRyb2xsaW5nIGUgc2V0dG8gaGlkZVwiXG4gICAgICAgIGlzc3VlTWFuYWdlci51cGRhdGVJc3N1ZSh1c2VyLCBjdXJySXNzdWUsIEV2ZW50RGlzcGF0Y2hPcHRpb24uRE9fTk9UX0RJU1BBVENILCBmYWxzZSlcbiAgICB9XG59XG5cbi8vIHNldCByZXNvbHV0aW9uIGRlbCBzdWJ0YXNrIGNvcnJlbnRlIC0gbG8gc3RhdHVzIHNhclx1MDBlMCBnaVx1MDBlMCBpbXBvc3RhdG8gYWQgYXBwcm92ZWRcbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiQ29udHJvbGxpbmcgZnVuY3Rpb25cIilcblx0aXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKFwiQ29udHJvbGxpbmcgZnVuY3Rpb25cIikpXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIlRlY2huaWNhbCBBcHByb3ZhbFwiKVxuXHRpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoXCJUZWNobmljYWwgQXBwcm92YWxcIikpXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIlB1cmNoYXNlIGJ5IGNyZWRpdCBjYXJkXCIpXG5cdGlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZShcIlB1cmNoYXNlIGJ5IGNyZWRpdCBjYXJkXCIpKVxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJGaXJzdCBMZXZlbCBBcHByb3ZhbFwiKVxuXHRpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoXCJGaXJzdCBMZXZlbCBBcHByb3ZhbFwiKSlcbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiU2Vjb25kIExldmVsIEFwcHJvdmFsXCIpXG5cdGlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZShcIlNlY29uZCBMZXZlbCBBcHByb3ZhbFwiKSlcbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiVGhpcmQgTGV2ZWwgQXBwcm92YWxcIilcblx0aXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKFwiVGhpcmQgTGV2ZWwgQXBwcm92YWxcIikpXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIkdyb3VwIExldmVsIEFwcHJvdmFsXCIpXG5cdGlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZShcIkdyb3VwIExldmVsIEFwcHJvdmFsXCIpKVxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJDRU8rQ0ZPXCIpXG5cdGlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZShcIkNFTytDRk9cIikpXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIkdlbmVyYWwgTWFuYWdlclwiKVxuXHRpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoXCJHZW5lcmFsIE1hbmFnZXJcIikpXG5cbmlzc3VlTWFuYWdlci51cGRhdGVJc3N1ZSh1c2VyLCBpc3N1ZSwgRXZlbnREaXNwYXRjaE9wdGlvbi5ET19OT1RfRElTUEFUQ0gsIGZhbHNlKVxuXG4vL1dvcmtmbG93VHJhbnNpdGlvblV0aWwgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbCA9IChXb3JrZmxvd1RyYW5zaXRpb25VdGlsKSBKaXJhVXRpbHMubG9hZENvbXBvbmVudChXb3JrZmxvd1RyYW5zaXRpb25VdGlsSW1wbC5jbGFzcyk7XG4vL3dvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0SXNzdWUocGFyZW50SXNzdWUpO1xuXG4vL3NlIHNvbm8gbmVsbGEgYXBwcm92YXppb25lIGZhdHR1cmEgZSBzb25vIGNvbnRyb2xsaW5nLCBkb3BvIGF2ZXIgYXBwcm92YXRvIGlsIHNlY29uZG8gY29udHJvbGxpbmcgaW4gYXV0b21hdGljbyBjaGl1ZG8gbGEgaXNzdWUgcGFkcmUgcGVyY2hcdTAwZTggbm9uIGNpIHNvbm8gdWx0ZXJpb25pIHN0ZXAgYXBwcm92YXRpdmlcbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiQ29udHJvbGxpbmcgZnVuY3Rpb25cIiAmJiBEaWZmSW52b2ljZSl7XG4gICAgbG9nLmRlYnVnIFwiQ29udHJvbGxpbmcgZnVuY3Rpb24gLSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNoXHUwMGU4IG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lXCJcbiAgICAvL1RyYW5zYXppb25lIHBhZHJlIEFwcHJvdmVkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTFcbiAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgIH1cbiAgICAvKlxuICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTtcbiAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcbiAgICB9Ki9cbiAgICBmbG93VHlwZSA9IFwiXCJcbn0gIFxuLy9yaWNlcmNhIGRlbGxvIHN0ZXAgYXBwcm92YXRpdm8gIFxuU3RyaW5nIHF1ZXJ5UGFyYW0gPSBcIlxcXCJcIiArIEZ1bmN0aW9uTmFtZVswXS5nZXROYW1lKCkgKyBcIlxcXCJcIlxuXG5kZWYgb2JqZWN0c0Z1bmN0aW9uID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBRnVuY3Rpb25zXFxcIiBBTkQgXFxcIk5hbWVcXFwiIElOIChcIiArIHF1ZXJ5UGFyYW0gKyBcIilcIik7IFxuXG4vL0NvbXBhbnkgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxOTggLSBwcm9kIDI1NzBcbmRlZiBjb21wYW55ID0gXCJcXFwiXCIgKyBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NzApLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpICsgXCJcXFwiXCJcblxuZGVmIGdyb3VwQ29udHJvbGxlclxuZGVmIG9iamVjdHNDb250cm9sbGluZ1xuLy9Hcm91cCBDb250cm9sbGlnIGluc2lnaHQgUkRBRnVuY3Rpb24gdGVzdCAzMTc1IC0gcHJvZCAyNTY3XG5pZiAob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSAhPSBudWxsKXtcbiAgICAvL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1Njdcblx0Z3JvdXBDb250cm9sbGVyID0gb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKVxuICAgIG9iamVjdHNDb250cm9sbGluZyA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUNvbnRyb2xsaW5nXFxcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSBcIiArIGdyb3VwQ29udHJvbGxlciArIFwiKVwiKVxufVxuLy9Hcm91cCBOYW1lIGluc2lnaHQgUkRBRnVuY3Rpb24gIHRlc3QgMzE3MiAtIHByb2QgMjU2NlxuZGVmIGZ1bmN0aW9uR3JvdXAgPSBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjYpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpXG5cbmRlZiBvYmplY3RzR3JvdXBzID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBR3JvdXBzXFxcIiBBTkQgKG9iamVjdGlkID0gXCIgKyBmdW5jdGlvbkdyb3VwICsgXCIpXCIpXG5cbi8vU3RyaW5nIHF1ZXJ5Q2RjID0gXCJcXFwiXCIgKyBjZGNWICsgXCJcXFwiXCJcbi8vZGVmIG9iamVjdHNDREMgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgXCJvYmplY3RUeXBlPVxcXCJSREFDRENcXFwiIEFORCBcXFwiTmFtZVxcXCIgSU4gKFwiICsgcXVlcnlDZGMgKyBcIilcIik7IFxuXG4vL3JpY2VyY2EgYXBwcm92YXppb25lIHRlY25pY2FcbmRlZiBvYmplY3RzVGVjbiA9IFtdXG5mb3IobWF0R3JvdXAgaW4gbWF0R3JvdXBzKXtcbiAgICBpZiAob2JqZWN0c1RlY24uc2l6ZSgpPT0wKXtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5VGVjbiA9IFwiXFxcIlwiICsgbWF0R3JvdXAgKyBcIlxcXCJcIlxuICAgICAgICBvYmplY3RzVGVjbiA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQVRlY2huaWNhbEFwcHJvdmFsXFxcIiBBTkQgXFxcIk5hbWVcXFwiIElOIChcIiArIHF1ZXJ5VGVjbiArIFwiKSBBTkQgXFxcIkZ1bmN0aW9uIG5hbWVcXFwiID0gXCIgKyBxdWVyeVBhcmFtKTsgXG4gICAgICAgIFxuICAgIH1cbn1cblxuLy9yaWNlcmNhIHBlciBhcHByb3ZhemlvbmUgbGl2ZWxsbyAyIFxuZGVmIG9iamVjdHNJbnRlcnZhbHNMMlxuZGVmIG9iamVjdHNJbnRlcnZhbHNMMyBcbmRlZiBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMVxuZGVmIG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24yXG5kZWYgb2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjNcblxuaWYgKFJkYVR5cGVWLnRvU3RyaW5nKCk9PVwiT1BFWFwiKXtcbiAgICBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMSA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUludGVydmFsc1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIpIEFORCBcXFwiTGV2ZWxcXFwiID0gMSBBTkQgXFxcIlR5cGVcXFwiID0gXCIgKyBSZGFUeXBlViArIFwiIEFORCBcXFwiVmFsdWUgRnJvbVxcXCIgPD0gXCIgKyBUb3RQcmljZVYgIClcbiAgICBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMiA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUludGVydmFsc1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIpIEFORCBcXFwiTGV2ZWxcXFwiID0gMiBBTkQgXFxcIlR5cGVcXFwiID0gXCIgKyBSZGFUeXBlViArIFwiIEFORCBcXFwiVmFsdWUgRnJvbVxcXCIgPD0gXCIgKyBUb3RQcmljZVYgIClcblx0b2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjMgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgXCJvYmplY3RUeXBlPVxcXCJSREFJbnRlcnZhbHNcXFwiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9IFwiICsgY29tcGFueSArIFwiKSBBTkQgXFxcIkxldmVsXFxcIiA9IDMgQU5EIFxcXCJUeXBlXFxcIiA9IFwiICsgUmRhVHlwZVYgKyBcIiBBTkQgXFxcIlZhbHVlIEZyb21cXFwiIDw9IFwiICsgVG90UHJpY2VWICApXG5cdG9iamVjdHNJbnRlcnZhbHNMMiA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUludGVydmFsc1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIpIEFORCBcXFwiTGV2ZWxcXFwiID0gNCBBTkQgXFxcIlR5cGVcXFwiID0gXCIgKyBSZGFUeXBlViArIFwiIEFORCBcXFwiVmFsdWUgRnJvbVxcXCIgPD0gXCIgKyBUb3RQcmljZVYgIClcblx0b2JqZWN0c0ludGVydmFsc0wzID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBSW50ZXJ2YWxzXFxcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSBcIiArIGNvbXBhbnkgKyBcIikgQU5EIFxcXCJMZXZlbFxcXCIgPSA1IEFORCBcXFwiVHlwZVxcXCIgPSBcIiArIFJkYVR5cGVWICsgXCIgQU5EIFxcXCJWYWx1ZSBGcm9tXFxcIiA8PSBcIiArIFRvdFByaWNlViAgKVxufSAgIFxuZWxzZXtcbiAgICBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMSA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUludGVydmFsc1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIpIEFORCBcXFwiTGV2ZWxcXFwiID0gMSBBTkQgXFxcIlR5cGVcXFwiID0gXCIgKyBSZGFUeXBlViArIFwiIEFORCBcXFwiRXh0cmEgQnVkZ2V0XFxcIiA9IFwiICsgRXh0cmFCdWRnZXQgKyBcIiBBTkQgXFxcIlZhbHVlIEZyb21cXFwiIDw9IFwiICsgVG90UHJpY2VWICApXG4gICAgb2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjIgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgXCJvYmplY3RUeXBlPVxcXCJSREFJbnRlcnZhbHNcXFwiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9IFwiICsgY29tcGFueSArIFwiKSBBTkQgXFxcIkxldmVsXFxcIiA9IDIgQU5EIFxcXCJUeXBlXFxcIiA9IFwiICsgUmRhVHlwZVYgKyBcIiBBTkQgXFxcIkV4dHJhIEJ1ZGdldFxcXCIgPSBcIiArIEV4dHJhQnVkZ2V0ICsgXCIgQU5EIFxcXCJWYWx1ZSBGcm9tXFxcIiA8PSBcIiArIFRvdFByaWNlViAgKVxuXHRvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMyA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUludGVydmFsc1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIpIEFORCBcXFwiTGV2ZWxcXFwiID0gMyBBTkQgXFxcIlR5cGVcXFwiID0gXCIgKyBSZGFUeXBlViArIFwiIEFORCBcXFwiRXh0cmEgQnVkZ2V0XFxcIiA9IFwiICsgRXh0cmFCdWRnZXQgKyBcIiBBTkQgXFxcIlZhbHVlIEZyb21cXFwiIDw9IFwiICsgVG90UHJpY2VWICApXG4gICAgb2JqZWN0c0ludGVydmFsc0wyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBSW50ZXJ2YWxzXFxcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSBcIiArIGNvbXBhbnkgKyBcIikgQU5EIFxcXCJMZXZlbFxcXCIgPSA0IEFORCBcXFwiVHlwZVxcXCIgPSBcIiArIFJkYVR5cGVWICsgXCIgQU5EIFxcXCJFeHRyYSBCdWRnZXRcXFwiID0gXCIgKyBFeHRyYUJ1ZGdldCArIFwiIEFORCBcXFwiVmFsdWUgRnJvbVxcXCIgPD0gXCIgKyBUb3RQcmljZVYgIClcblx0b2JqZWN0c0ludGVydmFsc0wzID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBSW50ZXJ2YWxzXFxcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSBcIiArIGNvbXBhbnkgKyBcIikgQU5EIFxcXCJMZXZlbFxcXCIgPSA1IEFORCBcXFwiVHlwZVxcXCIgPSBcIiArIFJkYVR5cGVWICsgXCIgQU5EIFxcXCJFeHRyYSBCdWRnZXRcXFwiID0gXCIgKyBFeHRyYUJ1ZGdldCArIFwiIEFORCBcXFwiVmFsdWUgRnJvbVxcXCIgPD0gXCIgKyBUb3RQcmljZVYgIClcbn1cbmxvZy5kZWJ1ZyBvYmplY3RzSW50ZXJ2YWxzTDNcbmRlZiBGbG93VHlwZSA9IFwiXCJcblxuLy9kZWNpZG8gbCdhcHByb3ZlciBlIGlsIGZsb3cgdHlwZSwgY29tcG9uZ28gYXBwcm92ZXJcbkFwcGxpY2F0aW9uVXNlciBhcHByVXNlclxuZGVmIHZhbHVlPVwiXCJcbkN1c3RvbUZpZWxkIGZsb3dUeXBlRmllbGRcbmRlZiBhcHByb3ZlclJEQSA9IFtdXG5kZWYgZGlzcGxheU5hbWUgPSBbXVxuZGVmIGhpZGUxID0gW11cblxuXG5kZWYgY3JlYUF1dG9TdWJUYXNrID0gZmFsc2VcbmRlZiBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gZmFsc2VcblxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJQdXJjaGFzZSBieSBjcmVkaXQgY2FyZFwiKXtcbi8vY3JlbyBzdWIgdGFzayBwZXIgQ29udHJvbGxpbmdcbiAgICBsb2cuZGVidWcgXCJmbG93VHlwZTogXCIgKyBmbG93VHlwZVxuICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICBoaWRlMT1bXVxuICAgIEZsb3dUeXBlPSdDb250cm9sbGluZyBmdW5jdGlvbidcbiAgICAvL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1NjdcbiAgICBpZiAob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSE9bnVsbCl7XG4gICAgICAgIGZvciAob2JqQ29udHIgaW4gb2JqZWN0c0NvbnRyb2xsaW5nKXtcbiAgICAgICAgICAgIC8vQXBwcm92ZXIgaW5zaWdodCBSREFDb250cm9sbGluZyB0ZXN0IDQ0MTUgLSBwcm9kIDI1NzhcbiAgICAgICAgICAgIGpxbFNlYXJjaCA9IFwicHJvamVjdCA9ICdcIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgXCInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCAnQXBwcm92ZXIgUkRBJyA9ICdcIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iakNvbnRyLmdldElkKCksIDI1NzgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgXCInIEFORCBwYXJlbnQgPSAnXCIgKyBwYXJlbnRJc3N1ZS5rZXkgKyBcIidcIlxuICAgICAgICAgICAgbG9nLmRlYnVnIGpxbFNlYXJjaFxuICAgICAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSlcbiAgICAgICAgICAgIGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7XG4gICAgICAgICAgICAgICAgY3JlYUF1dG9TdWJUYXNrID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGhpZGUxLmFkZChcIk5vXCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIGhpZGUxLmFkZChcIlNpXCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL0FwcHJvdmVyIGluc2lnaHQgUkRBQ29udHJvbGxpbmcgdGVzdCA0NDE1IC0gcHJvZCAyNTc4XG4gICAgICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iakNvbnRyLmdldElkKCksIDI1NzgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuXG4gICAgICAgIH1cblx0XHQvL1dhaXRpbmcgRm9yIENvbnRyb2xsZXJzIHRlc3QgMjEgLSBwcm9kIDE1MVxuICAgICAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxNTEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG5cbiAgICAgICAgLyp3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxNTEpO1xuICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgIH0qL1xuXG4gICAgICAgIGlmIChjcmVhQXV0b1N1YlRhc2s9PXRydWUpe1xuICAgICAgICAgICAgZGVmIGogPSAwXG4gICAgICAgICAgICAgZm9yIChhcHByIGluIGFwcHJvdmVyUkRBKXtcbiAgICAgICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwciwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgaGlkZTFbal0sIGlzc3VlKVxuICAgICAgICAgICAgICAgIGo9aisxXG4gICAgICAgICAgICAgfSAgIFxuICAgICAgICAgICAgZmxvd1R5cGUgPSBcIkNvbnRyb2xsaW5nIGZ1bmN0aW9uXCJcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICAgICAgfVxuICAgICB9XG4gICAgIGVsc2V7XG4gICAgICAgICBmbG93VHlwZSA9IFwiQ29udHJvbGxpbmcgZnVuY3Rpb25cIlxuICAgIH0gICAgICAgXG59XG4gXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIkNvbnRyb2xsaW5nIGZ1bmN0aW9uXCIpe1xuICAgIGxvZy5kZWJ1ZyBcImZsb3dUeXBlOiBcIiArIGZsb3dUeXBlXG4gICAgYXBwcm92ZXJSREEgPSBbXVxuICAgIFxuICAgIC8vc2UgaG8gdW5hIGFwcHJvdmF6aW9uZSB0ZWNuaWNhIGluIGJhc2UgYWwgY2RjIGFsbG9yYSBmYWNjaW8gbCdhcHByb3ZhemlvbmUgdGVjbmljYSBhbHRyaW1lbnQgaXZhZG8gY29uIGlsIHByaW1vIGxpdmVsbG9cbiAgICBpZiAob2JqZWN0c1RlY24uc2l6ZSgpPjApe1xuICAgICAgICBGbG93VHlwZT0nVGVjaG5pY2FsIEFwcHJvdmFsJ1xuICAgICAgICAvL0FwcHJvdmVyIHNjaGVtYSBSREFUZWNobmljYWxBcHByb3ZhbCB0ZXN0IDQ0MTYgLSBwcm9kIDI1NzNcbiAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzVGVjblswXS5nZXRJZCgpLCAyNTczKS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSlcbiAgICAgICAganFsU2VhcmNoID0gXCJwcm9qZWN0ID0gJ1wiICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyBcIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJ1wiICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c1RlY25bMF0uZ2V0SWQoKSwgMjU3MykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyBcIicgQU5EIHBhcmVudCA9ICdcIiArIHBhcmVudElzc3VlLmtleSArIFwiJ1wiXG4gICAgICAgIFxuICAgICAgICBxdWVyeSA9IGpxbFF1ZXJ5UGFyc2VyLnBhcnNlUXVlcnkoanFsU2VhcmNoKVxuICAgICAgICBzZWFyY2ggPSBzZWFyY2hTZXJ2aWNlLnNlYXJjaCh1c2VyLCBxdWVyeSwgUGFnZXJGaWx0ZXIuZ2V0VW5saW1pdGVkRmlsdGVyKCkpXG4gICAgICAgIFxuXHRcdGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7XG4gICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsIFwiTm9cIiwgaXNzdWUpXG4gICAgICAgICAgICBmbG93VHlwZSA9IFwiVGVjaG5pY2FsIEFwcHJvdmFsXCJcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICAgICAgfVxuICAgICAgICAvL1dhaXRpbmcgZm9yIHRlY2huaWNhbCBhcHByb3ZhbCB0ZXN0IDE5MSAtIHByb2QgNzFcbiAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksNzEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgIC8qd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oNzEpOyBcbiAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICB9Ki9cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMS5zaXplKCk+MCl7XG4gICAgICAgICAgICAvL2NyZW8gc3ViIHRhc2sgcGVyIENvbnRyb2xsaW5nXG4gICAgICAgICAgICBGbG93VHlwZT0nRmlyc3QgTGV2ZWwgQXBwcm92YWwnXG4gICAgICAgICAgICAvL0FwcHJvdmVyIHNjaGVtYSBSREFGdW5jdGlvbiB0ZXN0IDQ0MTcgLSBwcm9kIDI1NjhcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuXG4gICAgICAgICAgICBqcWxTZWFyY2ggPSBcInByb2plY3QgPSAnXCIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArIFwiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJ1wiICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgXCInIEFORCBwYXJlbnQgPSAnXCIgKyBwYXJlbnRJc3N1ZS5rZXkgKyBcIidcIlxuICAgICAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSlcblxuICAgICAgICAgICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT4wKXsgICBcbiAgICAgICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsIFwiTm9cIiwgaXNzdWUpXG4gICAgICAgICAgICAgICAgZmxvd1R5cGUgPSBcIkZpcnN0IExldmVsIEFwcHJvdmFsXCJcbiAgICAgICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL1dpYXRpbmcgRm9yIEZpcnN0IExldmVsICB0ZXN0IDQxIC0gcHJvZCA2MVxuICAgICAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksNjEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKndvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDYxKTsgXG4gICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICAgICAgfSovXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGZsb3dUeXBlID0gXCJGaXJzdCBMZXZlbCBBcHByb3ZhbFwiXG4gICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgIH0gIFxuICAgIH1cbn1cblxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJUZWNobmljYWwgQXBwcm92YWxcIil7XG4gICAgaWYgKG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24xLnNpemUoKT4wKXtcbiAgICAgICAgbG9nLmRlYnVnIFwiZmxvd1R5cGU6IFwiICsgZmxvd1R5cGVcbiAgICAgICAgYXBwcm92ZXJSREEgPSBbXVxuXG4gICAgICAgIC8vc2UgaG8gdW5hIGFwcHJvdmF6aW9uZSB0ZWNuaWNhIHZhZG8gY29uIGlsIHByaW1vIGxpdmVsbG9cbiAgICAgICAgRmxvd1R5cGU9J0ZpcnN0IExldmVsIEFwcHJvdmFsJyBcbiAgICAgICAgLy9BcHByb3ZlciBzY2hlbWEgUkRBRnVuY3Rpb24gdGVzdCA0NDE3IC0gcHJvZCAyNTY4XG4gICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuICAgICAgICBqcWxTZWFyY2ggPSBcInByb2plY3QgPSAnXCIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArIFwiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnXCIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2OCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyBcIicgQU5EIHBhcmVudCA9ICdcIiArIHBhcmVudElzc3VlLmtleSArIFwiJ1wiXG5cbiAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApe1xuICAgICAgICAgICAgY3JlYXRlU3ViVGFza0FwcHJvdmVkKGFwcHJvdmVyUkRBWzBdLCBjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEZsb3dUeXBlLCBcIk5vXCIsIGlzc3VlKVxuICAgICAgICAgICAgZmxvd1R5cGUgPSBcIkZpcnN0IExldmVsIEFwcHJvdmFsXCJcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICAgICAgfVxuICAgICAgICAvL1RyYW5zYXppb25lIFdhaXRpbmcgRm9yIFNlY29uZCBMZXZlbCAgdGVzdCA0MSAtIHByb2QgNjFcbiAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksNjEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDYxKTsgXG4gICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcbiAgICAgICAgfSovXG4gICAgIH1cbiAgICBlbHNle1xuICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgIGZsb3dUeXBlID0gXCJGaXJzdCBMZXZlbCBBcHByb3ZhbFwiXG4gICAgfVxufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJGaXJzdCBMZXZlbCBBcHByb3ZhbFwiKXtcbiAgICBsb2cuZGVidWcgXCJmbG93VHlwZTogXCIgKyBmbG93VHlwZVxuICAgIGFwcHJvdmVyUkRBID0gW11cblx0XG4gICAgLy9zZSBobyB1bmEgYXBwcm92YXppb25lIGZ1bnppb25lIHNlY29uZG8gbGl2ZWxsbyBcbiAgICAvL0FwcHJvdmVyIFNlY29uZCBMZXZlbCBzY2hlbWEgUkRBRnVuY3Rpb24gdGVzdCA0NDQyIC0gcHJvZCAzNDA5XG4gICAgaWYgKG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24yLnNpemUoKT4wICYmIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQwOSkgIT0gbnVsbCl7XG4gICAgICAgIEZsb3dUeXBlPSdTZWNvbmQgTGV2ZWwgQXBwcm92YWwnXG4gICAgICAgIC8vQXBwcm92ZXIgU2Vjb25kIExldmVsIHNjaGVtYSBSREFGdW5jdGlvbiB0ZXN0IDQ0NDIgLSBwcm9kIDM0MDlcbiAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQwOSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpXG4gICAgICAgIGpxbFNlYXJjaCA9IFwicHJvamVjdCA9ICdcIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgXCInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCBIaWRlIGlzIEVNUFRZIEFORCAnQXBwcm92ZXIgUkRBJyA9ICdcIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAzNDA5KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArIFwiJyBBTkQgcGFyZW50ID0gJ1wiICsgcGFyZW50SXNzdWUua2V5ICsgXCInXCJcbiAgICAgICAgXG4gICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpXG4gICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSlcbiAgICAgICAgXG5cdFx0aWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT4wKXtcbiAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByb3ZlclJEQVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgXCJOb1wiLCBpc3N1ZSlcbiAgICAgICAgICAgIGZsb3dUeXBlID0gXCJTZWNvbmQgTGV2ZWwgQXBwcm92YWxcIlxuICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXVxuICAgICAgICB9XG4gICAgICAgIC8vVHJhbnNhemlvbmUgV2FpdGluZyBGb3IgU2Vjb25kIExldmVsICB0ZXN0IDIwMSAtIHByb2QgODFcbiAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksODEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgIC8qIFxuICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbig4MSk7IFxuICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgIH0qL1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgICBmbG93VHlwZSA9IFwiU2Vjb25kIExldmVsIEFwcHJvdmFsXCJcbiAgICAgICAgYXBwcm92ZXJSREEgPSBbXVxuICAgIH0gIFxufVxuICAgIFxuaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gXCJTZWNvbmQgTGV2ZWwgQXBwcm92YWxcIil7XG4gICAgbG9nLmRlYnVnIFwiZmxvd1R5cGU6IFwiICsgZmxvd1R5cGVcbiAgICBhcHByb3ZlclJEQSA9IFtdXG4gICBcbiAgICAvL3NlIGhvIHVuIHRlcnpvIGxpdmVsbG8gdmFkbyBhbCB0ZXJ6byBsaXZlbGxvIGFsdHJpbWVudGkgdmFkbyBhIGxpdmVsbG8gZGkgZ3J1cHBvXG4gICAgLy9BcHByb3ZlciBUaGlyZCBMZXZlbCBzY2hlbWEgUkRBRnVuY3Rpb24gdGVzdCA0NDQzIC0gcHJvZCAzNDEwXG4gICAgaWYgKG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24zLnNpemUoKT4wICYmIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQxMCkgIT0gbnVsbCl7XG4gICAgICAgIEZsb3dUeXBlPSdUaGlyZCBMZXZlbCBBcHByb3ZhbCcgXG4gICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDM0MTApLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuICAgICAgICBqcWxTZWFyY2ggPSBcInByb2plY3QgPSAnXCIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArIFwiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnXCIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQxMCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyBcIicgQU5EIHBhcmVudCA9ICdcIiArIHBhcmVudElzc3VlLmtleSArIFwiJ1wiXG5cbiAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuICAgICAgICBsb2cuZGVidWcgXCJqcWxTZWFyY2ggXCIgKyBqcWxTZWFyY2hcbiAgICAgICAgbG9nLmRlYnVnIFwic2VhcmNoLnJlc3VsdHMgXCIgKyBzZWFyY2gucmVzdWx0c1xuICAgICAgICBcbiAgICAgICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT4wKXtcbiAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByb3ZlclJEQVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgXCJOb1wiLCBpc3N1ZSlcbiAgICAgICAgICAgIGZsb3dUeXBlID0gXCJUaGlyZCBMZXZlbCBBcHByb3ZhbFwiXG4gICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgIH1cbiAgICAgICAgLy9UcmFuc2F6aW9uZSBXYWl0aW5nIEZvciBUaGlyZCBMZXZlbCB0ZXN0IDIxMSAtIHByb2QgOTEgXG4gICAgICAgIElzc3VlU2VydmljZS5UcmFuc2l0aW9uVmFsaWRhdGlvblJlc3VsdCByZXN1bHQgPSBpc3N1ZVNlcnZpY2UudmFsaWRhdGVUcmFuc2l0aW9uKGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZS5nZXRJZCgpLDkxLCBpc3N1ZVNlcnZpY2UubmV3SXNzdWVJbnB1dFBhcmFtZXRlcnMoKSwgdHJhbnNpdGlvbk9wdGlvbnMpXG4gICAgICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgaXNzdWVTZXJ2aWNlLnRyYW5zaXRpb24oY3VycmVudFVzZXIsIHJlc3VsdClcbiAgICAgICAgfVxuICAgICAgICAvKlxuICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbig5MSk7IFxuICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgIH0qL1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgICBmbG93VHlwZSA9IFwiVGhpcmQgTGV2ZWwgQXBwcm92YWxcIlxuICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgfSAgXG59XG5cbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiVGhpcmQgTGV2ZWwgQXBwcm92YWxcIil7XG4gICAgYXBwcm92ZXJSREEgPSBbXVxuXHRGbG93VHlwZT0nR3JvdXAgTGV2ZWwgQXBwcm92YWwnXG4gICAgLy9Hcm91cEFwcHJvdmVyXG4gICAgaWYgKG9iamVjdHNJbnRlcnZhbHNMMi5zaXplKCk+MCl7XG4gICAgICAgIC8vQXBwcm92ZXIgVGhpcmQgTGV2ZWwgc2NoZW1hIFJEQUdyb3VwICB0ZXN0IDQ0MTggLSBwcm9kIDI1NjVcbiAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzR3JvdXBzWzBdLmdldElkKCksIDI1NjUpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuXG4gICAgICAgIC8vIHNlIGFzc2lnbmVlIGRlbCBzZWNvbmRvIGxpdmVsbG8gXHUwMGU4IGRpdmVyc28gZGEgYXNzaWduZWUgZGVpIHByb21vIGxpdmVsbG8gYWxsb3JhIG1ldHRvIGxvIHN0YXR1cyBkZWwgcGFkcmUgY29tZSB3YWl0aW5nIGZvciBhcHByb3ZhbCAyIGxldmVsICBhbHRyaW1lbnRpIGltcG9zdG8gRmxvdyA9IHNlY29kbiBsaXZlbCBlIHByb2NlZG8gYWwgaWYgc3VjY2Vzc2l2b1xuICAgICAgICAvL2lmIChDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyVXRpbCgpLmdldFVzZXJCeU5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNHcm91cHNbMF0uZ2V0SWQoKSwgMzE3MCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpIT1pc3N1ZS5nZXRBc3NpZ25lZSgpKXtcbiAgICAgICAganFsU2VhcmNoID0gXCJwcm9qZWN0ID0gJ1wiICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyBcIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJ1wiICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0dyb3Vwc1swXS5nZXRJZCgpLCAyNTY1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArIFwiJyBBTkQgcGFyZW50ID0gJ1wiICsgcGFyZW50SXNzdWUua2V5ICsgXCInXCJcbiAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApe1xuICAgICAgICAgICAgY3JlYXRlU3ViVGFza0FwcHJvdmVkKGFwcHJvdmVyUkRBWzBdLCBjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEZsb3dUeXBlLCBcIk5vXCIsIGlzc3VlKVxuICAgICAgICAgICAgZmxvd1R5cGUgPSBcIkdyb3VwIExldmVsIEFwcHJvdmFsXCJcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy9XYWl0aW5nIEZvciBHcm91cCBMZXZlbCB0ZXN0IDYxIC0gIHByb2QgMTAxXG4gICAgICAgIElzc3VlU2VydmljZS5UcmFuc2l0aW9uVmFsaWRhdGlvblJlc3VsdCByZXN1bHQgPSBpc3N1ZVNlcnZpY2UudmFsaWRhdGVUcmFuc2l0aW9uKGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZS5nZXRJZCgpLDEwMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgICAgICBpZiAocmVzdWx0LmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgICAgIH1cbiAgICAgICAgLypcbiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTAxKTtcbiAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICB9Ki9cbiAgICB9XG4gICAgZWxzZSBpZiAob2JqZWN0c0ludGVydmFsc0wzLnNpemUoKT4wKSB7XG4gICAgICAgICAgICBmbG93VHlwZSA9IFwiR3JvdXAgTGV2ZWwgQXBwcm92YWxcIlxuICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXVxuICAgIH0gIFxuICAgIGVsc2V7XG4gICAgICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2N1xuICAgICAgICBpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UgfHwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSA9PSBudWxsKXtcbiAgICAgICAgICAgIC8vY2hpdWRvIGlzc3VlIGFwcHJvdmVkXG4gICAgICAgICAgICBsb2cuZGVidWcgXCJGaXJzdCBsZXZlbCAtIGFwcHJvdm8gaWwgcGFkcmUgcGVyY2hcdTAwZTggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBkaSBhcHByb3ZhemlvbmVcIlxuICAgICAgICAgICAgLy9BcHByb3ZlZCBSREEgdGVzdCAxMDEgLSBwcm9kIDExXG4gICAgICAgICAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgICAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNzdWVTZXJ2aWNlLnRyYW5zaXRpb24oY3VycmVudFVzZXIsIHJlc3VsdClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMSk7XG4gICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICAgICAgfSovXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIC8vc2Ugc29ubyBmYXR0dXJhIGFsbG9yYSBjb21lIHVsdGltbyBzdGVwIGMnXHUwMGU4IGlsIGNvbnRyb2xsaW5nXG4gICAgICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZVxuICAgICAgICB9ICBcbiAgICB9XG59XG5cblxubG9nLmRlYnVnIGZsb3dUeXBlXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIkdyb3VwIExldmVsIEFwcHJvdmFsXCIpe1xuICAgIGxvZy5kZWJ1ZyBcImZsb3dUeXBlOiBcIiArIGZsb3dUeXBlXG4gICAgYXBwcm92ZXJSREEgPSBbXVxuICAgIGhpZGUxID0gW11cbiAgICBcblx0aWYgKG9iamVjdHNJbnRlcnZhbHNMMy5zaXplKCk+MCl7XG4gICAgICAgIC8vZGVmIG9iamVjdHNDRU8gPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgXCJvYmplY3RUeXBlPVxcXCJSREFDRU9cXFwiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9IFwiICsgY29tcGFueSArIFwiKVwiKVxuICAgICAgICBkZWYgb2JqZWN0c0NFTyA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCBcIm9iamVjdFR5cGU9XFxcIlJEQUNFT1xcXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gXCIgKyBjb21wYW55ICsgXCIgKSBBTkQgXFxcIkZ1bmN0aW9uXFxcIiA9IFwiICsgcXVlcnlQYXJhbSlcbiAgICAgICAgZGVmIG9iamVjdHNDRk8gPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgXCJvYmplY3RUeXBlPVxcXCJSREFDRk9cXFwiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9IFwiICsgY29tcGFueSArIFwiKVwiKVxuICAgICAgICBcbiAgICAgICAgLy9DRU8rQ0ZPIHNjaGVtYSBSREFJbnRlcnZhbHMgdGVzdCAzMTY5IC0gIHByb2QgMzQwN1xuICAgICAgICBpZiAob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNJbnRlcnZhbHNMM1swXS5nZXRJZCgpLCAzNDA3KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpID09XCJ0cnVlXCIpe1xuICAgICAgICAvLyBzZSBpbCBmbGFnIENGTyBcdTAwZTggdHJ1ZSBhbGxvcmEgY3JlbyAyIHN1YiBzdWIgdGFzayB1bm8gcGVyIENGTyBlIHVubyBwZXIgQ0VPIHBlcmNoXHUwMGU4IGhhbm5vIGZpcm1hIGNvbmdpdW50YSwgYWx0cmltZW50aSBjcmVvIHNvbG8gcXVlbGxvIHBlciBDRU9cbiAgICAgICAgICAgIEZsb3dUeXBlID0gJ0NFTytDRk8nXG4gICAgICAgICAgICAvL0FwcHJvdmVyICBzY2hlbWEgUkRBQ0ZPIHRlc3QgNDQxMiAtICBwcm9kIDI1ODNcbiAgICAgICAgICAgIGpxbFNlYXJjaCA9IFwicHJvamVjdCA9ICdcIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgXCInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCBIaWRlIGlzIEVNUFRZIEFORCAnQXBwcm92ZXIgUkRBJyA9ICdcIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNDRk9bMF0uZ2V0SWQoKSwgMjU4MykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyBcIicgQU5EIHBhcmVudCA9ICdcIiArIHBhcmVudElzc3VlLmtleSArIFwiJ1wiXG4gICAgICAgICAgICBxdWVyeSA9IGpxbFF1ZXJ5UGFyc2VyLnBhcnNlUXVlcnkoanFsU2VhcmNoKVxuICAgICAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPT0wKXtcbiAgICAgICAgICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNDRk9bMF0uZ2V0SWQoKSwgMjU4MykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNDRk9bMF0uZ2V0SWQoKSwgMjU4MykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCksIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsIFwiTm9cIiwgaXNzdWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vQXBwcm92ZXIgc2NoZW1hIFJEQUNFTyB0ZXN0IDQ0MTQgLSAgcHJvZCAyNTg1XG4gICAgICAgICAgICBqcWxTZWFyY2ggPSBcInByb2plY3QgPSAnXCIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArIFwiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnXCIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQ0VPWzBdLmdldElkKCksIDI1ODUpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgXCInIEFORCBwYXJlbnQgPSAnXCIgKyBwYXJlbnRJc3N1ZS5rZXkgKyBcIidcIlxuICAgICAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSlcbiAgICAgICAgICAgIGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk9PTApe1xuICAgICAgICAgICAgICAgXHRhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNDRU9bMF0uZ2V0SWQoKSwgMjU4NSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgXCJOb1wiLCBpc3N1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChhcHByb3ZlclJEQS5zaXplKCk+MCl7XG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnIFwiQ0VPK0NGTyAtIGltcG9zdG8gaWwgcGFkcmUgaW4gd2FpdGluZyBDRU8rQ0ZPXCJcbiAgICAgICAgICAgICAgICAvL1dhaXRpbmcgRm9yIEdlbmVyYWwgTWFuYWdlciAmIENGTyB0ZXN0IDE1MSAtICBwcm9kIDEyMVxuICAgICAgICAgICAgICAgIElzc3VlU2VydmljZS5UcmFuc2l0aW9uVmFsaWRhdGlvblJlc3VsdCByZXN1bHQgPSBpc3N1ZVNlcnZpY2UudmFsaWRhdGVUcmFuc2l0aW9uKGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZS5nZXRJZCgpLDEyMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgXHR3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMjEpO1xuICAgICAgICAgICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICBcdH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXVxuICAgICAgICAgICAgICAgIC8vY3JlYXRlU3ViVGFza0FwcHJvdmVkKGFwcHJvdmVyUkRBWzBdLCBkaXNwbGF5TmFtZVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSlcbiAgICAgICAgICAgICAgICAvL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1NjdcbiAgICAgICAgICAgICAgICBpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UgfHwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgbG9nLmRlYnVnIFwiQ0VPK0NGTyAtIGNyZW8gc3VidGFzayBhdXRvYXBwcm92YXRpIGUgYXBwcm92byBpbCBwYWRyZSBwZXJjaFx1MDBlOCBub24gY2kgc29ubyBhbHRyaSBzdGVwIGRpIGFwcHJvdmF6aW9uZVwiXG4gICAgICAgICAgICAgICAgICAgIC8vQXBwcm92ZXJkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTFcbiAgICAgICAgICAgICAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksMTEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgY3JlYUNvbnRyb2xsaW5nRmF0dHVyYSA9IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgIFx0fVxuXHRcdH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBGbG93VHlwZT0nR2VuZXJhbCBNYW5hZ2VyJ1xuICAgICAgICAgICAgLy9BcHByb3ZlciBzY2hlbWEgUkRBQ0VPIHRlc3QgNDQxNCAtICBwcm9kIDI1ODVcbiAgICAgICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAganFsU2VhcmNoID0gXCJwcm9qZWN0ID0gJ1wiICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyBcIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJ1wiICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArIFwiJyBBTkQgcGFyZW50ID0gJ1wiICsgcGFyZW50SXNzdWUua2V5ICsgXCInXCJcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyBqcWxTZWFyY2hcbiAgICAgICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpXG4gICAgICAgICAgICBzZWFyY2ggPSBzZWFyY2hTZXJ2aWNlLnNlYXJjaCh1c2VyLCBxdWVyeSwgUGFnZXJGaWx0ZXIuZ2V0VW5saW1pdGVkRmlsdGVyKCkpXG4gICAgICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApe1xuICAgICAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByb3ZlclJEQVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgXCJOb1wiLCBpc3N1ZSlcbiAgICAgICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnIFwiR2VuZXJhbCBNYW5hZ2VyIC0gY3JlbyBzdWJ0YXNrIGF1dG9hcHByb3ZhdG8gZSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNoXHUwMGU4IG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lXCJcbiAgICAgICAgXHRcdGlmIChEaWZmSW52b2ljZSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgICAgIC8vQXBwcm92ZWQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMVxuICAgICAgICAgICAgICAgICAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgXHR9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIC8vV2FpdGluZyBGb3IgR2VuZXJhbCBNYW5hZ2VyIHRlc3QgMTQxIC0gcHJvZCAxMTFcbiAgICAgICAgICAgICAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxMTEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVTZXJ2aWNlLnRyYW5zaXRpb24oY3VycmVudFVzZXIsIHJlc3VsdClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMTEpO1xuICAgICAgICAgICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICBcdH1cbiAgICBcdH1cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgbG9nLmRlYnVnIFwiR3JvdXAgbGV2ZWwgLSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNoXHUwMGU4IG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lXCJcbiAgICAgICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2N1xuICAgICAgICBpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UgfHwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSA9PSBudWxsKXtcbiAgICAgICAgICAgIC8vQXBwcm92ZWQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMVxuICAgICAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksMTEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpO1xuICAgICAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcbiAgICAgICAgICAgIH0qL1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vL2Rldm8gdmVyaWZpY2FyZSBjaGUgZW50cmFtYmkgQ0VPIGUgQ0ZPIGFiYmlhbW8gYXBwcm92YXRvIHByaW1hIGRpIGFwcHJvdmFyZSBsYSBpc3N1ZSwgZGV2byBjaGl1ZGUgYXBwcm92YXppb25lIHF1YW5kbyBlbnRyYW1iaSBzb25vIGFwcHJvdmF0aSBcbmlmIChmbG93VHlwZS50b1N0cmluZygpID09IFwiQ0VPK0NGT1wiKXtcbiAgICBsb2cuZGVidWcgXCJmbG93VHlwZTogXCIgKyBmbG93VHlwZVxuICAgIGpxbFNlYXJjaCA9IFwicHJvamVjdCA9ICdcIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgXCInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgJ0Zsb3cgVHlwZSc9J0NFTytDRk8nIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EIHJlc29sdXRpb24gPSBVbnJlc29sdmVkIEFORCBwYXJlbnQgPSAnXCIgKyBwYXJlbnRJc3N1ZS5rZXkgKyBcIicgQU5EIGtleSAhPSAnXCIgKyBpc3N1ZS5rZXkgKyBcIidcIlxuICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpXG4gICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuXG4gICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT09MCl7XG4gICAgICAgIGxvZy5kZWJ1ZyBcIkNFTytDRk8gLSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNoXHUwMGU4IG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lXCJcbiAgICAgICAgLy9Hcm91cCBDb250cm9sbGlnIGluc2lnaHQgUkRBRnVuY3Rpb24gdGVzdCAzMTc1IC0gcHJvZCAyNTY3XG5cdFx0aWYgKERpZmZJbnZvaWNlID09IGZhbHNlIHx8IG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykgPT0gbnVsbCl7XG4gICAgICAgICAgICAvL0FwcHJvdmVkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTFcbiAgICAgICAgICAgIElzc3VlU2VydmljZS5UcmFuc2l0aW9uVmFsaWRhdGlvblJlc3VsdCByZXN1bHQgPSBpc3N1ZVNlcnZpY2UudmFsaWRhdGVUcmFuc2l0aW9uKGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZS5nZXRJZCgpLDExLCBpc3N1ZVNlcnZpY2UubmV3SXNzdWVJbnB1dFBhcmFtZXRlcnMoKSwgdHJhbnNpdGlvbk9wdGlvbnMpXG4gICAgICAgICAgICBpZiAocmVzdWx0LmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTtcbiAgICAgICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgICAgICB9Ki9cbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgY3JlYUNvbnRyb2xsaW5nRmF0dHVyYSA9IHRydWVcbiAgICAgICAgfVxuICAgIH0gIFxufVxuXG5pZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSBcIkdlbmVyYWwgTWFuYWdlclwiKXtcbiAgICBsb2cuZGVidWcgXCJmbG93VHlwZTogXCIgKyBmbG93VHlwZVxuICAgIGxvZy5kZWJ1ZyBcIkdlbmVyYWwgbWFuYWdlciAtIGFwcHJvdm8gaWwgcGFkcmUgcGVyY2hcdTAwZTggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBkaSBhcHByb3ZhemlvbmVcIlxuICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2N1xuICAgIGlmIChEaWZmSW52b2ljZSA9PSBmYWxzZSB8fCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjcpID09IG51bGwpe1xuICAgICAgICAvL0FwcHJvdmVkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTFcbiAgICAgICAgSXNzdWVTZXJ2aWNlLlRyYW5zaXRpb25WYWxpZGF0aW9uUmVzdWx0IHJlc3VsdCA9IGlzc3VlU2VydmljZS52YWxpZGF0ZVRyYW5zaXRpb24oY3VycmVudFVzZXIsIHBhcmVudElzc3VlLmdldElkKCksMTEsIGlzc3VlU2VydmljZS5uZXdJc3N1ZUlucHV0UGFyYW1ldGVycygpLCB0cmFuc2l0aW9uT3B0aW9ucylcbiAgICAgICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTtcbiAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuICAgICAgICB9Ki9cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgY3JlYUNvbnRyb2xsaW5nRmF0dHVyYSA9IHRydWVcbiAgICB9XG59XG5cbmxvZy5kZWJ1ZyBcImFwcHJvdmVyUkRBIFwiKyBhcHByb3ZlclJEQVxubG9nLmRlYnVnIFwiZGlzcGxheU5hbWUgXCIgKyBkaXNwbGF5TmFtZVxuZGVmIGkgPSAwXG5cbi8vY3JlbyB1bHRpbW8gc3RlcCBkZWwgY29udHJvbGxpbmcgcGVyIGxlIGZhdHR1cmVcbmlmIChjcmVhQ29udHJvbGxpbmdGYXR0dXJhID09IHRydWUpe1xuXHRsb2cuZGVidWcgXCJmbG93VHlwZTogXCIgKyBmbG93VHlwZVxuICAgIGFwcHJvdmVyUkRBID0gW11cbiAgICBoaWRlMT1bXVxuICAgIEZsb3dUeXBlPSdDb250cm9sbGluZyBmdW5jdGlvbidcbiAgICBcbiAgICBmb3IgKG9iakNvbnRyIGluIG9iamVjdHNDb250cm9sbGluZyl7XG4gICAgICAgIC8vQXBwcm92ZXIgaW5zaWdodCBSREFDb250cm9sbGluZyB0ZXN0IDQ0MTUgLSBwcm9kIDI1NzhcbiAgICAgICAganFsU2VhcmNoID0gXCJwcm9qZWN0ID0gJ1wiICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyBcIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EICdBcHByb3ZlciBSREEnID0gJ1wiICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqQ29udHIuZ2V0SWQoKSwgMjU3OCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyBcIicgQU5EIHBhcmVudCA9ICdcIiArIHBhcmVudElzc3VlLmtleSArIFwiJ1wiXG4gICAgICAgIGxvZy5kZWJ1ZyBqcWxTZWFyY2hcbiAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaClcbiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKVxuXHRcdGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7XG4gICAgICAgIFx0Y3JlYUF1dG9TdWJUYXNrID0gdHJ1ZVxuICAgICAgICBcdGhpZGUxLmFkZChcIk5vXCIpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGhpZGUxLmFkZChcIlNpXCIpXG4gICAgICAgIH1cbiAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmpDb250ci5nZXRJZCgpLCAyNTc4KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSlcbiAgICB9XG4gICAgLy9UbyBXYWl0aW5nIEZvciBDb250cm9sbGVycyB0ZXN0IDE3MSAtIHByb2QgNTFcbiAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSw1MSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgIGlmIChyZXN1bHQuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxuICAgIH1cbiAgICAvKlxuICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDUxKTtcbiAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcbiAgICB9Ki9cblxuICAgIGlmIChjcmVhQXV0b1N1YlRhc2s9PXRydWUpe1xuICAgICAgICBkZWYgaiA9IDBcbiAgICAgICAgIGZvciAoYXBwciBpbiBhcHByb3ZlclJEQSl7XG4gICAgICAgICBcdGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByLCBjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEZsb3dUeXBlLCBoaWRlMVtqXSwgaXNzdWUpXG4gICAgICAgICAgICBqPWorMVxuICAgICAgICAgfSAgIFxuICAgICAgICBmbG93VHlwZSA9IFwiQ29udHJvbGxpbmcgZnVuY3Rpb25cIlxuICAgICAgICBhcHByb3ZlclJEQSA9IFtdXG4gICAgICAgIC8vc2UgaG8gYXV0b3Rhc2sgYWxsb3JhIGRldm8gY2hpdWRlcmUgbGEgaXNzdWUgcGFkcmUgcGVyY2hcdTAwZTggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBhcHByb3ZhdGl2aVxuICAgICAgICAvL0FwcHJvdmVyIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTFcbiAgICAgICAgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwxMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuICAgICAgICBpZiAocmVzdWx0LmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgICAgIH1cbiAgICAgICAgLypcbiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpO1xuICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7XG4gICAgICAgIH0qL1xuICAgIH1cbn1cblxuLy9jcmVvIHN1YnRhc2sgcGVyIGFwcHJvdmVyIGNvbXBvc3RpIGluIHByZWNlZGVuemFcbmZvciAob2JqIGluIGFwcHJvdmVyUkRBKXtcdFxuICAgIE11dGFibGVJc3N1ZSBuZXdTdWJUYXNrID0gaXNzdWVGYWN0b3J5LmdldElzc3VlKClcbiAgICAvL25ld1N1YlRhc2suc2V0QXNzaWduZWUoYXBwclVzZXIpXG4gICAgbmV3U3ViVGFzay5zZXRSZXBvcnRlcihjdXJyZW50VXNlcilcbiAgICAvL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAyMjcxOVxuICAgIGZsb3dUeXBlRmllbGQgPSBjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoXCIyMjcxOVwiKSlcbiAgIFx0XG4gICAgZGVmIGNmQ29uZmlnID0gZmxvd1R5cGVGaWVsZC5nZXRSZWxldmFudENvbmZpZyhwYXJlbnRJc3N1ZSlcbiAgICB2YWx1ZSA9IENvbXBvbmVudEFjY2Vzc29yLm9wdGlvbnNNYW5hZ2VyLmdldE9wdGlvbnMoY2ZDb25maWcpPy5maW5kIHsgaXQudG9TdHJpbmcoKSA9PSBGbG93VHlwZSB9XG4gICAgbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGZsb3dUeXBlRmllbGQsIHZhbHVlKVxuICAgIFxuICAgIGRlZiBhcHByID0gXCJcXFwiXCIgKyBvYmogKyBcIlxcXCJcIlxuXHRkZWYgb2JqZWN0c0FwcHJvdmVyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBQXBwcm92ZXJcXFwiIEFORCBvYmplY3RpZCA9IFwiICsgYXBwcilcbiAgIFxuXHRpZiAob2JqZWN0c0FwcHJvdmVyLnNpemUoKT4wKXtcbiAgICAgICAgLy9BcHByb3ZlciBSREEgdGVzdCAyMzUwNCAtIHByb2QgMjI3MjFcbiAgICAgICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0XG4gICAgICAgIG5ld1N1YlRhc2suc2V0Q3VzdG9tRmllbGRWYWx1ZShjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoXCIyMjcyMVwiKSksIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU1NCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpICAgXG4gICAgICAgIC8vRGlzcGxheSBOYW1lIHRlc3QgMjM1MDUgLSBwcm9kIDIyNzIyXG4gICAgICAgIC8vRGlzcGxheSBOYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MTAgLSBwcm9kIDI1ODZcbiAgICAgICAgbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIyNzIyXCIpKSwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNBcHByb3ZlclswXS5nZXRJZCgpLCAyNTg2KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSlcbiAgICAgICAgLy9BcHByb3ZlciBFbWFpbCB0ZXN0IDIzNTEyIC0gcHJvZCAyMjcyM1xuICAgICAgICAvL0VtYWlsIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MTEgLSBwcm9kIDI1ODdcbiAgICAgICAgaWYgKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU4NykgIT0gbnVsbClcbiAgICAgICAgXHRuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MjNcIikpLCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1ODcpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKVxuICAgICAgICAvL05hbWUgc2NoZW1hIFJEQUFwcHJvdmVyIHRlc3QgNDQwNyAtIHByb2QgIDI1NTRcbiAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KEZsb3dUeXBlICsgXCIgLSBcIiArIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU1NCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkgKyBcIiAtIFwiICsgcGFyZW50SXNzdWUuZ2V0U3VtbWFyeSgpKVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KEZsb3dUeXBlICsgXCIgLSBcIiArIHBhcmVudElzc3VlLmdldFN1bW1hcnkoKSlcblx0fVxuICAgICBcbiAgICBuZXdTdWJUYXNrLnNldFBhcmVudE9iamVjdChwYXJlbnRJc3N1ZSlcbiAgICBuZXdTdWJUYXNrLnNldFByb2plY3RPYmplY3QocGFyZW50SXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpKVxuICAgIFxuICAgIG5ld1N1YlRhc2suc2V0SXNzdWVUeXBlSWQoY29uc3RhbnRNYW5hZ2VyLmdldEFsbElzc3VlVHlwZU9iamVjdHMoKS5maW5ke1xuICAgICAgICBpdC5nZXROYW1lKCkgPT0gXCJBcHByb3ZhbCBSREFcIlxuICAgIH0uaWQpXG5cbiAgICBkZWYgbmV3SXNzdWVQYXJhbXMgPSBbXCJpc3N1ZVwiIDogbmV3U3ViVGFza10gYXMgTWFwPFN0cmluZyxPYmplY3Q+XG5cbiAgICBpc3N1ZU1hbmFnZXIuY3JlYXRlSXNzdWVPYmplY3QoY3VycmVudFVzZXIsIG5ld0lzc3VlUGFyYW1zKVxuICAgIHN1YlRhc2tNYW5hZ2VyLmNyZWF0ZVN1YlRhc2tJc3N1ZUxpbmsocGFyZW50SXNzdWUsIG5ld1N1YlRhc2ssIGN1cnJlbnRVc2VyKVxuXG4gICAgaXNzdWVJbmRleGluZ1NlcnZpY2UucmVJbmRleChuZXdTdWJUYXNrKVxuICAgIHBhcmVudElzc3VlLnNldEN1c3RvbUZpZWxkVmFsdWUoZmxvd1R5cGVGaWVsZCwgdmFsdWUpXG4gICAgQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVNYW5hZ2VyKCkudXBkYXRlSXNzdWUodXNlciwgcGFyZW50SXNzdWUsIEV2ZW50RGlzcGF0Y2hPcHRpb24uRE9fTk9UX0RJU1BBVENILCBmYWxzZSk7XG4gICAgaXNzdWVJbmRleGluZ1NlcnZpY2UucmVJbmRleChwYXJlbnRJc3N1ZSlcbiAgICBpID0gaSArIDFcbn1cblxuZGVmIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChJbnRlZ2VyIGFwcHJvdmVyLCBBcHBsaWNhdGlvblVzZXIgY3VycmVudFVzZXIsIE11dGFibGVJc3N1ZSBwYXJlbnRJc3N1ZSwgU3RyaW5nIEZsb3dUeXBlLCBTdHJpbmcgaGlkZSwgTXV0YWJsZUlzc3VlIGN1cnJJc3N1ZSkgeyBcbiAgICBVc2VyVXRpbCBcdFx0XHR1c2VyVXRpbCBcdFx0XHQ9IENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJVdGlsKClcbiAgICBJc3N1ZU1hbmFnZXIgXHRcdGlzc3VlTWFuYWdlciBcdFx0PSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKVxuICAgIElzc3VlSW5kZXhpbmdTZXJ2aWNlIGlzc3VlSW5kZXhpbmdTZXJ2aWNlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KElzc3VlSW5kZXhpbmdTZXJ2aWNlKVxuICAgIElzc3VlU2VydmljZSBpc3N1ZVNlcnZpY2UgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZVNlcnZpY2UoKVxuICAgIFRyYW5zaXRpb25PcHRpb25zIHRyYW5zaXRpb25PcHRpb25zID0gbmV3IFRyYW5zaXRpb25PcHRpb25zLkJ1aWxkZXIoKS5za2lwQ29uZGl0aW9ucygpLnNraXBQZXJtaXNzaW9ucygpLnNraXBWYWxpZGF0b3JzKCkuYnVpbGQoKVxuXG4gICAgU3ViVGFza01hbmFnZXIgc3ViVGFza01hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRTdWJUYXNrTWFuYWdlcigpO1xuICAgIEN1c3RvbUZpZWxkTWFuYWdlciBcdGN1c3RvbUZpZWxkTWFuYWdlciBcdD0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKClcbiAgICBkZWYgaXNzdWVGYWN0b3J5ID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVGYWN0b3J5KClcbiAgICBkZWYgY29uc3RhbnRNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29uc3RhbnRzTWFuYWdlcigpXG5cdFxuICAgIC8qIEdldCBJbnNpZ2h0IElRTCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi9cbiAgICBDbGFzcyBpcWxGYWNhZGVDbGFzcyA9IENvbXBvbmVudEFjY2Vzc29yLmdldFBsdWdpbkFjY2Vzc29yKCkuZ2V0Q2xhc3NMb2FkZXIoKS5maW5kQ2xhc3MoXCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5JUUxGYWNhZGVcIik7IFxuICAgIGRlZiBpcWxGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUoaXFsRmFjYWRlQ2xhc3MpO1xuICAgIC8qIEdldCBJbnNpZ2h0IE9iamVjdCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi9cbiAgICBDbGFzcyBvYmplY3RGYWNhZGVDbGFzcyA9IENvbXBvbmVudEFjY2Vzc29yLmdldFBsdWdpbkFjY2Vzc29yKCkuZ2V0Q2xhc3NMb2FkZXIoKS5maW5kQ2xhc3MoXCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5PYmplY3RGYWNhZGVcIik7XG4gICAgZGVmIG9iamVjdEZhY2FkZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldE9TR2lDb21wb25lbnRJbnN0YW5jZU9mVHlwZShvYmplY3RGYWNhZGVDbGFzcyk7XG4gICAgXG4gICAgTXV0YWJsZUlzc3VlIG5ld1N1YlRhc2sgPSBpc3N1ZUZhY3RvcnkuZ2V0SXNzdWUoKVxuXG4gICAgbmV3U3ViVGFzay5zZXRSZXBvcnRlcihjdXJyZW50VXNlcilcbiAgICAvL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAyMjcxOVxuICAgIGRlZiBmbG93VHlwZUZpZWxkID0gY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MTlcIikpXG5cbiAgICBkZWYgY2ZDb25maWcgPSBmbG93VHlwZUZpZWxkLmdldFJlbGV2YW50Q29uZmlnKHBhcmVudElzc3VlKVxuICAgIGRlZiB2YWx1ZSA9IENvbXBvbmVudEFjY2Vzc29yLm9wdGlvbnNNYW5hZ2VyLmdldE9wdGlvbnMoY2ZDb25maWcpPy5maW5kIHsgaXQudG9TdHJpbmcoKSA9PSBGbG93VHlwZSB9XG4gICAgbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGZsb3dUeXBlRmllbGQsIHZhbHVlKVxuICAgIFxuICAgIC8vc2Fsdm8gZGlzcGxheW5hbWUgZSBhcHByb3ZlciBSREFcbiAgICBcbiAgICBkZWYgYXBwciA9IFwiXFxcIlwiICsgYXBwcm92ZXIgKyBcIlxcXCJcIlxuXHRkZWYgb2JqZWN0c0FwcHJvdmVyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBQXBwcm92ZXJcXFwiIEFORCBvYmplY3RpZCA9IFwiICsgYXBwcilcbiAgIFxuXHRpZiAob2JqZWN0c0FwcHJvdmVyLnNpemUoKT4wKXtcbiAgICAgICAgLy9BcHByb3ZlciBSREEgdGVzdCAyMzUwNCAtIHByb2QgMjI3MjFcbiAgICAgICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0XG4gICAgXHRuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MjFcIikpLCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKSAgIFxuICAgICAgICAvL0Rpc3BsYXkgTmFtZSB0ZXN0IDIzNTA1IC0gcHJvZCAyMjcyMlxuICAgICAgICAvL0Rpc3BsYXkgTmFtZSBzY2hlbWEgUkRBQXBwcm92ZXIgdGVzdCA0NDEwIC0gcHJvZCAyNTg2XG4gICAgICAgIG5ld1N1YlRhc2suc2V0Q3VzdG9tRmllbGRWYWx1ZShjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoXCIyMjcyMlwiKSksIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU4NikuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpXG4gICAgICAgIC8vbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIzNTEyXCIpKSwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNBcHByb3ZlclswXS5nZXRJZCgpLCA0NDExKS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSlcbiAgICAgICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0XG4gICAgICAgIG5ld1N1YlRhc2suc2V0U3VtbWFyeShGbG93VHlwZSArIFwiIC0gXCIgKyBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpICsgXCIgLSBcIiArIHBhcmVudElzc3VlLmdldFN1bW1hcnkoKSlcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgIG5ld1N1YlRhc2suc2V0U3VtbWFyeShGbG93VHlwZSArIFwiIC0gXCIgKyBwYXJlbnRJc3N1ZS5nZXRTdW1tYXJ5KCkpXG5cdH1cblx0Ly9IaWRlIHRlc3QgMjMzMDAgLSBwcm9kIDIyNzIwXG5cdGlmIChoaWRlID09IFwiU2lcIikgICAgICBcbiAgICAgICAgbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZyhcIjIyNzIwXCIpKSwgW0NvbXBvbmVudEFjY2Vzc29yLm9wdGlvbnNNYW5hZ2VyLmdldE9wdGlvbnMoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKFwiMjI3MjBcIikpLmdldFJlbGV2YW50Q29uZmlnKGN1cnJJc3N1ZSkpPy5maW5kIHsgaXQudG9TdHJpbmcoKSA9PSBcIlllc1wiIH1dKVxuICAgIFx0XG4gICAgbmV3U3ViVGFzay5zZXRQYXJlbnRPYmplY3QocGFyZW50SXNzdWUpXG4gICAgbmV3U3ViVGFzay5zZXRQcm9qZWN0T2JqZWN0KHBhcmVudElzc3VlLmdldFByb2plY3RPYmplY3QoKSlcblxuICAgIG5ld1N1YlRhc2suc2V0SXNzdWVUeXBlSWQoY29uc3RhbnRNYW5hZ2VyLmdldEFsbElzc3VlVHlwZU9iamVjdHMoKS5maW5ke1xuICAgICAgICBpdC5nZXROYW1lKCkgPT0gXCJBcHByb3ZhbCBSREFcIlxuICAgIH0uaWQpXG5cbiAgICBkZWYgbmV3SXNzdWVQYXJhbXMgPSBbXCJpc3N1ZVwiIDogbmV3U3ViVGFza10gYXMgTWFwPFN0cmluZyxPYmplY3Q+XG5cbiAgICBpc3N1ZU1hbmFnZXIuY3JlYXRlSXNzdWVPYmplY3QoY3VycmVudFVzZXIsIG5ld0lzc3VlUGFyYW1zKVxuICAgIHN1YlRhc2tNYW5hZ2VyLmNyZWF0ZVN1YlRhc2tJc3N1ZUxpbmsocGFyZW50SXNzdWUsIG5ld1N1YlRhc2ssIGN1cnJlbnRVc2VyKVxuXG4gICAgaXNzdWVJbmRleGluZ1NlcnZpY2UucmVJbmRleChuZXdTdWJUYXNrKVxuICAgIHBhcmVudElzc3VlLnNldEN1c3RvbUZpZWxkVmFsdWUoZmxvd1R5cGVGaWVsZCwgdmFsdWUpXG4gICAgQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVNYW5hZ2VyKCkudXBkYXRlSXNzdWUoY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBFdmVudERpc3BhdGNoT3B0aW9uLkRPX05PVF9ESVNQQVRDSCwgZmFsc2UpO1xuICAgIGlzc3VlSW5kZXhpbmdTZXJ2aWNlLnJlSW5kZXgocGFyZW50SXNzdWUpXG4gICAgQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5zZXRMb2dnZWRJblVzZXIoQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlck1hbmFnZXIoKS5nZXRVc2VyQnlLZXkoXCJhdGxhc3NpYW5fZmFhY19zZXJ2aWNlX2Rlc2tcIikpXG4gICAgY3VycmVudFVzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LmdldExvZ2dlZEluVXNlcigpO1xuXHRcbiAgICBJc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgbmV3U3ViVGFzay5nZXRJZCgpLDYxLCBpc3N1ZVNlcnZpY2UubmV3SXNzdWVJbnB1dFBhcmFtZXRlcnMoKSwgdHJhbnNpdGlvbk9wdGlvbnMpXG4gICAgaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgIGlzc3VlU2VydmljZS50cmFuc2l0aW9uKGN1cnJlbnRVc2VyLCByZXN1bHQpXG4gICAgfVxuICAgIC8qXG4gICAgV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCB3b3JrZmxvd1RyYW5zaXRpb25VdGlsID0gKFdvcmtmbG93VHJhbnNpdGlvblV0aWwpIEppcmFVdGlscy5sb2FkQ29tcG9uZW50KFdvcmtmbG93VHJhbnNpdGlvblV0aWxJbXBsLmNsYXNzKTtcbiAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldElzc3VlKG5ld1N1YlRhc2spO1xuXHQvL1RvQXBwcm92ZWQgdHJhbnNhemlvbmUgc3VidGFzayB0ZXN0IDMxIC0gcHJvZCA2MVxuICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDYxKTtcbiAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7XG4gICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTtcbiAgICB9XHQqL1xufVxuXG5kZWYgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShTdHJpbmcgYXBwcm92ZXIpXG57XG4gICAgLyogR2V0IEluc2lnaHQgSVFMIEZhY2FkZSBmcm9tIHBsdWdpbiBhY2Nlc3NvciAqL1xuICAgIENsYXNzIGlxbEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcyhcImNvbS5yaWFkYWxhYnMuamlyYS5wbHVnaW5zLmluc2lnaHQuY2hhbm5lbC5leHRlcm5hbC5hcGkuZmFjYWRlLklRTEZhY2FkZVwiKTsgXG4gICAgZGVmIGlxbEZhY2FkZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldE9TR2lDb21wb25lbnRJbnN0YW5jZU9mVHlwZShpcWxGYWNhZGVDbGFzcyk7XG4gICAgLyogR2V0IEluc2lnaHQgT2JqZWN0IEZhY2FkZSBmcm9tIHBsdWdpbiBhY2Nlc3NvciAqL1xuICAgIENsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcyhcImNvbS5yaWFkYWxhYnMuamlyYS5wbHVnaW5zLmluc2lnaHQuY2hhbm5lbC5leHRlcm5hbC5hcGkuZmFjYWRlLk9iamVjdEZhY2FkZVwiKTtcbiAgICBkZWYgb2JqZWN0RmFjYWRlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0T1NHaUNvbXBvbmVudEluc3RhbmNlT2ZUeXBlKG9iamVjdEZhY2FkZUNsYXNzKTtcblxuICAgIGFwcHJvdmVyID0gXCJcXFwiXCIgKyBhcHByb3ZlciArIFwiXFxcIlwiXG4gICAgZGVmIG9iamVjdEFwcHJvdmVyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsIFwib2JqZWN0VHlwZT1cXFwiUkRBQXBwcm92ZXJcXFwiIEFORCBvYmplY3RpZCA9IFwiICsgYXBwcm92ZXIgKVxuICAgIC8vTmFtZSBzY2hlbWEgUkRBQXBwcm92ZXIgdGVzdCA0NDA3IC0gcHJvZCAgMjU1NFxuICAgIGRlZiBhcHByb3ZlclVzZXJuYW1lID0gb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdEFwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpXG5cbiAgICByZXR1cm4gYXBwcm92ZXJVc2VybmFtZVxufVxuXG4iLCJzY3JpcHRQYXRoIjpudWxsLCJwYXJhbWV0ZXJzIjp7fX0=</arg>
                  <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
                  <arg name="FIELD_INLINE_SCRIPT">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLk11dGFibGVJc3N1ZQppbXBvcnQgY29tLm9wZW5zeW1waG9ueS53b3JrZmxvdy5Xb3JrZmxvd0NvbnRleHQ7CmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuY29uZmlnLlN1YlRhc2tNYW5hZ2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuV29ya2Zsb3dUcmFuc2l0aW9uVXRpbDsKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS53b3JrZmxvdy5Xb3JrZmxvd1RyYW5zaXRpb25VdGlsSW1wbDsKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS51dGlsLkppcmFVdGlsczsKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5zdGF0dXMuU3RhdHVzCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEudXNlci5BcHBsaWNhdGlvblVzZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5qcWwucGFyc2VyLkpxbFF1ZXJ5UGFyc2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud2ViLmJlYW4uUGFnZXJGaWx0ZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5iYy5pc3N1ZS5zZWFyY2guU2VhcmNoU2VydmljZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLklzc3VlTWFuYWdlcgppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLkN1c3RvbUZpZWxkTWFuYWdlcgppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLmZpZWxkcy5DdXN0b21GaWVsZAppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIudXRpbC5Vc2VyVXRpbAppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmNvbmZpZy5SZXNvbHV0aW9uTWFuYWdlcgppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmV2ZW50LnR5cGUuRXZlbnREaXNwYXRjaE9wdGlvbgppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLmluZGV4Lklzc3VlSW5kZXhpbmdTZXJ2aWNlCmltcG9ydCBvcmcuYXBhY2hlLmxvZzRqLkNhdGVnb3J5CgpTZWFyY2hTZXJ2aWNlIAkJc2VhcmNoU2VydmljZSAJCT0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KFNlYXJjaFNlcnZpY2UuY2xhc3MpClVzZXJVdGlsIAkJCXVzZXJVdGlsIAkJCT0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlclV0aWwoKQpJc3N1ZU1hbmFnZXIgCQlpc3N1ZU1hbmFnZXIgCQk9IENvbXBvbmVudEFjY2Vzc29yLmdldElzc3VlTWFuYWdlcigpCklzc3VlSW5kZXhpbmdTZXJ2aWNlIGlzc3VlSW5kZXhpbmdTZXJ2aWNlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KElzc3VlSW5kZXhpbmdTZXJ2aWNlKQpkZWYganFsUXVlcnlQYXJzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb21wb25lbnQoSnFsUXVlcnlQYXJzZXIpClN1YlRhc2tNYW5hZ2VyIHN1YlRhc2tNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0U3ViVGFza01hbmFnZXIoKTsKQ3VzdG9tRmllbGRNYW5hZ2VyIAljdXN0b21GaWVsZE1hbmFnZXIgCT0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkKZGVmIGlzc3VlRmFjdG9yeSA9IENvbXBvbmVudEFjY2Vzc29yLmdldElzc3VlRmFjdG9yeSgpCmRlZiBjb25zdGFudE1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb25zdGFudHNNYW5hZ2VyKCkKCi8vTXV0YWJsZUlzc3VlIGlzc3VlID0gaXNzdWVNYW5hZ2VyLmdldElzc3VlQnlLZXlJZ25vcmVDYXNlKCJSREEtMjQyNiIpCk11dGFibGVJc3N1ZSBwYXJlbnRJc3N1ZSA9IGlzc3VlLnBhcmVudE9iamVjdDsKCkNhdGVnb3J5IGxvZyA9IENhdGVnb3J5LmdldEluc3RhbmNlKCJjb20ub25yZXNvbHZlLmppcmEuZ3Jvb3Z5LlBvc3RGdW5jdGlvbiIpCmxvZy5zZXRMZXZlbChvcmcuYXBhY2hlLmxvZzRqLkxldmVsLkRFQlVHKQoKQXBwbGljYXRpb25Vc2VyIG9sZFVzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LmxvZ2dlZEluVXNlcgpDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LnNldExvZ2dlZEluVXNlcihDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyTWFuYWdlcigpLmdldFVzZXJCeUtleSgiYXRsYXNzaWFuX2ZhYWNfc2VydmljZV9kZXNrIikpCkFwcGxpY2F0aW9uVXNlciB1c2VyID0gQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5sb2dnZWRJblVzZXIKCi8qIEdldCBJbnNpZ2h0IElRTCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi8KQ2xhc3MgaXFsRmFjYWRlQ2xhc3MgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRQbHVnaW5BY2Nlc3NvcigpLmdldENsYXNzTG9hZGVyKCkuZmluZENsYXNzKCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5JUUxGYWNhZGUiKTsgCmRlZiBpcWxGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUoaXFsRmFjYWRlQ2xhc3MpOwovKiBHZXQgSW5zaWdodCBPYmplY3QgRmFjYWRlIGZyb20gcGx1Z2luIGFjY2Vzc29yICovCkNsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcygiY29tLnJpYWRhbGFicy5qaXJhLnBsdWdpbnMuaW5zaWdodC5jaGFubmVsLmV4dGVybmFsLmFwaS5mYWNhZGUuT2JqZWN0RmFjYWRlIik7CmRlZiBvYmplY3RGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUob2JqZWN0RmFjYWRlQ2xhc3MpOwoKLy90b3RhbCBwcmljZSB0ZXN0IDIyNzA0IC0gcHJvZCAyMjczMgpDdXN0b21GaWVsZCBUb3RhbFByaWNlRmllbGQgPSBjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoIjIyNzMyIikpCmRlZiBUb3RQcmljZVYgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKFRvdGFsUHJpY2VGaWVsZCkKCi8vUkRBIFR5cGUgdGVzdCAyMjcwNyAtIHByb2QgMjI3MzUKQ3VzdG9tRmllbGQgUmRhVHlwZUZpZWxkID0gY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjczNSIpKQpkZWYgUmRhVHlwZVYgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKFJkYVR5cGVGaWVsZCkKCi8vRnVuY3Rpb24gdGVzdCAyMjcwMSAtIHByb2QgMjI3MjkKQ3VzdG9tRmllbGQgRnVuY3Rpb25GaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3MjkiKSkKZGVmIEZ1bmN0aW9uTmFtZSA9IHBhcmVudElzc3VlLmdldEN1c3RvbUZpZWxkVmFsdWUoRnVuY3Rpb25GaWVsZCkKCi8vTWF0ZXJpYWwgR3JvdXAgdGVzdCAyMzQwMCAtIHByb2QgMjI3NDMKQ3VzdG9tRmllbGQgbWF0ZXJpYWxHcm91cCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3NDMiKSkKZGVmIG1hdGVyaWFsR3JvdXBWID0gcGFyZW50SXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShtYXRlcmlhbEdyb3VwKQpkZWYgbWF0R3JvdXBzID0gW10KaWYgKG1hdGVyaWFsR3JvdXBWIT1udWxsKQogCW1hdEdyb3Vwcz0gbWF0ZXJpYWxHcm91cFYuc3BsaXQoIjsiKQoKLy9FeHRyYSBCdWRnZXQgdGVzdCAyMjcwNiAtIHByb2QgMjI3MzQKZGVmIEV4dHJhQnVkZ2V0ID0gZmFsc2UKQ3VzdG9tRmllbGQgRXh0cmFCdWRnZXRGaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3MzQiKSkKRXh0cmFCdWRnZXQgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKEV4dHJhQnVkZ2V0RmllbGQpCmlmIChFeHRyYUJ1ZGdldCAhPSBudWxsKXsKICAgIGlmIChFeHRyYUJ1ZGdldFswXS50b1N0cmluZygpID09ICJZZXMiKQogICAgICAgIEV4dHJhQnVkZ2V0ID0gdHJ1ZQp9CmlmIChFeHRyYUJ1ZGdldCA9PSBudWxsKXsKICAgIEV4dHJhQnVkZ2V0ID0gZmFsc2UKfQoKLy9JbnZvaWNlIERpZmZlcmVuY2UgdGVzdCAyMzUwMSAtIHByb2QgMjI3NDgKZGVmIERpZmZJbnZvaWNlID0gZmFsc2UKQ3VzdG9tRmllbGQgRGlmZkludm9pY2VGaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3NDgiKSkKRGlmZkludm9pY2UgPSBwYXJlbnRJc3N1ZS5nZXRDdXN0b21GaWVsZFZhbHVlKERpZmZJbnZvaWNlRmllbGQpCmlmIChEaWZmSW52b2ljZSAhPSBudWxsKXsKICAgIGlmIChEaWZmSW52b2ljZVswXS50b1N0cmluZygpID09ICJZZXMiKQogICAgICAgIERpZmZJbnZvaWNlID0gdHJ1ZQp9CmlmIChEaWZmSW52b2ljZSA9PSBudWxsKXsKICAgIERpZmZJbnZvaWNlID0gZmFsc2UKfQpsb2cuZGVidWcgIkRpZmZJbnZvaWNlICIgKyBEaWZmSW52b2ljZQpsb2cuZGVidWcgIkV4dHJhQnVkZ2V0ICIgKyBFeHRyYUJ1ZGdldAoKLy9GbG93IFR5cGUgdGVzdCAyMjgwMSAtIHByb2QgMjI3MTkKZGVmIGZsb3dUeXBlID0gaXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShDb21wb25lbnRBY2Nlc3Nvci5nZXRDdXN0b21GaWVsZE1hbmFnZXIoKS5nZXRDdXN0b21GaWVsZE9iamVjdCgyMjcxOSkpCgpkZWYganFsU2VhcmNoID0gIiIKZGVmIHF1ZXJ5CmRlZiBzZWFyY2gKCmRlZiByZXNvbHV0aW9uTWFuYWdlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChSZXNvbHV0aW9uTWFuYWdlcikKCmlmIChmbG93VHlwZS50b1N0cmluZygpPT0nQ29udHJvbGxpbmcgZnVuY3Rpb24nICl7CiAgICBsb2cuZGVidWcgImZsb3dUeXBlOiAiICsgZmxvd1R5cGUKICAgIGpxbFNlYXJjaCA9ICJwcm9qZWN0ID0gJyIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArICInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIHJlc29sdXRpb24gPSBVbnJlc29sdmVkIEFORCBwYXJlbnQgPSAnIiArIHBhcmVudElzc3VlLmtleSArICInIEFORCBrZXkgIT0gJyIgKyBpc3N1ZS5rZXkgKyAiJyIKCXF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICBzZWFyY2ggPSBzZWFyY2hTZXJ2aWNlLnNlYXJjaCh1c2VyLCBxdWVyeSwgUGFnZXJGaWx0ZXIuZ2V0VW5saW1pdGVkRmlsdGVyKCkpCiAgICAKICAgIC8vIHNldCBSZXNvbHV0aW9uIGRlaSBzdWJ0YXNrIGNoZSBub24gc2lhIHF1ZWxsbyBjb3JyZW50ZSBlIG1ldHRvIGxvIHN0YXR1cyBpbiBhcHByb3ZlZCB0cmFubmUgcGVyIGlsIGNhc28gZGkgYXBwcm92YXppb25lIGNvbmdpdW50YSBDRk8rQ0VPCiAgICBmb3IgKGN1cnJJIGluIHNlYXJjaC5yZXN1bHRzKQogICAgewogICAgICAgIE11dGFibGVJc3N1ZSBjdXJySXNzdWUgPWlzc3VlTWFuYWdlci5nZXRJc3N1ZUJ5S2V5SWdub3JlQ2FzZShjdXJySS5rZXkpCiAgICAgICAgCiAgICAgICAgQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5zZXRMb2dnZWRJblVzZXIoQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlck1hbmFnZXIoKS5nZXRVc2VyQnlLZXkoImF0bGFzc2lhbl9mYWFjX3NlcnZpY2VfZGVzayIpKQogICAgICAgIGRlZiBjdXJyZW50VXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuZ2V0TG9nZ2VkSW5Vc2VyKCk7CgkJCiAgICAgICAgV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCB3b3JrZmxvd1RyYW5zaXRpb25VdGlsID0gKFdvcmtmbG93VHJhbnNpdGlvblV0aWwpIEppcmFVdGlscy5sb2FkQ29tcG9uZW50KFdvcmtmbG93VHJhbnNpdGlvblV0aWxJbXBsLmNsYXNzKTsKICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldElzc3VlKGN1cnJJc3N1ZSk7CgkJLy90cmFuc2F6aW9uZSBzdWkgc3VidGFzayBUb0FwcHJvdmVkIHRlc3QgMzEgLSBwcm9kIDYxCiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oNjEpOwoJCWlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAJd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwoJCX0KCQkvL0hpZGUgdGVzdCAyMzMwMCAtIHByb2QgMjI3MjAKICAgICAgICBDdXN0b21GaWVsZCBoaWRlID0gY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjcyMCIpKQogICAgICAgIGN1cnJJc3N1ZS5zZXRDdXN0b21GaWVsZFZhbHVlKGhpZGUsIFtDb21wb25lbnRBY2Nlc3Nvci5vcHRpb25zTWFuYWdlci5nZXRPcHRpb25zKGhpZGUuZ2V0UmVsZXZhbnRDb25maWcoY3Vycklzc3VlKSk/LmZpbmQgeyBpdC50b1N0cmluZygpID09ICJZZXMiIH1dKQogICAgICAgIGxvZy5kZWJ1ZyBjdXJySXNzdWUKICAgICAgICBsb2cuZGVidWcgImVudHJvIGluIGNvbnRyb2xsaW5nIGUgc2V0dG8gaGlkZSIKICAgICAgICBpc3N1ZU1hbmFnZXIudXBkYXRlSXNzdWUodXNlciwgY3Vycklzc3VlLCBFdmVudERpc3BhdGNoT3B0aW9uLkRPX05PVF9ESVNQQVRDSCwgZmFsc2UpCiAgICB9Cn0KCi8vIHNldCByZXNvbHV0aW9uIGRlbCBzdWJ0YXNrIGNvcnJlbnRlIC0gbG8gc3RhdHVzIHNhcsOgIGdpw6AgaW1wb3N0YXRvIGFkIGFwcHJvdmVkCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJDb250cm9sbGluZyBmdW5jdGlvbiIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIkNvbnRyb2xsaW5nIGZ1bmN0aW9uIikpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJUZWNobmljYWwgQXBwcm92YWwiKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJUZWNobmljYWwgQXBwcm92YWwiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIlB1cmNoYXNlIGJ5IGNyZWRpdCBjYXJkIikKCWlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZSgiUHVyY2hhc2UgYnkgY3JlZGl0IGNhcmQiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIkZpcnN0IExldmVsIEFwcHJvdmFsIikKCWlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZSgiRmlyc3QgTGV2ZWwgQXBwcm92YWwiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIlNlY29uZCBMZXZlbCBBcHByb3ZhbCIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIlNlY29uZCBMZXZlbCBBcHByb3ZhbCIpKQppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiVGhpcmQgTGV2ZWwgQXBwcm92YWwiKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJUaGlyZCBMZXZlbCBBcHByb3ZhbCIpKQppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiR3JvdXAgTGV2ZWwgQXBwcm92YWwiKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJHcm91cCBMZXZlbCBBcHByb3ZhbCIpKQppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiQ0VPK0NGTyIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIkNFTytDRk8iKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIkdlbmVyYWwgTWFuYWdlciIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIkdlbmVyYWwgTWFuYWdlciIpKQoKaXNzdWVNYW5hZ2VyLnVwZGF0ZUlzc3VlKHVzZXIsIGlzc3VlLCBFdmVudERpc3BhdGNoT3B0aW9uLkRPX05PVF9ESVNQQVRDSCwgZmFsc2UpCgpXb3JrZmxvd1RyYW5zaXRpb25VdGlsIHdvcmtmbG93VHJhbnNpdGlvblV0aWwgPSAoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCkgSmlyYVV0aWxzLmxvYWRDb21wb25lbnQoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbEltcGwuY2xhc3MpOwp3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldElzc3VlKHBhcmVudElzc3VlKTsKCi8vc2Ugc29ubyBuZWxsYSBhcHByb3ZhemlvbmUgZmF0dHVyYSBlIHNvbm8gY29udHJvbGxpbmcsIGRvcG8gYXZlciBhcHByb3ZhdG8gaWwgc2Vjb25kbyBjb250cm9sbGluZyBpbiBhdXRvbWF0aWNvIGNoaXVkbyBsYSBpc3N1ZSBwYWRyZSBwZXJjaMOoIG5vbiBjaSBzb25vIHVsdGVyaW9uaSBzdGVwIGFwcHJvdmF0aXZpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJDb250cm9sbGluZyBmdW5jdGlvbiIgJiYgRGlmZkludm9pY2UpewogICAgbG9nLmRlYnVnICJDb250cm9sbGluZyBmdW5jdGlvbiAtIGFwcHJvdm8gaWwgcGFkcmUgcGVyY2jDqCBub24gY2kgc29ubyBhbHRyaSBzdGVwIGRpIGFwcHJvdmF6aW9uZSIKICAgIC8vVHJhbnNhemlvbmUgcGFkcmUgQXBwcm92ZWQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMQogICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpOwogICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkgewogICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgIH0KICAgIGZsb3dUeXBlID0gIiIKfSAgCi8vcmljZXJjYSBkZWxsbyBzdGVwIGFwcHJvdmF0aXZvICAKU3RyaW5nIHF1ZXJ5UGFyYW0gPSAiXCIiICsgRnVuY3Rpb25OYW1lWzBdLmdldE5hbWUoKSArICJcIiIKCmRlZiBvYmplY3RzRnVuY3Rpb24gPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFGdW5jdGlvbnNcIiBBTkQgXCJOYW1lXCIgSU4gKCIgKyBxdWVyeVBhcmFtICsgIikiKTsgCgovL0NvbXBhbnkgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxOTggLSBwcm9kIDI1NzAKZGVmIGNvbXBhbnkgPSAiXCIiICsgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTcwKS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSArICJcIiIKCmRlZiBncm91cENvbnRyb2xsZXIKZGVmIG9iamVjdHNDb250cm9sbGluZwovL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1NjcKaWYgKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykgIT0gbnVsbCl7CiAgICAvL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1NjcKCWdyb3VwQ29udHJvbGxlciA9IG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkKICAgIG9iamVjdHNDb250cm9sbGluZyA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCAib2JqZWN0VHlwZT1cIlJEQUNvbnRyb2xsaW5nXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gIiArIGdyb3VwQ29udHJvbGxlciArICIpIikKfQovL0dyb3VwIE5hbWUgaW5zaWdodCBSREFGdW5jdGlvbiAgdGVzdCAzMTcyIC0gcHJvZCAyNTY2CmRlZiBmdW5jdGlvbkdyb3VwID0gb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY2KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKQoKZGVmIG9iamVjdHNHcm91cHMgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFHcm91cHNcIiBBTkQgKG9iamVjdGlkID0gIiArIGZ1bmN0aW9uR3JvdXAgKyAiKSIpCgovL1N0cmluZyBxdWVyeUNkYyA9ICJcIiIgKyBjZGNWICsgIlwiIgovL2RlZiBvYmplY3RzQ0RDID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBQ0RDXCIgQU5EIFwiTmFtZVwiIElOICgiICsgcXVlcnlDZGMgKyAiKSIpOyAKCi8vcmljZXJjYSBhcHByb3ZhemlvbmUgdGVjbmljYQpkZWYgb2JqZWN0c1RlY24gPSBbXQpmb3IobWF0R3JvdXAgaW4gbWF0R3JvdXBzKXsKICAgIGlmIChvYmplY3RzVGVjbi5zaXplKCk9PTApewogICAgICAgIFN0cmluZyBxdWVyeVRlY24gPSAiXCIiICsgbWF0R3JvdXAgKyAiXCIiCiAgICAgICAgb2JqZWN0c1RlY24gPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFUZWNobmljYWxBcHByb3ZhbFwiIEFORCBcIk5hbWVcIiBJTiAoIiArIHF1ZXJ5VGVjbiArICIpIEFORCBcIkZ1bmN0aW9uIG5hbWVcIiA9ICIgKyBxdWVyeVBhcmFtKTsgCiAgICAgICAgCiAgICB9Cn0KCi8vcmljZXJjYSBwZXIgYXBwcm92YXppb25lIGxpdmVsbG8gMiAKZGVmIG9iamVjdHNJbnRlcnZhbHNMMgpkZWYgb2JqZWN0c0ludGVydmFsc0wzIApkZWYgb2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjEKZGVmIG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24yCmRlZiBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMwoKaWYgKFJkYVR5cGVWLnRvU3RyaW5nKCk9PSJPUEVYIil7CiAgICBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMSA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCAib2JqZWN0VHlwZT1cIlJEQUludGVydmFsc1wiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9ICIgKyBjb21wYW55ICsgIikgQU5EIFwiTGV2ZWxcIiA9IDEgQU5EIFwiVHlwZVwiID0gIiArIFJkYVR5cGVWICsgIiBBTkQgXCJWYWx1ZSBGcm9tXCIgPD0gIiArIFRvdFByaWNlViAgKQogICAgb2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjIgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFJbnRlcnZhbHNcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIEFORCBcIkxldmVsXCIgPSAyIEFORCBcIlR5cGVcIiA9ICIgKyBSZGFUeXBlViArICIgQU5EIFwiVmFsdWUgRnJvbVwiIDw9ICIgKyBUb3RQcmljZVYgICkKCW9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24zID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBSW50ZXJ2YWxzXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gIiArIGNvbXBhbnkgKyAiKSBBTkQgXCJMZXZlbFwiID0gMyBBTkQgXCJUeXBlXCIgPSAiICsgUmRhVHlwZVYgKyAiIEFORCBcIlZhbHVlIEZyb21cIiA8PSAiICsgVG90UHJpY2VWICApCglvYmplY3RzSW50ZXJ2YWxzTDIgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFJbnRlcnZhbHNcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIEFORCBcIkxldmVsXCIgPSA0IEFORCBcIlR5cGVcIiA9ICIgKyBSZGFUeXBlViArICIgQU5EIFwiVmFsdWUgRnJvbVwiIDw9ICIgKyBUb3RQcmljZVYgICkKCW9iamVjdHNJbnRlcnZhbHNMMyA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCAib2JqZWN0VHlwZT1cIlJEQUludGVydmFsc1wiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9ICIgKyBjb21wYW55ICsgIikgQU5EIFwiTGV2ZWxcIiA9IDUgQU5EIFwiVHlwZVwiID0gIiArIFJkYVR5cGVWICsgIiBBTkQgXCJWYWx1ZSBGcm9tXCIgPD0gIiArIFRvdFByaWNlViAgKQp9ICAgCmVsc2V7CiAgICBvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMSA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCAib2JqZWN0VHlwZT1cIlJEQUludGVydmFsc1wiIEFORCBvYmplY3QgSEFWSU5HIG91dGJvdW5kUmVmZXJlbmNlcyhvYmplY3RpZCA9ICIgKyBjb21wYW55ICsgIikgQU5EIFwiTGV2ZWxcIiA9IDEgQU5EIFwiVHlwZVwiID0gIiArIFJkYVR5cGVWICsgIiBBTkQgXCJFeHRyYSBCdWRnZXRcIiA9ICIgKyBFeHRyYUJ1ZGdldCArICIgQU5EIFwiVmFsdWUgRnJvbVwiIDw9ICIgKyBUb3RQcmljZVYgICkKICAgIG9iamVjdHNJbnRlcnZhbHNMRnVuY3Rpb24yID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBSW50ZXJ2YWxzXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gIiArIGNvbXBhbnkgKyAiKSBBTkQgXCJMZXZlbFwiID0gMiBBTkQgXCJUeXBlXCIgPSAiICsgUmRhVHlwZVYgKyAiIEFORCBcIkV4dHJhIEJ1ZGdldFwiID0gIiArIEV4dHJhQnVkZ2V0ICsgIiBBTkQgXCJWYWx1ZSBGcm9tXCIgPD0gIiArIFRvdFByaWNlViAgKQoJb2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjMgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFJbnRlcnZhbHNcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIEFORCBcIkxldmVsXCIgPSAzIEFORCBcIlR5cGVcIiA9ICIgKyBSZGFUeXBlViArICIgQU5EIFwiRXh0cmEgQnVkZ2V0XCIgPSAiICsgRXh0cmFCdWRnZXQgKyAiIEFORCBcIlZhbHVlIEZyb21cIiA8PSAiICsgVG90UHJpY2VWICApCiAgICBvYmplY3RzSW50ZXJ2YWxzTDIgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFJbnRlcnZhbHNcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIEFORCBcIkxldmVsXCIgPSA0IEFORCBcIlR5cGVcIiA9ICIgKyBSZGFUeXBlViArICIgQU5EIFwiRXh0cmEgQnVkZ2V0XCIgPSAiICsgRXh0cmFCdWRnZXQgKyAiIEFORCBcIlZhbHVlIEZyb21cIiA8PSAiICsgVG90UHJpY2VWICApCglvYmplY3RzSW50ZXJ2YWxzTDMgPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFJbnRlcnZhbHNcIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIEFORCBcIkxldmVsXCIgPSA1IEFORCBcIlR5cGVcIiA9ICIgKyBSZGFUeXBlViArICIgQU5EIFwiRXh0cmEgQnVkZ2V0XCIgPSAiICsgRXh0cmFCdWRnZXQgKyAiIEFORCBcIlZhbHVlIEZyb21cIiA8PSAiICsgVG90UHJpY2VWICApCn0KbG9nLmRlYnVnIG9iamVjdHNJbnRlcnZhbHNMMwpkZWYgRmxvd1R5cGUgPSAiIgoKLy9kZWNpZG8gbCdhcHByb3ZlciBlIGlsIGZsb3cgdHlwZSwgY29tcG9uZ28gYXBwcm92ZXIKQXBwbGljYXRpb25Vc2VyIGFwcHJVc2VyCmRlZiB2YWx1ZT0iIgpDdXN0b21GaWVsZCBmbG93VHlwZUZpZWxkCmRlZiBhcHByb3ZlclJEQSA9IFtdCmRlZiBkaXNwbGF5TmFtZSA9IFtdCmRlZiBoaWRlMSA9IFtdCgpDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LnNldExvZ2dlZEluVXNlcihDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyTWFuYWdlcigpLmdldFVzZXJCeUtleSgiYXRsYXNzaWFuX2ZhYWNfc2VydmljZV9kZXNrIikpCmRlZiBjdXJyZW50VXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuZ2V0TG9nZ2VkSW5Vc2VyKCk7CgpkZWYgY3JlYUF1dG9TdWJUYXNrID0gZmFsc2UKZGVmIGNyZWFDb250cm9sbGluZ0ZhdHR1cmEgPSBmYWxzZQoKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIlB1cmNoYXNlIGJ5IGNyZWRpdCBjYXJkIil7Ci8vY3JlbyBzdWIgdGFzayBwZXIgQ29udHJvbGxpbmcKICAgIGxvZy5kZWJ1ZyAiZmxvd1R5cGU6ICIgKyBmbG93VHlwZQogICAgYXBwcm92ZXJSREEgPSBbXQogICAgaGlkZTE9W10KICAgIEZsb3dUeXBlPSdDb250cm9sbGluZyBmdW5jdGlvbicKICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2NwogICAgaWYgKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykhPW51bGwpewogICAgICAgIGZvciAob2JqQ29udHIgaW4gb2JqZWN0c0NvbnRyb2xsaW5nKXsKICAgICAgICAgICAgLy9BcHByb3ZlciBpbnNpZ2h0IFJEQUNvbnRyb2xsaW5nIHRlc3QgNDQxNSAtIHByb2QgMjU3OAogICAgICAgICAgICBqcWxTZWFyY2ggPSAicHJvamVjdCA9ICciICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyAiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iakNvbnRyLmdldElkKCksIDI1NzgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgIicgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIiciCiAgICAgICAgICAgIGxvZy5kZWJ1ZyBqcWxTZWFyY2gKICAgICAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaCkKICAgICAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKQogICAgICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApewogICAgICAgICAgICAgICAgY3JlYUF1dG9TdWJUYXNrID0gdHJ1ZQogICAgICAgICAgICAgICAgaGlkZTEuYWRkKCJObyIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGhpZGUxLmFkZCgiU2kiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vQXBwcm92ZXIgaW5zaWdodCBSREFDb250cm9sbGluZyB0ZXN0IDQ0MTUgLSBwcm9kIDI1NzgKICAgICAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmpDb250ci5nZXRJZCgpLCAyNTc4KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKCiAgICAgICAgfQoJCS8vV2FpdGluZyBGb3IgQ29udHJvbGxlcnMgdGVzdCAyMSAtIHByb2QgMTUxCiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTUxKTsKICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICB9CgogICAgICAgIGlmIChjcmVhQXV0b1N1YlRhc2s9PXRydWUpewogICAgICAgICAgICBkZWYgaiA9IDAKICAgICAgICAgICAgIGZvciAoYXBwciBpbiBhcHByb3ZlclJEQSl7CiAgICAgICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwciwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgaGlkZTFbal0sIGlzc3VlKQogICAgICAgICAgICAgICAgaj1qKzEKICAgICAgICAgICAgIH0gICAKICAgICAgICAgICAgZmxvd1R5cGUgPSAiQ29udHJvbGxpbmcgZnVuY3Rpb24iCiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgICAgICB9CiAgICAgfQogICAgIGVsc2V7CiAgICAgICAgIGZsb3dUeXBlID0gIkNvbnRyb2xsaW5nIGZ1bmN0aW9uIgogICAgfSAgICAgICAKfQogCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJDb250cm9sbGluZyBmdW5jdGlvbiIpewogICAgbG9nLmRlYnVnICJmbG93VHlwZTogIiArIGZsb3dUeXBlCiAgICBhcHByb3ZlclJEQSA9IFtdCiAgICAKICAgIC8vc2UgaG8gdW5hIGFwcHJvdmF6aW9uZSB0ZWNuaWNhIGluIGJhc2UgYWwgY2RjIGFsbG9yYSBmYWNjaW8gbCdhcHByb3ZhemlvbmUgdGVjbmljYSBhbHRyaW1lbnQgaXZhZG8gY29uIGlsIHByaW1vIGxpdmVsbG8KICAgIGlmIChvYmplY3RzVGVjbi5zaXplKCk+MCl7CiAgICAgICAgRmxvd1R5cGU9J1RlY2huaWNhbCBBcHByb3ZhbCcKICAgICAgICAvL0FwcHJvdmVyIHNjaGVtYSBSREFUZWNobmljYWxBcHByb3ZhbCB0ZXN0IDQ0MTYgLSBwcm9kIDI1NzMKICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNUZWNuWzBdLmdldElkKCksIDI1NzMpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKQogICAgICAgIGpxbFNlYXJjaCA9ICJwcm9qZWN0ID0gJyIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArICInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCBIaWRlIGlzIEVNUFRZIEFORCAnQXBwcm92ZXIgUkRBJyA9ICciICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c1RlY25bMF0uZ2V0SWQoKSwgMjU3MykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyAiJyBBTkQgcGFyZW50ID0gJyIgKyBwYXJlbnRJc3N1ZS5rZXkgKyAiJyIKICAgICAgICAKICAgICAgICBxdWVyeSA9IGpxbFF1ZXJ5UGFyc2VyLnBhcnNlUXVlcnkoanFsU2VhcmNoKQogICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICAKCQlpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApewogICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsICJObyIsIGlzc3VlKQogICAgICAgICAgICBmbG93VHlwZSA9ICJUZWNobmljYWwgQXBwcm92YWwiCiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgICAgICB9CiAgICAgICAgLy9XYWl0aW5nIGZvciB0ZWNobmljYWwgYXBwcm92YWwgdGVzdCAxOTEgLSBwcm9kIDcxCiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oNzEpOyAKICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBpZiAob2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjEuc2l6ZSgpPjApewogICAgICAgICAgICAvL2NyZW8gc3ViIHRhc2sgcGVyIENvbnRyb2xsaW5nCiAgICAgICAgICAgIEZsb3dUeXBlPSdGaXJzdCBMZXZlbCBBcHByb3ZhbCcKICAgICAgICAgICAgLy9BcHByb3ZlciBzY2hlbWEgUkRBRnVuY3Rpb24gdGVzdCA0NDE3IC0gcHJvZCAyNTY4CiAgICAgICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKQoKICAgICAgICAgICAganFsU2VhcmNoID0gInByb2plY3QgPSAnIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnICBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCBIaWRlIGlzIEVNUFRZIEFORCAnQXBwcm92ZXIgUkRBJyA9ICciICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgIicgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIiciCiAgICAgICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKCiAgICAgICAgICAgIGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7ICAgCiAgICAgICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsICJObyIsIGlzc3VlKQogICAgICAgICAgICAgICAgZmxvd1R5cGUgPSAiRmlyc3QgTGV2ZWwgQXBwcm92YWwiCiAgICAgICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9XaWF0aW5nIEZvciBGaXJzdCBMZXZlbCAgdGVzdCA0MSAtIHByb2QgNjEKICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oNjEpOyAKICAgICAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkgewogICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIGZsb3dUeXBlID0gIkZpcnN0IExldmVsIEFwcHJvdmFsIgogICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdCiAgICAgICAgfSAgCiAgICB9Cn0KCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJUZWNobmljYWwgQXBwcm92YWwiKXsKICAgIGlmIChvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMS5zaXplKCk+MCl7CiAgICAgICAgbG9nLmRlYnVnICJmbG93VHlwZTogIiArIGZsb3dUeXBlCiAgICAgICAgYXBwcm92ZXJSREEgPSBbXQoKICAgICAgICAvL3NlIGhvIHVuYSBhcHByb3ZhemlvbmUgdGVjbmljYSB2YWRvIGNvbiBpbCBwcmltbyBsaXZlbGxvCiAgICAgICAgRmxvd1R5cGU9J0ZpcnN0IExldmVsIEFwcHJvdmFsJyAKICAgICAgICAvL0FwcHJvdmVyIHNjaGVtYSBSREFGdW5jdGlvbiB0ZXN0IDQ0MTcgLSBwcm9kIDI1NjgKICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY4KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKICAgICAgICBqcWxTZWFyY2ggPSAicHJvamVjdCA9ICciICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyAiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY4KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArICInIEFORCBwYXJlbnQgPSAnIiArIHBhcmVudElzc3VlLmtleSArICInIgoKICAgICAgICBxdWVyeSA9IGpxbFF1ZXJ5UGFyc2VyLnBhcnNlUXVlcnkoanFsU2VhcmNoKQogICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApewogICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsICJObyIsIGlzc3VlKQogICAgICAgICAgICBmbG93VHlwZSA9ICJGaXJzdCBMZXZlbCBBcHByb3ZhbCIKICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgICAgIH0KICAgICAgICAvL1RyYW5zYXppb25lIFdhaXRpbmcgRm9yIFNlY29uZCBMZXZlbCAgdGVzdCA0MSAtIHByb2QgNjEKICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbig2MSk7IAogICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgIH0KICAgICB9CiAgICBlbHNlewogICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgICAgICBmbG93VHlwZSA9ICJGaXJzdCBMZXZlbCBBcHByb3ZhbCIKICAgIH0KfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJGaXJzdCBMZXZlbCBBcHByb3ZhbCIpewogICAgbG9nLmRlYnVnICJmbG93VHlwZTogIiArIGZsb3dUeXBlCiAgICBhcHByb3ZlclJEQSA9IFtdCgkKICAgIC8vc2UgaG8gdW5hIGFwcHJvdmF6aW9uZSBmdW56aW9uZSBzZWNvbmRvIGxpdmVsbG8gCiAgICAvL0FwcHJvdmVyIFNlY29uZCBMZXZlbCBzY2hlbWEgUkRBRnVuY3Rpb24gdGVzdCA0NDQyIC0gcHJvZCAzNDA5CiAgICBpZiAob2JqZWN0c0ludGVydmFsc0xGdW5jdGlvbjIuc2l6ZSgpPjAgJiYgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAzNDA5KSAhPSBudWxsKXsKICAgICAgICBGbG93VHlwZT0nU2Vjb25kIExldmVsIEFwcHJvdmFsJwogICAgICAgIC8vQXBwcm92ZXIgU2Vjb25kIExldmVsIHNjaGVtYSBSREFGdW5jdGlvbiB0ZXN0IDQ0NDIgLSBwcm9kIDM0MDkKICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAzNDA5KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKICAgICAgICBqcWxTZWFyY2ggPSAicHJvamVjdCA9ICciICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyAiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAzNDA5KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArICInIEFORCBwYXJlbnQgPSAnIiArIHBhcmVudElzc3VlLmtleSArICInIgogICAgICAgIAogICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKQogICAgICAgIAoJCWlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7CiAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByb3ZlclJEQVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgIk5vIiwgaXNzdWUpCiAgICAgICAgICAgIGZsb3dUeXBlID0gIlNlY29uZCBMZXZlbCBBcHByb3ZhbCIKICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgICAgIH0KICAgICAgICAvL1RyYW5zYXppb25lIFdhaXRpbmcgRm9yIFNlY29uZCBMZXZlbCAgdGVzdCAyMDEgLSBwcm9kIDgxIAogICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDgxKTsgCiAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkgewogICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7CiAgICAgICAgfQogICAgfQogICAgZWxzZXsKICAgICAgICBmbG93VHlwZSA9ICJTZWNvbmQgTGV2ZWwgQXBwcm92YWwiCiAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgfSAgCn0KICAgIAppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiU2Vjb25kIExldmVsIEFwcHJvdmFsIil7CiAgICBsb2cuZGVidWcgImZsb3dUeXBlOiAiICsgZmxvd1R5cGUKICAgIGFwcHJvdmVyUkRBID0gW10KICAgCiAgICAvL3NlIGhvIHVuIHRlcnpvIGxpdmVsbG8gdmFkbyBhbCB0ZXJ6byBsaXZlbGxvIGFsdHJpbWVudGkgdmFkbyBhIGxpdmVsbG8gZGkgZ3J1cHBvCiAgICAvL0FwcHJvdmVyIFRoaXJkIExldmVsIHNjaGVtYSBSREFGdW5jdGlvbiB0ZXN0IDQ0NDMgLSBwcm9kIDM0MTAKICAgIGlmIChvYmplY3RzSW50ZXJ2YWxzTEZ1bmN0aW9uMy5zaXplKCk+MCAmJiBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDM0MTApICE9IG51bGwpewogICAgICAgIEZsb3dUeXBlPSdUaGlyZCBMZXZlbCBBcHByb3ZhbCcgCiAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQxMCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpCiAgICAgICAganFsU2VhcmNoID0gInByb2plY3QgPSAnIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJyIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMzQxMCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyAiJyBBTkQgcGFyZW50ID0gJyIgKyBwYXJlbnRJc3N1ZS5rZXkgKyAiJyIKCiAgICAgICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaCkKICAgICAgICBzZWFyY2ggPSBzZWFyY2hTZXJ2aWNlLnNlYXJjaCh1c2VyLCBxdWVyeSwgUGFnZXJGaWx0ZXIuZ2V0VW5saW1pdGVkRmlsdGVyKCkpCiAgICAgICAgbG9nLmRlYnVnICJqcWxTZWFyY2ggIiArIGpxbFNlYXJjaAogICAgICAgIGxvZy5kZWJ1ZyAic2VhcmNoLnJlc3VsdHMgIiArIHNlYXJjaC5yZXN1bHRzCiAgICAgICAgCiAgICAgICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT4wKXsKICAgICAgICAgICAgY3JlYXRlU3ViVGFza0FwcHJvdmVkKGFwcHJvdmVyUkRBWzBdLCBjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEZsb3dUeXBlLCAiTm8iLCBpc3N1ZSkKICAgICAgICAgICAgZmxvd1R5cGUgPSAiVGhpcmQgTGV2ZWwgQXBwcm92YWwiCiAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgICAgICB9CiAgICAgICAgLy9UcmFuc2F6aW9uZSBXYWl0aW5nIEZvciBUaGlyZCBMZXZlbCB0ZXN0IDIxMSAtIHByb2QgOTEgCiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oOTEpOyAKICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlewogICAgICAgIGZsb3dUeXBlID0gIlRoaXJkIExldmVsIEFwcHJvdmFsIgogICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgIH0gIAp9CgppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiVGhpcmQgTGV2ZWwgQXBwcm92YWwiKXsKICAgIGFwcHJvdmVyUkRBID0gW10KCUZsb3dUeXBlPSdHcm91cCBMZXZlbCBBcHByb3ZhbCcKICAgIC8vR3JvdXBBcHByb3ZlcgogICAgaWYgKG9iamVjdHNJbnRlcnZhbHNMMi5zaXplKCk+MCl7CiAgICAgICAgLy9BcHByb3ZlciBUaGlyZCBMZXZlbCBzY2hlbWEgUkRBR3JvdXAgIHRlc3QgNDQxOCAtIHByb2QgMjU2NQogICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0dyb3Vwc1swXS5nZXRJZCgpLCAyNTY1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKCiAgICAgICAgLy8gc2UgYXNzaWduZWUgZGVsIHNlY29uZG8gbGl2ZWxsbyDDqCBkaXZlcnNvIGRhIGFzc2lnbmVlIGRlaSBwcm9tbyBsaXZlbGxvIGFsbG9yYSBtZXR0byBsbyBzdGF0dXMgZGVsIHBhZHJlIGNvbWUgd2FpdGluZyBmb3IgYXBwcm92YWwgMiBsZXZlbCAgYWx0cmltZW50aSBpbXBvc3RvIEZsb3cgPSBzZWNvZG4gbGl2ZWwgZSBwcm9jZWRvIGFsIGlmIHN1Y2Nlc3Npdm8KICAgICAgICAvL2lmIChDb21wb25lbnRBY2Nlc3Nvci5nZXRVc2VyVXRpbCgpLmdldFVzZXJCeU5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNHcm91cHNbMF0uZ2V0SWQoKSwgMzE3MCkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpIT1pc3N1ZS5nZXRBc3NpZ25lZSgpKXsKICAgICAgICBqcWxTZWFyY2ggPSAicHJvamVjdCA9ICciICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyAiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNHcm91cHNbMF0uZ2V0SWQoKSwgMjU2NSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSkgKyAiJyBBTkQgcGFyZW50ID0gJyIgKyBwYXJlbnRJc3N1ZS5rZXkgKyAiJyIKICAgICAgICBxdWVyeSA9IGpxbFF1ZXJ5UGFyc2VyLnBhcnNlUXVlcnkoanFsU2VhcmNoKQogICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPjApewogICAgICAgICAgICBjcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwcm92ZXJSREFbMF0sIGN1cnJlbnRVc2VyLCBwYXJlbnRJc3N1ZSwgRmxvd1R5cGUsICJObyIsIGlzc3VlKQogICAgICAgICAgICBmbG93VHlwZSA9ICJHcm91cCBMZXZlbCBBcHByb3ZhbCIKICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgICAgIH0KICAgICAgICAKICAgICAgICAvL1dhaXRpbmcgRm9yIEdyb3VwIExldmVsIHRlc3QgNjEgLSAgcHJvZCAxMDEKICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMDEpOwogICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKG9iamVjdHNJbnRlcnZhbHNMMy5zaXplKCk+MCkgewogICAgICAgICAgICBmbG93VHlwZSA9ICJHcm91cCBMZXZlbCBBcHByb3ZhbCIKICAgICAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgfSAgCiAgICBlbHNlewogICAgICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2NwogICAgICAgIGlmIChEaWZmSW52b2ljZSA9PSBmYWxzZSB8fCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0Z1bmN0aW9uWzBdLmdldElkKCksIDI1NjcpID09IG51bGwpewogICAgICAgICAgICAvL2NoaXVkbyBpc3N1ZSBhcHByb3ZlZAogICAgICAgICAgICBsb2cuZGVidWcgIkZpcnN0IGxldmVsIC0gYXBwcm92byBpbCBwYWRyZSBwZXJjaMOoIG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lIgogICAgICAgICAgICAvL0FwcHJvdmVkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTEKICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpOwogICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgLy9zZSBzb25vIGZhdHR1cmEgYWxsb3JhIGNvbWUgdWx0aW1vIHN0ZXAgYyfDqCBpbCBjb250cm9sbGluZwogICAgICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZQogICAgICAgIH0gIAogICAgfQp9CgoKbG9nLmRlYnVnIGZsb3dUeXBlCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJHcm91cCBMZXZlbCBBcHByb3ZhbCIpewogICAgbG9nLmRlYnVnICJmbG93VHlwZTogIiArIGZsb3dUeXBlCiAgICBhcHByb3ZlclJEQSA9IFtdCiAgICBoaWRlMSA9IFtdCiAgICAKCWlmIChvYmplY3RzSW50ZXJ2YWxzTDMuc2l6ZSgpPjApewogICAgICAgIGRlZiBvYmplY3RzQ0VPID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBQ0VPXCIgQU5EIG9iamVjdCBIQVZJTkcgb3V0Ym91bmRSZWZlcmVuY2VzKG9iamVjdGlkID0gIiArIGNvbXBhbnkgKyAiKSIpCiAgICAgICAgZGVmIG9iamVjdHNDRk8gPSBpcWxGYWNhZGUuZmluZE9iamVjdHNCeUlRTEFuZFNjaGVtYSgyNywgIm9iamVjdFR5cGU9XCJSREFDRk9cIiBBTkQgb2JqZWN0IEhBVklORyBvdXRib3VuZFJlZmVyZW5jZXMob2JqZWN0aWQgPSAiICsgY29tcGFueSArICIpIikKICAgICAgICAKICAgICAgICAvL0NFTytDRk8gc2NoZW1hIFJEQUludGVydmFscyB0ZXN0IDMxNjkgLSAgcHJvZCAzNDA3CiAgICAgICAgaWYgKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzSW50ZXJ2YWxzTDNbMF0uZ2V0SWQoKSwgMzQwNykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkudG9TdHJpbmcoKSA9PSJ0cnVlIil7CiAgICAgICAgLy8gc2UgaWwgZmxhZyBDRk8gw6ggdHJ1ZSBhbGxvcmEgY3JlbyAyIHN1YiBzdWIgdGFzayB1bm8gcGVyIENGTyBlIHVubyBwZXIgQ0VPIHBlcmNow6ggaGFubm8gZmlybWEgY29uZ2l1bnRhLCBhbHRyaW1lbnRpIGNyZW8gc29sbyBxdWVsbG8gcGVyIENFTwogICAgICAgICAgICBGbG93VHlwZSA9ICdDRU8rQ0ZPJwogICAgICAgICAgICAvL0FwcHJvdmVyICBzY2hlbWEgUkRBQ0ZPIHRlc3QgNDQxMiAtICBwcm9kIDI1ODMKICAgICAgICAgICAganFsU2VhcmNoID0gInByb2plY3QgPSAnIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJyIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQ0ZPWzBdLmdldElkKCksIDI1ODMpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgIicgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIiciCiAgICAgICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk9PTApewogICAgICAgICAgICAgICAgYXBwcm92ZXJSREEuYWRkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQ0ZPWzBdLmdldElkKCksIDI1ODMpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgY3JlYXRlU3ViVGFza0FwcHJvdmVkKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQ0ZPWzBdLmdldElkKCksIDI1ODMpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLCBjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEZsb3dUeXBlLCAiTm8iLCBpc3N1ZSkKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy9BcHByb3ZlciBzY2hlbWEgUkRBQ0VPIHRlc3QgNDQxNCAtICBwcm9kIDI1ODUKICAgICAgICAgICAganFsU2VhcmNoID0gInByb2plY3QgPSAnIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCBTdGF0dXMgIT0gJ09MRCBGTE9XJyAgQU5EIFN0YXR1cyAhPSAnREVMRVRFRCcgQU5EIEhpZGUgaXMgRU1QVFkgQU5EICdBcHByb3ZlciBSREEnID0gJyIgKyByZXR1cm5BcHByb3ZlclVzZXJuYW1lKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQ0VPWzBdLmdldElkKCksIDI1ODUpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgIicgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIiciCiAgICAgICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICAgICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT09MCl7CiAgICAgICAgICAgICAgIAlhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNDRU9bMF0uZ2V0SWQoKSwgMjU4NSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgIk5vIiwgaXNzdWUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoYXBwcm92ZXJSREEuc2l6ZSgpPjApewogICAgICAgICAgICAgICAgbG9nLmRlYnVnICJDRU8rQ0ZPIC0gaW1wb3N0byBpbCBwYWRyZSBpbiB3YWl0aW5nIENFTytDRk8iCiAgICAgICAgICAgICAgICAvL1dhaXRpbmcgRm9yIEdlbmVyYWwgTWFuYWdlciAmIENGTyB0ZXN0IDE1MSAtICBwcm9kIDEyMQogICAgICAgICAgICAJd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTIxKTsKICAgICAgICAgICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgCX0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGFwcHJvdmVyUkRBID0gW10KICAgICAgICAgICAgICAgIC8vY3JlYXRlU3ViVGFza0FwcHJvdmVkKGFwcHJvdmVyUkRBWzBdLCBkaXNwbGF5TmFtZVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSkKICAgICAgICAgICAgICAgIC8vR3JvdXAgQ29udHJvbGxpZyBpbnNpZ2h0IFJEQUZ1bmN0aW9uIHRlc3QgMzE3NSAtIHByb2QgMjU2NwogICAgICAgICAgICAgICAgaWYgKERpZmZJbnZvaWNlID09IGZhbHNlIHx8IG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykgPT0gbnVsbCl7CiAgICAgICAgICAgICAgICAgICAgbG9nLmRlYnVnICJDRU8rQ0ZPIC0gY3JlbyBzdWJ0YXNrIGF1dG9hcHByb3ZhdGkgZSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNow6ggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBkaSBhcHByb3ZhemlvbmUiCiAgICAgICAgICAgICAgICAgICAgLy9BcHByb3ZlcmQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMQogICAgICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTsKICAgICAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGNyZWFDb250cm9sbGluZ0ZhdHR1cmEgPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgCX0KCQl9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEZsb3dUeXBlPSdHZW5lcmFsIE1hbmFnZXInCiAgICAgICAgICAgIC8vQXBwcm92ZXIgc2NoZW1hIFJEQUNFTyB0ZXN0IDQ0MTQgLSAgcHJvZCAyNTg1CiAgICAgICAgICAgIGFwcHJvdmVyUkRBLmFkZChvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGpxbFNlYXJjaCA9ICJwcm9qZWN0ID0gJyIgKyBpc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkubmFtZSArICInIEFORCBpc3N1ZXR5cGUgPSAnQXBwcm92YWwgUkRBJyBBTkQgU3RhdHVzICE9ICdPTEQgRkxPVycgIEFORCBTdGF0dXMgIT0gJ0RFTEVURUQnIEFORCBIaWRlIGlzIEVNUFRZIEFORCAnQXBwcm92ZXIgUkRBJyA9ICciICsgcmV0dXJuQXBwcm92ZXJVc2VybmFtZShvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0NFT1swXS5nZXRJZCgpLCAyNTg1KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKS50b1N0cmluZygpKSArICInIEFORCBwYXJlbnQgPSAnIiArIHBhcmVudElzc3VlLmtleSArICInIgogICAgICAgICAgICBsb2cuZGVidWcganFsU2VhcmNoCiAgICAgICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKICAgICAgICAgICAgaWYgKHNlYXJjaC5yZXN1bHRzLnNpemUoKT4wKXsKICAgICAgICAgICAgICAgIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChhcHByb3ZlclJEQVswXSwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgIk5vIiwgaXNzdWUpCiAgICAgICAgICAgICAgICBhcHByb3ZlclJEQSA9IFtdCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZyAiR2VuZXJhbCBNYW5hZ2VyIC0gY3JlbyBzdWJ0YXNrIGF1dG9hcHByb3ZhdG8gZSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNow6ggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBkaSBhcHByb3ZhemlvbmUiCiAgICAgICAgCQlpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgICAgIC8vQXBwcm92ZWQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMQogICAgICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTsKICAgICAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGNyZWFDb250cm9sbGluZ0ZhdHR1cmEgPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgCX0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIC8vV2FpdGluZyBGb3IgR2VuZXJhbCBNYW5hZ2VyIHRlc3QgMTQxIC0gcHJvZCAxMTEKICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExMSk7CiAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgICAgICAgICAgfQogICAgICAgIAl9CiAgICAJfQogICAgfQogICAgZWxzZXsKICAgICAgICBsb2cuZGVidWcgIkdyb3VwIGxldmVsIC0gYXBwcm92byBpbCBwYWRyZSBwZXJjaMOoIG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lIgogICAgICAgICAvL0dyb3VwIENvbnRyb2xsaWcgaW5zaWdodCBSREFGdW5jdGlvbiB0ZXN0IDMxNzUgLSBwcm9kIDI1NjcKICAgICAgICBpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UgfHwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSA9PSBudWxsKXsKICAgICAgICAgICAgLy9BcHByb3ZlZCBSREEgdGVzdCAxMDEgLSBwcm9kIDExCiAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDExKTsKICAgICAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkgewogICAgICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIGNyZWFDb250cm9sbGluZ0ZhdHR1cmEgPSB0cnVlCiAgICAgICAgfQogICAgfQp9CgovL2Rldm8gdmVyaWZpY2FyZSBjaGUgZW50cmFtYmkgQ0VPIGUgQ0ZPIGFiYmlhbW8gYXBwcm92YXRvIHByaW1hIGRpIGFwcHJvdmFyZSBsYSBpc3N1ZSwgZGV2byBjaGl1ZGUgYXBwcm92YXppb25lIHF1YW5kbyBlbnRyYW1iaSBzb25vIGFwcHJvdmF0aSAKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIkNFTytDRk8iKXsKICAgIGxvZy5kZWJ1ZyAiZmxvd1R5cGU6ICIgKyBmbG93VHlwZQogICAganFsU2VhcmNoID0gInByb2plY3QgPSAnIiArIGlzc3VlLmdldFByb2plY3RPYmplY3QoKS5uYW1lICsgIicgQU5EIGlzc3VldHlwZSA9ICdBcHByb3ZhbCBSREEnIEFORCAnRmxvdyBUeXBlJz0nQ0VPK0NGTycgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgSGlkZSBpcyBFTVBUWSBBTkQgcmVzb2x1dGlvbiA9IFVucmVzb2x2ZWQgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIicgQU5EIGtleSAhPSAnIiArIGlzc3VlLmtleSArICInIgogICAgcXVlcnkgPSBqcWxRdWVyeVBhcnNlci5wYXJzZVF1ZXJ5KGpxbFNlYXJjaCkKICAgIHNlYXJjaCA9IHNlYXJjaFNlcnZpY2Uuc2VhcmNoKHVzZXIsIHF1ZXJ5LCBQYWdlckZpbHRlci5nZXRVbmxpbWl0ZWRGaWx0ZXIoKSkKCiAgICBpZiAoc2VhcmNoLnJlc3VsdHMuc2l6ZSgpPT0wKXsKICAgICAgICBsb2cuZGVidWcgIkNFTytDRk8gLSBhcHByb3ZvIGlsIHBhZHJlIHBlcmNow6ggbm9uIGNpIHNvbm8gYWx0cmkgc3RlcCBkaSBhcHByb3ZhemlvbmUiCiAgICAgICAgLy9Hcm91cCBDb250cm9sbGlnIGluc2lnaHQgUkRBRnVuY3Rpb24gdGVzdCAzMTc1IC0gcHJvZCAyNTY3CgkJaWYgKERpZmZJbnZvaWNlID09IGZhbHNlIHx8IG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzRnVuY3Rpb25bMF0uZ2V0SWQoKSwgMjU2NykgPT0gbnVsbCl7CiAgICAgICAgICAgIC8vQXBwcm92ZWQgUkRBIHRlc3QgMTAxIC0gcHJvZCAxMQogICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMSk7CiAgICAgICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwucHJvZ3Jlc3MoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZQogICAgICAgIH0KICAgIH0gIAp9CgppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiR2VuZXJhbCBNYW5hZ2VyIil7CiAgICBsb2cuZGVidWcgImZsb3dUeXBlOiAiICsgZmxvd1R5cGUKICAgIGxvZy5kZWJ1ZyAiR2VuZXJhbCBtYW5hZ2VyIC0gYXBwcm92byBpbCBwYWRyZSBwZXJjaMOoIG5vbiBjaSBzb25vIGFsdHJpIHN0ZXAgZGkgYXBwcm92YXppb25lIgogICAgLy9Hcm91cCBDb250cm9sbGlnIGluc2lnaHQgUkRBRnVuY3Rpb24gdGVzdCAzMTc1IC0gcHJvZCAyNTY3CiAgICBpZiAoRGlmZkludm9pY2UgPT0gZmFsc2UgfHwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNGdW5jdGlvblswXS5nZXRJZCgpLCAyNTY3KSA9PSBudWxsKXsKICAgICAgICAvL0FwcHJvdmVkIFJEQSB0ZXN0IDEwMSAtIHByb2QgMTEKICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigxMSk7CiAgICAgICAgaWYgKHdvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKSkgewogICAgICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7CiAgICAgICAgfQogICAgfQogICAgZWxzZXsKICAgICAgICBjcmVhQ29udHJvbGxpbmdGYXR0dXJhID0gdHJ1ZQogICAgfQp9Cgpsb2cuZGVidWcgImFwcHJvdmVyUkRBICIrIGFwcHJvdmVyUkRBCmxvZy5kZWJ1ZyAiZGlzcGxheU5hbWUgIiArIGRpc3BsYXlOYW1lCmRlZiBpID0gMAoKLy9jcmVvIHVsdGltbyBzdGVwIGRlbCBjb250cm9sbGluZyBwZXIgbGUgZmF0dHVyZQppZiAoY3JlYUNvbnRyb2xsaW5nRmF0dHVyYSA9PSB0cnVlKXsKCWxvZy5kZWJ1ZyAiZmxvd1R5cGU6ICIgKyBmbG93VHlwZQogICAgYXBwcm92ZXJSREEgPSBbXQogICAgaGlkZTE9W10KICAgIEZsb3dUeXBlPSdDb250cm9sbGluZyBmdW5jdGlvbicKICAgIAogICAgZm9yIChvYmpDb250ciBpbiBvYmplY3RzQ29udHJvbGxpbmcpewogICAgICAgIC8vQXBwcm92ZXIgaW5zaWdodCBSREFDb250cm9sbGluZyB0ZXN0IDQ0MTUgLSBwcm9kIDI1NzgKICAgICAgICBqcWxTZWFyY2ggPSAicHJvamVjdCA9ICciICsgaXNzdWUuZ2V0UHJvamVjdE9iamVjdCgpLm5hbWUgKyAiJyBBTkQgaXNzdWV0eXBlID0gJ0FwcHJvdmFsIFJEQScgQU5EIFN0YXR1cyAhPSAnT0xEIEZMT1cnICBBTkQgU3RhdHVzICE9ICdERUxFVEVEJyBBTkQgJ0FwcHJvdmVyIFJEQScgPSAnIiArIHJldHVybkFwcHJvdmVyVXNlcm5hbWUob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iakNvbnRyLmdldElkKCksIDI1NzgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpLnRvU3RyaW5nKCkpICsgIicgQU5EIHBhcmVudCA9ICciICsgcGFyZW50SXNzdWUua2V5ICsgIiciCiAgICAgICAgbG9nLmRlYnVnIGpxbFNlYXJjaAogICAgICAgIHF1ZXJ5ID0ganFsUXVlcnlQYXJzZXIucGFyc2VRdWVyeShqcWxTZWFyY2gpCiAgICAgICAgc2VhcmNoID0gc2VhcmNoU2VydmljZS5zZWFyY2godXNlciwgcXVlcnksIFBhZ2VyRmlsdGVyLmdldFVubGltaXRlZEZpbHRlcigpKQoJCWlmIChzZWFyY2gucmVzdWx0cy5zaXplKCk+MCl7CiAgICAgICAgCWNyZWFBdXRvU3ViVGFzayA9IHRydWUKICAgICAgICAJaGlkZTEuYWRkKCJObyIpCiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIGhpZGUxLmFkZCgiU2kiKQogICAgICAgIH0KICAgICAgICBhcHByb3ZlclJEQS5hZGQob2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iakNvbnRyLmdldElkKCksIDI1NzgpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKQogICAgfQogICAgLy9UbyBXYWl0aW5nIEZvciBDb250cm9sbGVycyB0ZXN0IDE3MSAtIHByb2QgNTEKICAgIHdvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0QWN0aW9uKDUxKTsKICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnByb2dyZXNzKCk7CiAgICB9CgogICAgaWYgKGNyZWFBdXRvU3ViVGFzaz09dHJ1ZSl7CiAgICAgICAgZGVmIGogPSAwCiAgICAgICAgIGZvciAoYXBwciBpbiBhcHByb3ZlclJEQSl7CiAgICAgICAgIAljcmVhdGVTdWJUYXNrQXBwcm92ZWQoYXBwciwgY3VycmVudFVzZXIsIHBhcmVudElzc3VlLCBGbG93VHlwZSwgaGlkZTFbal0sIGlzc3VlKQogICAgICAgICAgICBqPWorMQogICAgICAgICB9ICAgCiAgICAgICAgZmxvd1R5cGUgPSAiQ29udHJvbGxpbmcgZnVuY3Rpb24iCiAgICAgICAgYXBwcm92ZXJSREEgPSBbXQogICAgICAgIC8vc2UgaG8gYXV0b3Rhc2sgYWxsb3JhIGRldm8gY2hpdWRlcmUgbGEgaXNzdWUgcGFkcmUgcGVyY2jDqCBub24gY2kgc29ubyBhbHRyaSBzdGVwIGFwcHJvdmF0aXZpCiAgICAgICAgLy9BcHByb3ZlciBSREEgdGVzdCAxMDEgLSBwcm9kIDExCiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMTEpOwogICAgICAgIGlmICh3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgICAgIH0KICAgIH0KfQoKLy9jcmVvIHN1YnRhc2sgcGVyIGFwcHJvdmVyIGNvbXBvc3RpIGluIHByZWNlZGVuemEKZm9yIChvYmogaW4gYXBwcm92ZXJSREEpewkKICAgIE11dGFibGVJc3N1ZSBuZXdTdWJUYXNrID0gaXNzdWVGYWN0b3J5LmdldElzc3VlKCkKICAgIC8vbmV3U3ViVGFzay5zZXRBc3NpZ25lZShhcHByVXNlcikKICAgIG5ld1N1YlRhc2suc2V0UmVwb3J0ZXIoY3VycmVudFVzZXIpCiAgICAvL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAyMjcxOQogICAgZmxvd1R5cGVGaWVsZCA9IGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3MTkiKSkKICAgCQogICAgZGVmIGNmQ29uZmlnID0gZmxvd1R5cGVGaWVsZC5nZXRSZWxldmFudENvbmZpZyhwYXJlbnRJc3N1ZSkKICAgIHZhbHVlID0gQ29tcG9uZW50QWNjZXNzb3Iub3B0aW9uc01hbmFnZXIuZ2V0T3B0aW9ucyhjZkNvbmZpZyk/LmZpbmQgeyBpdC50b1N0cmluZygpID09IEZsb3dUeXBlIH0KICAgIG5ld1N1YlRhc2suc2V0Q3VzdG9tRmllbGRWYWx1ZShmbG93VHlwZUZpZWxkLCB2YWx1ZSkKICAgIAogICAgZGVmIGFwcHIgPSAiXCIiICsgb2JqICsgIlwiIgoJZGVmIG9iamVjdHNBcHByb3ZlciA9IGlxbEZhY2FkZS5maW5kT2JqZWN0c0J5SVFMQW5kU2NoZW1hKDI3LCAib2JqZWN0VHlwZT1cIlJEQUFwcHJvdmVyXCIgQU5EIG9iamVjdGlkID0gIiArIGFwcHIpCiAgIAoJaWYgKG9iamVjdHNBcHByb3Zlci5zaXplKCk+MCl7CiAgICAgICAgLy9BcHByb3ZlciBSREEgdGVzdCAyMzUwNCAtIHByb2QgMjI3MjEKICAgICAgICAvL05hbWUgc2NoZW1hIFJEQUFwcHJvdmVyIHRlc3QgNDQwNyAtIHByb2QgIDI1NTQKICAgICAgICBuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjcyMSIpKSwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNBcHByb3ZlclswXS5nZXRJZCgpLCAyNTU0KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkgICAKICAgICAgICAvL0Rpc3BsYXkgTmFtZSB0ZXN0IDIzNTA1IC0gcHJvZCAyMjcyMgogICAgICAgIC8vRGlzcGxheSBOYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MTAgLSBwcm9kIDI1ODYKICAgICAgICBuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjcyMiIpKSwgb2JqZWN0RmFjYWRlLmxvYWRPYmplY3RBdHRyaWJ1dGVCZWFuKG9iamVjdHNBcHByb3ZlclswXS5nZXRJZCgpLCAyNTg2KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKSkKICAgICAgICAvL0FwcHJvdmVyIEVtYWlsIHRlc3QgMjM1MTIgLSBwcm9kIDIyNzIzCiAgICAgICAgLy9FbWFpbCBzY2hlbWEgUkRBQXBwcm92ZXIgdGVzdCA0NDExIC0gcHJvZCAyNTg3CiAgICAgICAgaWYgKG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU4NykgIT0gbnVsbCkKICAgICAgICAJbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjI3MjMiKSksIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgMjU4NykuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpCiAgICAgICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0CiAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KEZsb3dUeXBlICsgIiAtICIgKyBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpICsgIiAtICIgKyBwYXJlbnRJc3N1ZS5nZXRTdW1tYXJ5KCkpCiAgICB9CiAgICBlbHNlewogICAgICAgICBuZXdTdWJUYXNrLnNldFN1bW1hcnkoRmxvd1R5cGUgKyAiIC0gIiArIHBhcmVudElzc3VlLmdldFN1bW1hcnkoKSkKCX0KICAgICAKICAgIG5ld1N1YlRhc2suc2V0UGFyZW50T2JqZWN0KHBhcmVudElzc3VlKQogICAgbmV3U3ViVGFzay5zZXRQcm9qZWN0T2JqZWN0KHBhcmVudElzc3VlLmdldFByb2plY3RPYmplY3QoKSkKICAgIAogICAgbmV3U3ViVGFzay5zZXRJc3N1ZVR5cGVJZChjb25zdGFudE1hbmFnZXIuZ2V0QWxsSXNzdWVUeXBlT2JqZWN0cygpLmZpbmR7CiAgICAgICAgaXQuZ2V0TmFtZSgpID09ICJBcHByb3ZhbCBSREEiCiAgICB9LmlkKQoKICAgIGRlZiBuZXdJc3N1ZVBhcmFtcyA9IFsiaXNzdWUiIDogbmV3U3ViVGFza10gYXMgTWFwPFN0cmluZyxPYmplY3Q+CgogICAgaXNzdWVNYW5hZ2VyLmNyZWF0ZUlzc3VlT2JqZWN0KGN1cnJlbnRVc2VyLCBuZXdJc3N1ZVBhcmFtcykKICAgIHN1YlRhc2tNYW5hZ2VyLmNyZWF0ZVN1YlRhc2tJc3N1ZUxpbmsocGFyZW50SXNzdWUsIG5ld1N1YlRhc2ssIGN1cnJlbnRVc2VyKQoKICAgIGlzc3VlSW5kZXhpbmdTZXJ2aWNlLnJlSW5kZXgobmV3U3ViVGFzaykKICAgIHBhcmVudElzc3VlLnNldEN1c3RvbUZpZWxkVmFsdWUoZmxvd1R5cGVGaWVsZCwgdmFsdWUpCiAgICBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKS51cGRhdGVJc3N1ZSh1c2VyLCBwYXJlbnRJc3N1ZSwgRXZlbnREaXNwYXRjaE9wdGlvbi5ET19OT1RfRElTUEFUQ0gsIGZhbHNlKTsKICAgIGlzc3VlSW5kZXhpbmdTZXJ2aWNlLnJlSW5kZXgocGFyZW50SXNzdWUpCiAgICBpID0gaSArIDEKfQoKZGVmIGNyZWF0ZVN1YlRhc2tBcHByb3ZlZChJbnRlZ2VyIGFwcHJvdmVyLCBBcHBsaWNhdGlvblVzZXIgY3VycmVudFVzZXIsIE11dGFibGVJc3N1ZSBwYXJlbnRJc3N1ZSwgU3RyaW5nIEZsb3dUeXBlLCBTdHJpbmcgaGlkZSwgTXV0YWJsZUlzc3VlIGN1cnJJc3N1ZSkgeyAKICAgIFVzZXJVdGlsIAkJCXVzZXJVdGlsIAkJCT0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlclV0aWwoKQogICAgSXNzdWVNYW5hZ2VyIAkJaXNzdWVNYW5hZ2VyIAkJPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKQogICAgSXNzdWVJbmRleGluZ1NlcnZpY2UgaXNzdWVJbmRleGluZ1NlcnZpY2UgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb21wb25lbnQoSXNzdWVJbmRleGluZ1NlcnZpY2UpCiAgICAKICAgIFN1YlRhc2tNYW5hZ2VyIHN1YlRhc2tNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0U3ViVGFza01hbmFnZXIoKTsKICAgIEN1c3RvbUZpZWxkTWFuYWdlciAJY3VzdG9tRmllbGRNYW5hZ2VyIAk9IENvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpCiAgICBkZWYgaXNzdWVGYWN0b3J5ID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVGYWN0b3J5KCkKICAgIGRlZiBjb25zdGFudE1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb25zdGFudHNNYW5hZ2VyKCkKCQogICAgLyogR2V0IEluc2lnaHQgSVFMIEZhY2FkZSBmcm9tIHBsdWdpbiBhY2Nlc3NvciAqLwogICAgQ2xhc3MgaXFsRmFjYWRlQ2xhc3MgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRQbHVnaW5BY2Nlc3NvcigpLmdldENsYXNzTG9hZGVyKCkuZmluZENsYXNzKCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5JUUxGYWNhZGUiKTsgCiAgICBkZWYgaXFsRmFjYWRlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0T1NHaUNvbXBvbmVudEluc3RhbmNlT2ZUeXBlKGlxbEZhY2FkZUNsYXNzKTsKICAgIC8qIEdldCBJbnNpZ2h0IE9iamVjdCBGYWNhZGUgZnJvbSBwbHVnaW4gYWNjZXNzb3IgKi8KICAgIENsYXNzIG9iamVjdEZhY2FkZUNsYXNzID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0UGx1Z2luQWNjZXNzb3IoKS5nZXRDbGFzc0xvYWRlcigpLmZpbmRDbGFzcygiY29tLnJpYWRhbGFicy5qaXJhLnBsdWdpbnMuaW5zaWdodC5jaGFubmVsLmV4dGVybmFsLmFwaS5mYWNhZGUuT2JqZWN0RmFjYWRlIik7CiAgICBkZWYgb2JqZWN0RmFjYWRlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0T1NHaUNvbXBvbmVudEluc3RhbmNlT2ZUeXBlKG9iamVjdEZhY2FkZUNsYXNzKTsKICAgIAogICAgTXV0YWJsZUlzc3VlIG5ld1N1YlRhc2sgPSBpc3N1ZUZhY3RvcnkuZ2V0SXNzdWUoKQoKICAgIG5ld1N1YlRhc2suc2V0UmVwb3J0ZXIoY3VycmVudFVzZXIpCiAgICAvL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAyMjcxOQogICAgZGVmIGZsb3dUeXBlRmllbGQgPSBjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoIjIyNzE5IikpCgogICAgZGVmIGNmQ29uZmlnID0gZmxvd1R5cGVGaWVsZC5nZXRSZWxldmFudENvbmZpZyhwYXJlbnRJc3N1ZSkKICAgIGRlZiB2YWx1ZSA9IENvbXBvbmVudEFjY2Vzc29yLm9wdGlvbnNNYW5hZ2VyLmdldE9wdGlvbnMoY2ZDb25maWcpPy5maW5kIHsgaXQudG9TdHJpbmcoKSA9PSBGbG93VHlwZSB9CiAgICBuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoZmxvd1R5cGVGaWVsZCwgdmFsdWUpCiAgICAKICAgIC8vc2Fsdm8gZGlzcGxheW5hbWUgZSBhcHByb3ZlciBSREEKICAgIAogICAgZGVmIGFwcHIgPSAiXCIiICsgYXBwcm92ZXIgKyAiXCIiCglkZWYgb2JqZWN0c0FwcHJvdmVyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBQXBwcm92ZXJcIiBBTkQgb2JqZWN0aWQgPSAiICsgYXBwcikKICAgCglpZiAob2JqZWN0c0FwcHJvdmVyLnNpemUoKT4wKXsKICAgICAgICAvL0FwcHJvdmVyIFJEQSB0ZXN0IDIzNTA0IC0gcHJvZCAyMjcyMQogICAgICAgIC8vTmFtZSBzY2hlbWEgUkRBQXBwcm92ZXIgdGVzdCA0NDA3IC0gcHJvZCAgMjU1NAogICAgCW5ld1N1YlRhc2suc2V0Q3VzdG9tRmllbGRWYWx1ZShjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoIjIyNzIxIikpLCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKSAgIAogICAgICAgIC8vRGlzcGxheSBOYW1lIHRlc3QgMjM1MDUgLSBwcm9kIDIyNzIyCiAgICAgICAgLy9EaXNwbGF5IE5hbWUgc2NoZW1hIFJEQUFwcHJvdmVyIHRlc3QgNDQxMCAtIHByb2QgMjU4NgogICAgICAgIG5ld1N1YlRhc2suc2V0Q3VzdG9tRmllbGRWYWx1ZShjdXN0b21GaWVsZE1hbmFnZXIuZ2V0Q3VzdG9tRmllbGRPYmplY3QoTG9uZy5wYXJzZUxvbmcoIjIyNzIyIikpLCBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1ODYpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpKQogICAgICAgIC8vbmV3U3ViVGFzay5zZXRDdXN0b21GaWVsZFZhbHVlKGN1c3RvbUZpZWxkTWFuYWdlci5nZXRDdXN0b21GaWVsZE9iamVjdChMb25nLnBhcnNlTG9uZygiMjM1MTIiKSksIG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RzQXBwcm92ZXJbMF0uZ2V0SWQoKSwgNDQxMSkuZ2V0T2JqZWN0QXR0cmlidXRlVmFsdWVCZWFucygpWzBdLmdldFZhbHVlKCkpCiAgICAgICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0CiAgICAgICAgbmV3U3ViVGFzay5zZXRTdW1tYXJ5KEZsb3dUeXBlICsgIiAtICIgKyBvYmplY3RGYWNhZGUubG9hZE9iamVjdEF0dHJpYnV0ZUJlYW4ob2JqZWN0c0FwcHJvdmVyWzBdLmdldElkKCksIDI1NTQpLmdldE9iamVjdEF0dHJpYnV0ZVZhbHVlQmVhbnMoKVswXS5nZXRWYWx1ZSgpICsgIiAtICIgKyBwYXJlbnRJc3N1ZS5nZXRTdW1tYXJ5KCkpCiAgICB9CiAgICBlbHNlewogICAgICAgICBuZXdTdWJUYXNrLnNldFN1bW1hcnkoRmxvd1R5cGUgKyAiIC0gIiArIHBhcmVudElzc3VlLmdldFN1bW1hcnkoKSkKCX0KCS8vSGlkZSB0ZXN0IDIzMzAwIC0gcHJvZCAyMjcyMAoJaWYgKGhpZGUgPT0gIlNpIikgICAgICAKICAgICAgICBuZXdTdWJUYXNrLnNldEN1c3RvbUZpZWxkVmFsdWUoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjcyMCIpKSwgW0NvbXBvbmVudEFjY2Vzc29yLm9wdGlvbnNNYW5hZ2VyLmdldE9wdGlvbnMoY3VzdG9tRmllbGRNYW5hZ2VyLmdldEN1c3RvbUZpZWxkT2JqZWN0KExvbmcucGFyc2VMb25nKCIyMjcyMCIpKS5nZXRSZWxldmFudENvbmZpZyhjdXJySXNzdWUpKT8uZmluZCB7IGl0LnRvU3RyaW5nKCkgPT0gIlllcyIgfV0pCiAgICAJCiAgICBuZXdTdWJUYXNrLnNldFBhcmVudE9iamVjdChwYXJlbnRJc3N1ZSkKICAgIG5ld1N1YlRhc2suc2V0UHJvamVjdE9iamVjdChwYXJlbnRJc3N1ZS5nZXRQcm9qZWN0T2JqZWN0KCkpCgogICAgbmV3U3ViVGFzay5zZXRJc3N1ZVR5cGVJZChjb25zdGFudE1hbmFnZXIuZ2V0QWxsSXNzdWVUeXBlT2JqZWN0cygpLmZpbmR7CiAgICAgICAgaXQuZ2V0TmFtZSgpID09ICJBcHByb3ZhbCBSREEiCiAgICB9LmlkKQoKICAgIGRlZiBuZXdJc3N1ZVBhcmFtcyA9IFsiaXNzdWUiIDogbmV3U3ViVGFza10gYXMgTWFwPFN0cmluZyxPYmplY3Q+CgogICAgaXNzdWVNYW5hZ2VyLmNyZWF0ZUlzc3VlT2JqZWN0KGN1cnJlbnRVc2VyLCBuZXdJc3N1ZVBhcmFtcykKICAgIHN1YlRhc2tNYW5hZ2VyLmNyZWF0ZVN1YlRhc2tJc3N1ZUxpbmsocGFyZW50SXNzdWUsIG5ld1N1YlRhc2ssIGN1cnJlbnRVc2VyKQoKICAgIGlzc3VlSW5kZXhpbmdTZXJ2aWNlLnJlSW5kZXgobmV3U3ViVGFzaykKICAgIHBhcmVudElzc3VlLnNldEN1c3RvbUZpZWxkVmFsdWUoZmxvd1R5cGVGaWVsZCwgdmFsdWUpCiAgICBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKS51cGRhdGVJc3N1ZShjdXJyZW50VXNlciwgcGFyZW50SXNzdWUsIEV2ZW50RGlzcGF0Y2hPcHRpb24uRE9fTk9UX0RJU1BBVENILCBmYWxzZSk7CiAgICBpc3N1ZUluZGV4aW5nU2VydmljZS5yZUluZGV4KHBhcmVudElzc3VlKQogICAgQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5zZXRMb2dnZWRJblVzZXIoQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlck1hbmFnZXIoKS5nZXRVc2VyQnlLZXkoImF0bGFzc2lhbl9mYWFjX3NlcnZpY2VfZGVzayIpKQogICAgY3VycmVudFVzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LmdldExvZ2dlZEluVXNlcigpOwoJCiAgICBXb3JrZmxvd1RyYW5zaXRpb25VdGlsIHdvcmtmbG93VHJhbnNpdGlvblV0aWwgPSAoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCkgSmlyYVV0aWxzLmxvYWRDb21wb25lbnQoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbEltcGwuY2xhc3MpOwogICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRJc3N1ZShuZXdTdWJUYXNrKTsKCS8vVG9BcHByb3ZlZCB0cmFuc2F6aW9uZSBzdWJ0YXNrIHRlc3QgMzEgLSBwcm9kIDYxCiAgICB3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbig2MSk7CiAgICBpZiAod29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpKSB7CiAgICAgICAgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwogICAgfQkKfQoKZGVmIHJldHVybkFwcHJvdmVyVXNlcm5hbWUoU3RyaW5nIGFwcHJvdmVyKQp7CiAgICAvKiBHZXQgSW5zaWdodCBJUUwgRmFjYWRlIGZyb20gcGx1Z2luIGFjY2Vzc29yICovCiAgICBDbGFzcyBpcWxGYWNhZGVDbGFzcyA9IENvbXBvbmVudEFjY2Vzc29yLmdldFBsdWdpbkFjY2Vzc29yKCkuZ2V0Q2xhc3NMb2FkZXIoKS5maW5kQ2xhc3MoImNvbS5yaWFkYWxhYnMuamlyYS5wbHVnaW5zLmluc2lnaHQuY2hhbm5lbC5leHRlcm5hbC5hcGkuZmFjYWRlLklRTEZhY2FkZSIpOyAKICAgIGRlZiBpcWxGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUoaXFsRmFjYWRlQ2xhc3MpOwogICAgLyogR2V0IEluc2lnaHQgT2JqZWN0IEZhY2FkZSBmcm9tIHBsdWdpbiBhY2Nlc3NvciAqLwogICAgQ2xhc3Mgb2JqZWN0RmFjYWRlQ2xhc3MgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRQbHVnaW5BY2Nlc3NvcigpLmdldENsYXNzTG9hZGVyKCkuZmluZENsYXNzKCJjb20ucmlhZGFsYWJzLmppcmEucGx1Z2lucy5pbnNpZ2h0LmNoYW5uZWwuZXh0ZXJuYWwuYXBpLmZhY2FkZS5PYmplY3RGYWNhZGUiKTsKICAgIGRlZiBvYmplY3RGYWNhZGUgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRPU0dpQ29tcG9uZW50SW5zdGFuY2VPZlR5cGUob2JqZWN0RmFjYWRlQ2xhc3MpOwoKICAgIGFwcHJvdmVyID0gIlwiIiArIGFwcHJvdmVyICsgIlwiIgogICAgZGVmIG9iamVjdEFwcHJvdmVyID0gaXFsRmFjYWRlLmZpbmRPYmplY3RzQnlJUUxBbmRTY2hlbWEoMjcsICJvYmplY3RUeXBlPVwiUkRBQXBwcm92ZXJcIiBBTkQgb2JqZWN0aWQgPSAiICsgYXBwcm92ZXIgKQogICAgLy9OYW1lIHNjaGVtYSBSREFBcHByb3ZlciB0ZXN0IDQ0MDcgLSBwcm9kICAyNTU0CiAgICBkZWYgYXBwcm92ZXJVc2VybmFtZSA9IG9iamVjdEZhY2FkZS5sb2FkT2JqZWN0QXR0cmlidXRlQmVhbihvYmplY3RBcHByb3ZlclswXS5nZXRJZCgpLCAyNTU0KS5nZXRPYmplY3RBdHRyaWJ1dGVWYWx1ZUJlYW5zKClbMF0uZ2V0VmFsdWUoKQoKICAgIHJldHVybiBhcHByb3ZlclVzZXJuYW1lCn0KCg==</arg>
                  <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.CustomScriptFunction</arg>
                  <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
                  <arg name="FIELD_SCRIPT_FILE"></arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
        <action id="21" name="Reject">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="3">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
                <function type="class">
                  <arg name="FIELD_FUNCTION_ID">cc3b764d-4f09-43d6-a12d-4b87670c081d</arg>
                  <arg name="FIELD_NOTES">YCFgU2UgcmlnZXR0byBpbCBzdWJ0YXNrIHJpZ2V0dG8gYW5jaGUgaWwgcGFkcmU=</arg>
                  <arg name="FIELD_SCRIPT_FILE_OR_SCRIPT">YCFgeyJzY3JpcHQiOiJpbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmNvbXBvbmVudC5Db21wb25lbnRBY2Nlc3NvclxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5NdXRhYmxlSXNzdWVcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuSXNzdWVNYW5hZ2VyXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmJjLnVzZXIuc2VhcmNoLlVzZXJTZWFyY2hTZXJ2aWNlXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIuQXBwbGljYXRpb25Vc2VyXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmV2ZW50LnR5cGUuRXZlbnREaXNwYXRjaE9wdGlvblxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5pbmRleC5Jc3N1ZUluZGV4aW5nU2VydmljZVxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5maWVsZHMuQ3VzdG9tRmllbGRcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuQ3VzdG9tRmllbGRNYW5hZ2VyXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLndvcmtmbG93LldvcmtmbG93VHJhbnNpdGlvblV0aWw7XG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLndvcmtmbG93LldvcmtmbG93VHJhbnNpdGlvblV0aWxJbXBsO1xuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS51dGlsLkppcmFVdGlscztcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuSXNzdWU7XG5pbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvZGVjLmJpbmFyeS5CYXNlNjQ7XG5pbXBvcnQgb3JnLmFwYWNoZS5sb2c0ai5DYXRlZ29yeVxuaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS51c2VyLnV0aWwuVXNlck1hbmFnZXJcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuV29ya2Zsb3dUcmFuc2l0aW9uVXRpbDtcbmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuV29ya2Zsb3dUcmFuc2l0aW9uVXRpbEltcGw7XG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLndvcmtmbG93LlRyYW5zaXRpb25PcHRpb25zXG5pbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmJjLmlzc3VlLklzc3VlU2VydmljZVxuXG5kZWYgaXNzdWVGYWN0b3J5ID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0SXNzdWVGYWN0b3J5KClcbmRlZiBjb25zdGFudE1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb25zdGFudHNNYW5hZ2VyKClcbkNvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuc2V0TG9nZ2VkSW5Vc2VyKENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJNYW5hZ2VyKCkuZ2V0VXNlckJ5S2V5KFwiYXRsYXNzaWFuX2ZhYWNfc2VydmljZV9kZXNrXCIpKVxuZGVmIExvZ2dlZEluVXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldEppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQoKS5nZXRMb2dnZWRJblVzZXIoKVxuXG5DdXN0b21GaWVsZE1hbmFnZXIgXHRjdXN0b21GaWVsZE1hbmFnZXIgXHQ9IENvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpXG5cbklzc3VlSW5kZXhpbmdTZXJ2aWNlIGlzc3VlSW5kZXhpbmdTZXJ2aWNlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KElzc3VlSW5kZXhpbmdTZXJ2aWNlKVxuSXNzdWVTZXJ2aWNlIGlzc3VlU2VydmljZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldElzc3VlU2VydmljZSgpXG5UcmFuc2l0aW9uT3B0aW9ucyB0cmFuc2l0aW9uT3B0aW9ucyA9IG5ldyBUcmFuc2l0aW9uT3B0aW9ucy5CdWlsZGVyKCkuc2tpcENvbmRpdGlvbnMoKS5za2lwUGVybWlzc2lvbnMoKS5za2lwVmFsaWRhdG9ycygpLmJ1aWxkKClcblxuLyogR2V0IGlzc3VlIFwiR3JvdXAgQXNzaWduZWVcIiBjdXN0b20gZmllbGQgdmFsdWUgKi9cbklzc3VlTWFuYWdlciBpc3N1ZU1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKVxuXG5NdXRhYmxlSXNzdWUgcGFyZW50SXNzdWUgPSBpc3N1ZS5wYXJlbnRPYmplY3Q7XG5cbkNvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuc2V0TG9nZ2VkSW5Vc2VyKENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJNYW5hZ2VyKCkuZ2V0VXNlckJ5S2V5KFwiYXRsYXNzaWFuX2ZhYWNfc2VydmljZV9kZXNrXCIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5kZWYgY3VycmVudFVzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LmdldExvZ2dlZEluVXNlcigpO1xuXG5Jc3N1ZVNlcnZpY2UuVHJhbnNpdGlvblZhbGlkYXRpb25SZXN1bHQgcmVzdWx0ID0gaXNzdWVTZXJ2aWNlLnZhbGlkYXRlVHJhbnNpdGlvbihjdXJyZW50VXNlciwgcGFyZW50SXNzdWUuZ2V0SWQoKSwzMSwgaXNzdWVTZXJ2aWNlLm5ld0lzc3VlSW5wdXRQYXJhbWV0ZXJzKCksIHRyYW5zaXRpb25PcHRpb25zKVxuaWYgKHJlc3VsdC5pc1ZhbGlkKCkpIHtcbiAgICBpc3N1ZVNlcnZpY2UudHJhbnNpdGlvbihjdXJyZW50VXNlciwgcmVzdWx0KVxufVxuXG5cbi8qXG5Xb3JrZmxvd1RyYW5zaXRpb25VdGlsIHdvcmtmbG93VHJhbnNpdGlvblV0aWwgPSAoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbCkgSmlyYVV0aWxzLmxvYWRDb21wb25lbnQoV29ya2Zsb3dUcmFuc2l0aW9uVXRpbEltcGwuY2xhc3MpO1xud29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRJc3N1ZShwYXJlbnRJc3N1ZSk7XG4vL1JlamVjdGVkIFJEQSB0ZXN0IDUxIC0gcHJvZCAzMVxud29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5zZXRBY3Rpb24oMzEpO1xud29ya2Zsb3dUcmFuc2l0aW9uVXRpbC52YWxpZGF0ZSgpO1xud29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpO1xuKi8iLCJzY3JpcHRQYXRoIjpudWxsLCJwYXJhbWV0ZXJzIjp7fX0=</arg>
                  <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
                  <arg name="FIELD_INLINE_SCRIPT">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5NdXRhYmxlSXNzdWUKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZU1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5iYy51c2VyLnNlYXJjaC5Vc2VyU2VhcmNoU2VydmljZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIuQXBwbGljYXRpb25Vc2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuZXZlbnQudHlwZS5FdmVudERpc3BhdGNoT3B0aW9uCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuaXNzdWUuaW5kZXguSXNzdWVJbmRleGluZ1NlcnZpY2UKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5maWVsZHMuQ3VzdG9tRmllbGQKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5DdXN0b21GaWVsZE1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS53b3JrZmxvdy5Xb3JrZmxvd1RyYW5zaXRpb25VdGlsOwppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLndvcmtmbG93LldvcmtmbG93VHJhbnNpdGlvblV0aWxJbXBsOwppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnV0aWwuSmlyYVV0aWxzOwppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLklzc3VlOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvZGVjLmJpbmFyeS5CYXNlNjQ7CmltcG9ydCBvcmcuYXBhY2hlLmxvZzRqLkNhdGVnb3J5CmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEudXNlci51dGlsLlVzZXJNYW5hZ2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEud29ya2Zsb3cuV29ya2Zsb3dUcmFuc2l0aW9uVXRpbDsKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS53b3JrZmxvdy5Xb3JrZmxvd1RyYW5zaXRpb25VdGlsSW1wbDsKCmRlZiBpc3N1ZUZhY3RvcnkgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZUZhY3RvcnkoKQpkZWYgY29uc3RhbnRNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29uc3RhbnRzTWFuYWdlcigpCkNvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuc2V0TG9nZ2VkSW5Vc2VyKENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJNYW5hZ2VyKCkuZ2V0VXNlckJ5S2V5KCJhdGxhc3NpYW5fZmFhY19zZXJ2aWNlX2Rlc2siKSkKZGVmIExvZ2dlZEluVXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmdldEppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQoKS5nZXRMb2dnZWRJblVzZXIoKQoKQ3VzdG9tRmllbGRNYW5hZ2VyIAljdXN0b21GaWVsZE1hbmFnZXIgCT0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q3VzdG9tRmllbGRNYW5hZ2VyKCkKCklzc3VlSW5kZXhpbmdTZXJ2aWNlIGlzc3VlSW5kZXhpbmdTZXJ2aWNlID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29tcG9uZW50KElzc3VlSW5kZXhpbmdTZXJ2aWNlKQoKLyogR2V0IGlzc3VlICJHcm91cCBBc3NpZ25lZSIgY3VzdG9tIGZpZWxkIHZhbHVlICovCklzc3VlTWFuYWdlciBpc3N1ZU1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKQoKTXV0YWJsZUlzc3VlIHBhcmVudElzc3VlID0gaXNzdWUucGFyZW50T2JqZWN0OwoKQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5zZXRMb2dnZWRJblVzZXIoQ29tcG9uZW50QWNjZXNzb3IuZ2V0VXNlck1hbmFnZXIoKS5nZXRVc2VyQnlLZXkoImF0bGFzc2lhbl9mYWFjX3NlcnZpY2VfZGVzayIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKZGVmIGN1cnJlbnRVc2VyID0gQ29tcG9uZW50QWNjZXNzb3IuamlyYUF1dGhlbnRpY2F0aW9uQ29udGV4dC5nZXRMb2dnZWRJblVzZXIoKTsKCldvcmtmbG93VHJhbnNpdGlvblV0aWwgd29ya2Zsb3dUcmFuc2l0aW9uVXRpbCA9IChXb3JrZmxvd1RyYW5zaXRpb25VdGlsKSBKaXJhVXRpbHMubG9hZENvbXBvbmVudChXb3JrZmxvd1RyYW5zaXRpb25VdGlsSW1wbC5jbGFzcyk7CndvcmtmbG93VHJhbnNpdGlvblV0aWwuc2V0SXNzdWUocGFyZW50SXNzdWUpOwovL1JlamVjdGVkIFJEQSB0ZXN0IDUxIC0gcHJvZCAzMQp3b3JrZmxvd1RyYW5zaXRpb25VdGlsLnNldEFjdGlvbigzMSk7CndvcmtmbG93VHJhbnNpdGlvblV0aWwudmFsaWRhdGUoKTsKd29ya2Zsb3dUcmFuc2l0aW9uVXRpbC5wcm9ncmVzcygpOwo=</arg>
                  <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.CustomScriptFunction</arg>
                  <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
                  <arg name="FIELD_SCRIPT_FILE"></arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
        <action id="61" name="ToApproved ">
          <meta name="jira.description"></meta>
          <meta name="jira.fieldscreen.id"></meta>
          <results>
            <unconditional-result old-status="null" status="null" step="5">
              <post-functions>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.UpdateIssueStatusFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.misc.CreateCommentFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.GenerateChangeHistoryFunction</arg>
                </function>
                <function type="class">
                  <arg name="class.name">com.atlassian.jira.workflow.function.issue.IssueReindexFunction</arg>
                </function>
                <function type="class">
                  <arg name="eventTypeId">13</arg>
                  <arg name="class.name">com.atlassian.jira.workflow.function.event.FireIssueEventFunction</arg>
                </function>
                <function type="class">
                  <arg name="FIELD_NOTES">YCFgU2V0IFJlc29sdXRpb24=</arg>
                  <arg name="full.module.key">com.onresolve.jira.groovy.groovyrunnerrungroovy-function</arg>
                  <arg name="FIELD_INLINE_SCRIPT">YCFgaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLk11dGFibGVJc3N1ZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnV0aWwuSmlyYVV0aWxzOwppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLmlzc3VlLnN0YXR1cy5TdGF0dXMKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb21wb25lbnQuQ29tcG9uZW50QWNjZXNzb3IKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZQppbXBvcnQgY29tLmF0bGFzc2lhbi5qaXJhLnVzZXIuQXBwbGljYXRpb25Vc2VyCmltcG9ydCBjb20uYXRsYXNzaWFuLmppcmEuYmMuaXNzdWUuc2VhcmNoLlNlYXJjaFNlcnZpY2UKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5Jc3N1ZU1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5DdXN0b21GaWVsZE1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5maWVsZHMuQ3VzdG9tRmllbGQKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS51c2VyLnV0aWwuVXNlclV0aWwKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5jb25maWcuUmVzb2x1dGlvbk1hbmFnZXIKaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5ldmVudC50eXBlLkV2ZW50RGlzcGF0Y2hPcHRpb24KaW1wb3J0IGNvbS5hdGxhc3NpYW4uamlyYS5pc3N1ZS5pbmRleC5Jc3N1ZUluZGV4aW5nU2VydmljZQppbXBvcnQgb3JnLmFwYWNoZS5sb2c0ai5DYXRlZ29yeQoKU2VhcmNoU2VydmljZSAJCXNlYXJjaFNlcnZpY2UgCQk9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChTZWFyY2hTZXJ2aWNlLmNsYXNzKQpVc2VyVXRpbCAJCQl1c2VyVXRpbCAJCQk9IENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJVdGlsKCkKSXNzdWVNYW5hZ2VyIAkJaXNzdWVNYW5hZ2VyIAkJPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZU1hbmFnZXIoKQpJc3N1ZUluZGV4aW5nU2VydmljZSBpc3N1ZUluZGV4aW5nU2VydmljZSA9IENvbXBvbmVudEFjY2Vzc29yLmdldENvbXBvbmVudChJc3N1ZUluZGV4aW5nU2VydmljZSkKCkN1c3RvbUZpZWxkTWFuYWdlciAJY3VzdG9tRmllbGRNYW5hZ2VyIAk9IENvbXBvbmVudEFjY2Vzc29yLmdldEN1c3RvbUZpZWxkTWFuYWdlcigpCmRlZiBpc3N1ZUZhY3RvcnkgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRJc3N1ZUZhY3RvcnkoKQpkZWYgY29uc3RhbnRNYW5hZ2VyID0gQ29tcG9uZW50QWNjZXNzb3IuZ2V0Q29uc3RhbnRzTWFuYWdlcigpCgovL011dGFibGVJc3N1ZSBpc3N1ZSA9IGlzc3VlTWFuYWdlci5nZXRJc3N1ZUJ5S2V5SWdub3JlQ2FzZSgiUkRBLTEyMzIiKQoKQ2F0ZWdvcnkgbG9nID0gQ2F0ZWdvcnkuZ2V0SW5zdGFuY2UoImNvbS5vbnJlc29sdmUuamlyYS5ncm9vdnkuUG9zdEZ1bmN0aW9uIikKbG9nLnNldExldmVsKG9yZy5hcGFjaGUubG9nNGouTGV2ZWwuREVCVUcpCgpBcHBsaWNhdGlvblVzZXIgb2xkVXNlciA9IENvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQubG9nZ2VkSW5Vc2VyCkNvbXBvbmVudEFjY2Vzc29yLmppcmFBdXRoZW50aWNhdGlvbkNvbnRleHQuc2V0TG9nZ2VkSW5Vc2VyKENvbXBvbmVudEFjY2Vzc29yLmdldFVzZXJNYW5hZ2VyKCkuZ2V0VXNlckJ5S2V5KCJhdGxhc3NpYW5fZmFhY19zZXJ2aWNlX2Rlc2siKSkKQXBwbGljYXRpb25Vc2VyIHVzZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5qaXJhQXV0aGVudGljYXRpb25Db250ZXh0LmxvZ2dlZEluVXNlcgovL0Zsb3cgVHlwZSB0ZXN0IDIyODAxIC0gcHJvZCAgMjI3MTkKZGVmIGZsb3dUeXBlID0gaXNzdWUuZ2V0Q3VzdG9tRmllbGRWYWx1ZShDb21wb25lbnRBY2Nlc3Nvci5nZXRDdXN0b21GaWVsZE1hbmFnZXIoKS5nZXRDdXN0b21GaWVsZE9iamVjdCgyMjcxOSkpCgpkZWYgcmVzb2x1dGlvbk1hbmFnZXIgPSBDb21wb25lbnRBY2Nlc3Nvci5nZXRDb21wb25lbnQoUmVzb2x1dGlvbk1hbmFnZXIpCgppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiQ29udHJvbGxpbmcgZnVuY3Rpb24iKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJDb250cm9sbGluZyBmdW5jdGlvbiIpKQppZiAoZmxvd1R5cGUudG9TdHJpbmcoKSA9PSAiVGVjaG5pY2FsIEFwcHJvdmFsIikKCWlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZSgiVGVjaG5pY2FsIEFwcHJvdmFsIikpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJQdXJjaGFzZSBieSBjcmVkaXQgY2FyZCIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIlB1cmNoYXNlIGJ5IGNyZWRpdCBjYXJkIikpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJGaXJzdCBMZXZlbCBBcHByb3ZhbCIpCglpc3N1ZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb25NYW5hZ2VyLmdldFJlc29sdXRpb25CeU5hbWUoIkZpcnN0IExldmVsIEFwcHJvdmFsIikpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJTZWNvbmQgTGV2ZWwgQXBwcm92YWwiKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJTZWNvbmQgTGV2ZWwgQXBwcm92YWwiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIlRoaXJkIExldmVsIEFwcHJvdmFsIikKCWlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZSgiVGhpcmQgTGV2ZWwgQXBwcm92YWwiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIkdyb3VwIExldmVsIEFwcHJvdmFsIikKCWlzc3VlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbk1hbmFnZXIuZ2V0UmVzb2x1dGlvbkJ5TmFtZSgiR3JvdXAgTGV2ZWwgQXBwcm92YWwiKSkKaWYgKGZsb3dUeXBlLnRvU3RyaW5nKCkgPT0gIkNFTytDRk8iKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJDRU8rQ0ZPIikpCmlmIChmbG93VHlwZS50b1N0cmluZygpID09ICJHZW5lcmFsIE1hbmFnZXIiKQoJaXNzdWUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uTWFuYWdlci5nZXRSZXNvbHV0aW9uQnlOYW1lKCJHZW5lcmFsIE1hbmFnZXIiKSkKCmlzc3VlTWFuYWdlci51cGRhdGVJc3N1ZSh1c2VyLCBpc3N1ZSwgRXZlbnREaXNwYXRjaE9wdGlvbi5ET19OT1RfRElTUEFUQ0gsIGZhbHNlKQogICAg</arg>
                  <arg name="canned-script">com.onresolve.scriptrunner.canned.jira.workflow.postfunctions.CustomScriptFunction</arg>
                  <arg name="class.name">com.onresolve.jira.groovy.GroovyFunctionPlugin</arg>
                  <arg name="FIELD_SCRIPT_FILE"></arg>
                </function>
              </post-functions>
            </unconditional-result>
          </results>
        </action>
      </actions>
    </step>
  </steps>
</workflow>
